function e(){const e=t();r();const{formatCurrency:u}=m(),{databaseId:h,isLoading:y}=n(),[b,p]=s.useState([]),[j,f]=s.useState(!0),[k,N]=s.useState(null),[v,w]=s.useState("");return s.useEffect(()=>{(async()=>{if(h&&!y){f(!0);try{const{data:e,error:t}=await x.from("accounts").select("*").eq("user_id",h).eq("is_active",!1).order("updated_at",{ascending:!1});if(t)console.error("[DeletedAccounts] Error fetching deleted accounts:",t);else{console.log("[DeletedAccounts] Found deleted accounts:",e?.length||0),e&&e.length>0&&console.log("[DeletedAccounts] Deleted accounts data:",e);const t=(e||[]).map(e=>({...e,type:"checking"===e.type?"current":e.type}));p(t)}}catch(e){console.error("[DeletedAccounts] Failed to fetch deleted accounts:",e)}finally{f(!1)}}})()},[h,y]),a.jsxs(g,{title:"Deleted Accounts",children:[a.jsx("div",{className:"mb-6",children:a.jsxs("button",{onClick:()=>e("/settings"),className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:[a.jsx(c,{size:20}),"Back to Settings"]})}),v&&a.jsx("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2 text-green-700 dark:text-green-300",children:[a.jsx(d,{size:20}),a.jsx("span",{children:v})]})}),a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-6 mb-6",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(l,{size:24,className:"text-blue-600 dark:text-blue-400 mt-1"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"About Deleted Accounts"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Deleted accounts are hidden from your main accounts list but their transaction history and transfer links are preserved. You can restore any deleted account at any time by clicking the restore button next to it."})]})]})}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[a.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Deleted Accounts (",b.length,")"]})}),a.jsx("div",{className:"p-6",children:j||y?a.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Loading deleted accounts..."}):0===b.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(l,{size:48,className:"mx-auto text-gray-300 dark:text-gray-600 mb-4"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No deleted accounts"}),a.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"When you delete an account, it will appear here for recovery"})]}):a.jsx("div",{className:"space-y-3",children:b.map(e=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:[a.jsx("div",{className:"flex-1",children:a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),a.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[a.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.type}),e.institution&&a.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.institution}),a.jsxs("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:["Last Balance: ",u(e.balance)]})]})]})})}),a.jsxs("button",{onClick:()=>(async e=>{N(e);try{const{error:t}=await x.from("accounts").update({is_active:!0,updated_at:(new Date).toISOString()}).eq("id",e);if(t)return void console.error("Error restoring account:",t);p(t=>t.filter(t=>t.id!==e));const s=b.find(t=>t.id===e);w(`Account "${s?.name}" has been restored successfully!`),setTimeout(()=>w(""),3e3)}catch(t){console.error("Failed to restore account:",t)}finally{N(null)}})(e.id),disabled:k===e.id,className:`\n                      flex items-center gap-2 px-4 py-2 rounded-lg transition-colors\n                      ${k===e.id?"bg-gray-300 dark:bg-gray-600 text-gray-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}\n                    `,children:[a.jsx(i,{size:16,className:k===e.id?"animate-spin":""}),k===e.id?"Restoring...":"Restore"]})]},e.id))})})]}),b.length>0&&a.jsx("div",{className:"mt-6 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(o,{size:20,className:"text-yellow-600 dark:text-yellow-400 mt-1"}),a.jsx("div",{children:a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a.jsx("strong",{children:"Note:"})," Deleted accounts and their transactions are preserved indefinitely. If you need to permanently remove an account and all its data, please contact support."]})})]})})]})}import{bY as t,r as s,H as a}from"./chunk-DowOIOga.js";import{a as r,b3 as n,a2 as c,v as d,aQ as l,ac as i,b0 as o,s as x}from"./index-qHm2isZb.js";import{P as g}from"./chunk-r7IQz9KP.js";import{u as m}from"./chunk-ByFoKVyi.js";import"./chunk-ddLY9KjI.js";import"./chunk-B5pcS96K.js";export{e as default};
