function e({title:e,content:t,position:a="top",className:n="",iconSize:i=16,showOnHover:d=!0}){const[o,c]=y.useState(!1);return r.jsxs("div",{className:`relative inline-flex items-center ${n}`,children:[r.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1",onMouseEnter:()=>d&&c(!0),onMouseLeave:()=>d&&c(!1),onClick:()=>!d&&c(!o),"aria-label":`Help: ${e}`,children:r.jsx(s,{size:i})}),o&&r.jsx("div",{className:`absolute z-50 ${(()=>{switch(a){case"top":default:return"bottom-full left-1/2 transform -translate-x-1/2 mb-2";case"bottom":return"top-full left-1/2 transform -translate-x-1/2 mt-2";case"left":return"right-full top-1/2 transform -translate-y-1/2 mr-2";case"right":return"left-full top-1/2 transform -translate-y-1/2 ml-2"}})()} pointer-events-none`,style:{minWidth:"250px",maxWidth:"350px"},children:r.jsxs("div",{className:"bg-gray-900 dark:bg-gray-800 text-white rounded-lg shadow-xl p-3 pointer-events-auto",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[r.jsx("h4",{className:"font-semibold text-sm",children:e}),!d&&r.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-white transition-colors","aria-label":"Close help tooltip",children:r.jsx(l,{size:14})})]}),r.jsx("div",{className:"text-xs text-gray-300 leading-relaxed",children:t}),r.jsx("div",{className:`absolute ${(()=>{switch(a){case"top":default:return"top-full left-1/2 transform -translate-x-1/2 -mt-1";case"bottom":return"bottom-full left-1/2 transform -translate-x-1/2 -mb-1 rotate-180";case"left":return"left-full top-1/2 transform -translate-y-1/2 -ml-1 -rotate-90";case"right":return"right-full top-1/2 transform -translate-y-1/2 -mr-1 rotate-90"}})()}`,children:r.jsx("div",{className:"w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900 dark:border-t-gray-800"})})]})})]})}function t({value:e,onChange:t,categories:a,className:s="",disabled:l=!1,showUncategorized:n=!0,showMultiple:i=!1,placeholder:d="Select category"}){return r.jsxs("select",{value:e,onChange:e=>t(e.target.value),className:s,disabled:l,children:[n&&r.jsx("option",{value:"",children:"Uncategorized"}),i&&r.jsx("option",{value:"multiple",children:"Multiple"}),d&&!n&&!e&&r.jsx("option",{value:"",disabled:!0,children:d}),a.filter(e=>"type"===e.level).map(e=>{const t=a.filter(t=>"sub"===t.level&&t.parentId===e.id);if(t.length>0)return t.map(t=>r.jsx("optgroup",{label:`${e.name} > ${t.name}`,children:a.filter(e=>"detail"===e.level&&e.parentId===t.id).map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))},t.id));{const t=a.filter(t=>"detail"===t.level&&t.parentId===e.id);if(t.length>0)return r.jsx("optgroup",{label:e.name,children:t.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))},e.id)}return null}),a.filter(e=>!e.parentId&&"type"!==e.level).map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})}function a(){const{transactions:a,accounts:s,updateTransaction:k,categories:w}=n(),{formatCurrency:S}=N(),[C,z]=b(),M=j(),[I,D]=y.useState(C.get("account")||null),[A,F]=y.useState(!1),[T,R]=y.useState(null),[L,U]=y.useState(1),[O,$]=y.useState(20),[E,B]=y.useState(new Set),[H,P]=y.useState({}),[V,Q]=y.useState(!1),[W,X]=y.useState(null),[Y,q]=y.useState([]),[G,J]=y.useState(""),[K,Z]=y.useState(""),[_,ee]=y.useState(""),[te,ae]=y.useState(""),[re,se]=y.useState(""),[le,ne]=y.useState(""),[ie,de]=y.useState(!1),{reconciliationDetails:oe,totalUnreconciledCount:ce,getUnreconciledCount:xe}=function(e,t){const a=y.useMemo(()=>((e,t)=>e.map(e=>{const a=t.filter(t=>t.accountId===e.id),r=a.filter(e=>!0!==e.cleared),s=r.length,l=r.reduce((e,t)=>e+Math.abs(t.amount),0),n=a.length>0?new Date(Math.max(...a.map(e=>new Date(e.date).getTime()))):null;return{account:e,unreconciledCount:s,totalToReconcile:l,lastImportDate:n}}).filter(e=>e.unreconciledCount>0))(e,t),[e,t]);return{reconciliationDetails:a,totalUnreconciledCount:y.useMemo(()=>t.filter(e=>!0!==e.cleared).length,[t]),getUnreconciledCount:y.useMemo(()=>e=>t.filter(t=>t.accountId===e&&!0!==t.cleared).length,[t])}}(s,a),me=y.useMemo(()=>{let e=I?a.filter(e=>e.accountId===I&&!e.cleared):[];if(G){const t=G.toLowerCase();e=e.filter(e=>e.description.toLowerCase().includes(t)||e.notes?.toLowerCase().includes(t)||e.merchant?.toLowerCase().includes(t))}if(K&&(e=e.filter(e=>("string"==typeof e.date?e.date:e.date.toISOString().split("T")[0])>=K)),_&&(e=e.filter(e=>("string"==typeof e.date?e.date:e.date.toISOString().split("T")[0])<=_)),te){const t=parseFloat(te);e=e.filter(e=>Math.abs(e.amount)>=t)}if(re){const t=parseFloat(re);e=e.filter(e=>Math.abs(e.amount)<=t)}return le&&(e=e.filter(e=>e.category===le)),e},[I,a,G,K,_,te,re,le]),ge=Math.ceil(me.length/O),ue=(L-1)*O,he=ue+O,pe=me.slice(ue,he);y.useEffect(()=>{U(1),B(new Set),ye()},[I]);const ye=()=>{J(""),Z(""),ee(""),ae(""),se(""),ne("")},be=e=>{const t=a.find(t=>t.id===e);if(!t)return;const r=H[e],s=r?{...t,...r}:t;k(t.id,{...s,cleared:!0}),B(t=>{const a=new Set(t);return a.delete(e),a}),P(t=>{const a={...t};return delete a[e],a})},je=(e,t,a)=>{P(r=>({...r,[e]:{...r[e],[t]:a}}))},fe=e=>{const t=a.find(t=>t.id===e),r=H[e];t&&r&&(k(t.id,{...t,...r}),P(t=>{const a={...t};return delete a[e],a}))},ve=(e,t,a)=>{q(Y.map(r=>r.id===e?{...r,[t]:a}:r))},Ne=()=>{if(!W)return!1;const e=Y.reduce((e,t)=>e+parseFloat(t.amount.toString()||"0"),0);return Math.abs(e-W.amount)<.01},ke=()=>{D(null);const e="true"===new URLSearchParams(M.search).get("demo");z(e?{demo:"true"}:{})};if(!I)return r.jsxs("div",{children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("div",{className:"bg-secondary dark:bg-gray-700 rounded-2xl shadow p-4",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h1",{className:"text-3xl font-bold text-white",children:"Reconciliation"}),r.jsx(e,{title:"Account Reconciliation",content:"Match your transactions with bank statements to ensure accuracy. Mark transactions as cleared when they appear on your statement. This helps identify missing or duplicate transactions.",position:"right",iconSize:20})]})}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Select an account below to reconcile imported bank transactions"})]}),0===oe.length?r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-12 text-center",children:[r.jsx(i,{className:"mx-auto text-green-500 mb-4",size:48}),r.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"All caught up!"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"All bank transactions have been reconciled across all accounts."})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-2xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100",children:"Reconciliation Summary"}),r.jsxs("p",{className:"text-blue-700 dark:text-blue-300 mt-1",children:["You have ",ce," transactions to reconcile across ",oe.length," accounts"]})]}),r.jsx("div",{className:"text-3xl font-bold text-blue-900 dark:text-blue-100",children:ce})]})}),r.jsx("div",{className:"pt-4",children:r.jsx("div",{className:"grid gap-4",children:oe.map(({account:e,unreconciledCount:t,totalToReconcile:a,lastImportDate:s})=>{return r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>(e=>{D(e);const t={account:e};"true"===new URLSearchParams(M.search).get("demo")&&(t.demo="true"),z(t)})(e.id),children:r.jsx("div",{className:"p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3",children:["credit"===e.type?r.jsx(d,{className:"text-gray-400",size:24}):r.jsx(o,{className:"text-gray-400",size:24}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e.name}),r.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.institution," \u2022 Last import: ",(l=s,l?new Date(l).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"N/A")]})]})]}),r.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Transactions to reconcile"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total amount"}),r.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:S(a)})]})]})]}),r.jsx(c,{size:24,className:"text-gray-400"})]})})},e.id);var l})})})]})]});const we=s.find(e=>e.id===I),Se=I?xe(I):0;return r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(f,{onClick:ke,icon:r.jsx(x,{size:24}),variant:"ghost",size:"md",className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100"}),r.jsxs("div",{className:"bg-secondary dark:bg-gray-700 rounded-2xl shadow p-4",children:[r.jsxs("h1",{className:"text-3xl font-bold text-white",children:["Reconcile ",we?.name]}),r.jsx("p",{className:"text-sm text-white/80",children:we?.institution})]})]}),r.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[Se," items to reconcile"]})]}),0===me.length?r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-12 text-center",children:[r.jsx(i,{className:"mx-auto text-green-500 mb-4",size:48}),r.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"Account reconciled!"}),r.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["All transactions for ",we?.name," have been reconciled."]}),r.jsx("button",{onClick:ke,className:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-secondary",children:"Back to Accounts"})]}):r.jsxs("div",{children:[r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-4 mb-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Quick Filters"}),r.jsx("button",{onClick:()=>de(!ie),className:"text-sm text-primary hover:text-secondary",children:ie?"Hide Filters":"Show Filters"})]}),ie&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex gap-4",children:r.jsx("div",{className:"flex-1",children:r.jsx("input",{type:"text",placeholder:"Search transactions...",value:G,onChange:e=>J(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})})}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400 block mb-1",children:"From Date"}),r.jsx("input",{type:"date",value:K,onChange:e=>Z(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400 block mb-1",children:"To Date"}),r.jsx("input",{type:"date",value:_,onChange:e=>ee(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400 block mb-1",children:"Min Amount"}),r.jsx("input",{type:"number",placeholder:"0.00",value:te,onChange:e=>ae(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400 block mb-1",children:"Max Amount"}),r.jsx("input",{type:"number",placeholder:"0.00",value:re,onChange:e=>se(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400 block mb-1",children:"Category"}),r.jsxs("select",{value:le,onChange:e=>ne(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[r.jsx("option",{value:"",children:"All Categories"}),w.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{onClick:ye,className:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"Clear all filters"})})]})]}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-4 mb-6",children:r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:()=>{const e=pe.map(e=>e.id);e.every(e=>E.has(e))?B(t=>{const a=new Set(t);return e.forEach(e=>a.delete(e)),a}):B(t=>{const a=new Set(t);return e.forEach(e=>a.add(e)),a})},className:"text-sm text-primary hover:text-secondary",children:pe.every(e=>E.has(e.id))?"Deselect All":"Select All"}),E.size>0&&r.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[E.size," selected"]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("select",{value:O,onChange:e=>{$(Number(e.target.value)),U(1)},className:"px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[r.jsx("option",{value:10,children:"10 per page"}),r.jsx("option",{value:20,children:"20 per page"}),r.jsx("option",{value:50,children:"50 per page"}),r.jsx("option",{value:100,children:"100 per page"})]}),E.size>0&&r.jsxs("button",{onClick:()=>{E.forEach(e=>{be(e)})},className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 flex items-center gap-2",children:[r.jsx(i,{size:18}),"Reconcile Selected (",E.size,")"]})]})]})}),r.jsx("div",{className:"space-y-4",children:pe.map(e=>{const s=H[e.id]||{},l=s.date||e.date,n=void 0!==s.description?s.description:e.description,d=void 0!==s.category?s.category:e.category,o=void 0!==s.isSplit?s.isSplit:e.isSplit;return r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 hover:shadow-lg transition-shadow",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"pt-5",children:r.jsx("input",{type:"checkbox",checked:E.has(e.id),onChange:()=>{return t=e.id,void B(e=>{const a=new Set(e);return a.has(t)?a.delete(t):a.add(t),a});var t},className:"rounded text-primary focus:ring-primary"})}),r.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-3",children:[r.jsxs("div",{className:"col-span-12 md:col-span-2",children:[r.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400 block mb-1",children:"Date"}),r.jsx("input",{type:"date",value:l instanceof Date?l.toISOString().split("T")[0]:l,onChange:t=>je(e.id,"date",t.target.value),className:"w-full px-2 py-2 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),r.jsxs("div",{className:"col-span-12 md:col-span-4",children:[r.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400 block mb-1",children:"Description"}),r.jsx("input",{type:"text",value:n,onChange:t=>je(e.id,"description",t.target.value),className:"w-full px-2 py-2 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),r.jsxs("div",{className:"col-span-12 md:col-span-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Category"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("input",{type:"checkbox",id:`split-${e.id}`,checked:o||!1,onChange:()=>(e=>{const t=a.find(t=>t.id===e);t&&(X(t),q([{id:"1",description:t.description,category:t.category||"",amount:t.amount}]),Q(!0))})(e.id),className:"rounded text-primary focus:ring-primary h-3 w-3"}),r.jsx("label",{htmlFor:`split-${e.id}`,className:"text-xs text-gray-500 dark:text-gray-400 cursor-pointer",children:"Split"})]})]}),r.jsx(t,{value:d||"",onChange:t=>je(e.id,"category",t),categories:w,className:"w-full px-2 py-2 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded focus:outline-none focus:ring-2 focus:ring-primary",disabled:o,showMultiple:o})]})]}),r.jsxs("div",{className:"flex flex-col items-end ml-auto",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s&&Object.keys(s).length>0&&r.jsxs("div",{className:"relative group",children:[r.jsx("button",{onClick:()=>fe(e.id),className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:r.jsx(i,{size:18})}),r.jsxs("div",{className:"absolute invisible group-hover:visible bg-gray-800 text-white text-xs rounded py-1 px-2 bottom-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap z-10",children:["Save changes",r.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1",children:r.jsx("div",{className:"border-4 border-transparent border-t-gray-800"})})]})]}),r.jsxs("div",{className:"relative group",children:[r.jsx("button",{className:(e.isImported?"text-blue-600 dark:text-blue-400":"text-gray-300 dark:text-gray-600")+" cursor-default",children:r.jsx(m,{size:18,className:e.isImported?"fill-current":""})}),e.isImported&&r.jsxs("div",{className:"absolute invisible group-hover:visible bg-gray-800 text-white text-xs rounded py-1 px-2 bottom-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap z-10",children:["Bank Statement",r.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1",children:r.jsx("div",{className:"border-4 border-transparent border-t-gray-800"})})]})]}),r.jsxs("div",{className:"relative group",children:[r.jsx(f,{onClick:()=>(e=>{R(e),F(!0)})(e),icon:r.jsx(g,{size:18}),variant:"ghost",size:"sm",className:"text-gray-600 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}),r.jsxs("div",{className:"absolute invisible group-hover:visible bg-gray-800 text-white text-xs rounded py-1 px-2 bottom-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap z-10",children:["Advanced edit",r.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1",children:r.jsx("div",{className:"border-4 border-transparent border-t-gray-800"})})]})]}),r.jsxs("div",{className:"relative group",children:[r.jsx("button",{onClick:()=>be(e.id),className:"text-green-600 hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",children:r.jsx(i,{size:20,className:"font-bold"})}),r.jsxs("div",{className:"absolute invisible group-hover:visible bg-gray-800 text-white text-xs rounded py-1 px-2 bottom-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap z-10",children:["Mark as reconciled",r.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1",children:r.jsx("div",{className:"border-4 border-transparent border-t-gray-800"})})]})]})]}),r.jsxs("div",{className:"text-lg font-bold whitespace-nowrap text-right "+("income"===e.type?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:["income"===e.type?"+":"-",S(e.amount)]})]})]}),e.notes&&r.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.jsx("span",{className:"font-medium",children:"Notes:"})," ",e.notes]})})]},e.id)})}),ge>1&&r.jsx("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-2xl shadow px-6 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing ",ue+1," to ",Math.min(he,me.length)," of ",me.length," transactions"]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>U(e=>Math.max(1,e-1)),disabled:1===L,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(u,{size:20,className:"text-gray-600 dark:text-gray-400"})}),r.jsxs("span",{className:"px-3 py-1 text-sm text-gray-700 dark:text-gray-300",children:["Page ",L," of ",ge]}),r.jsx("button",{onClick:()=>U(e=>Math.min(ge,e+1)),disabled:L===ge,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(c,{size:20,className:"text-gray-600 dark:text-gray-400"})})]})]})})]}),r.jsx(v,{isOpen:A,onClose:()=>{F(!1),R(null)},transaction:T}),V&&W&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[r.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Split Transaction"}),r.jsx("button",{onClick:()=>{Q(!1),X(null),q([])},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:r.jsx(l,{size:24})})]}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Original amount: ",S(W.amount)]})]}),r.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[r.jsx("th",{className:"text-left py-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),r.jsx("th",{className:"text-left py-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Category"}),r.jsx("th",{className:"text-right py-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Amount"}),r.jsx("th",{className:"w-10"})]})}),r.jsx("tbody",{children:Y.map(e=>r.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[r.jsx("td",{className:"py-2 pr-2",children:r.jsx("input",{type:"text",value:e.description,onChange:t=>ve(e.id,"description",t.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Description"})}),r.jsx("td",{className:"py-2 px-2",children:r.jsx(t,{value:e.category,onChange:t=>ve(e.id,"category",t),categories:w,className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Select category"})}),r.jsx("td",{className:"py-2 pl-2",children:r.jsx("input",{type:"number",value:0===e.amount?"":e.amount,onChange:t=>ve(e.id,"amount",parseFloat(t.target.value)||0),onFocus:t=>{0===e.amount&&(t.target.value="")},className:"w-full px-2 py-1 text-sm text-right border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded focus:outline-none focus:ring-2 focus:ring-primary",step:"0.01",placeholder:"0.00"})}),r.jsx("td",{className:"py-2 pl-2",children:r.jsx("button",{onClick:()=>{return t=e.id,void(Y.length>1&&q(Y.filter(e=>e.id!==t)));var t},className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",disabled:1===Y.length,children:r.jsx(h,{size:16})})})]},e.id))})]}),r.jsxs("button",{onClick:()=>{const e=(Math.max(...Y.map(e=>parseInt(e.id)))+1).toString();q([...Y,{id:e,description:"",category:"",amount:0}])},className:"mt-4 flex items-center gap-2 text-sm text-primary hover:text-secondary",children:[r.jsx(p,{size:16}),"Add line"]})]}),r.jsx("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total allocated: "}),r.jsx("span",{className:"font-medium "+(Ne()?"text-green-600":"text-gray-900 dark:text-gray-100"),children:S(Y.reduce((e,t)=>e+parseFloat(t.amount.toString()||"0"),0))})]}),r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Remaining to allocate: "}),r.jsx("span",{className:"font-medium "+(Math.abs(W.amount-Y.reduce((e,t)=>e+parseFloat(t.amount.toString()||"0"),0))<.01?"text-green-600":"text-red-600"),children:S(W.amount-Y.reduce((e,t)=>e+parseFloat(t.amount.toString()||"0"),0))})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{Q(!1),X(null),q([])},className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm border border-gray-300/50 dark:border-gray-600/50 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),r.jsx("button",{onClick:()=>{W&&(Ne()?(je(W.id,"description","Various"),je(W.id,"category","multiple"),fe(W.id),Y.forEach(()=>{}),Q(!1),X(null),q([])):alert("Split amounts must equal the original transaction amount"))},disabled:!Ne(),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Split"})]})]})})]})})]})}import{j as r,ah as s,X as l,g as n,O as i,I as d,ai as o,a7 as c,aj as x,ak as m,Q as g,a6 as u,V as h,ag as p}from"./index-Pkjq0qn3.js";import{a as y,z as b,v as j}from"./chunk-BWx9oMeS.js";import{I as f}from"./chunk-B2-J6WC6.js";import v from"./EditTransactionModal-CeBGvOeN.js";import{u as N}from"./chunk-BYFRQ0Wn.js";import"./chunk-BN8kgYrt.js";import"./chunk-Drd-K-oK.js";import"./chunk-B7HJJKUW.js";import"./chunk-ybZz33tU.js";import"./chunk-qYdZW6fT.js";const k=new Date;k.getMonth(),k.getFullYear();export{a as default};
