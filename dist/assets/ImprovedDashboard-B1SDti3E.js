function e({data:e,children:t,...s}){const a={labels:e?.map(e=>e[s.dataKey||"month"])||[],datasets:[{label:s.label||"Value",data:e?.map(e=>e[s.dataKey||"netWorth"])||[],backgroundColor:s.fill||"#8B5CF6",borderRadius:4}]},l={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:s.contentStyle?.backgroundColor||"rgba(255, 255, 255, 0.95)",titleColor:s.contentStyle?.color||"#111827",bodyColor:s.contentStyle?.color||"#111827",borderColor:s.contentStyle?.border?.split(" ")[2]||"#E5E7EB",borderWidth:1,callbacks:{label:e=>s.formatter?s.formatter(e.parsed.y)[0]:e.parsed.y}}},scales:{x:{grid:{display:!1!==s.showGrid,color:"rgba(55, 65, 81, 0.3)"},ticks:{color:"#6B7280",font:{size:12}}},y:{grid:{display:!1!==s.showGrid,color:"rgba(55, 65, 81, 0.3)"},ticks:{color:"#6B7280",font:{size:12},callback:e=>s.tickFormatter?s.tickFormatter(e):e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(0)}K`:e.toString()}}}};return r.jsx(S,{data:a,options:l})}function t({data:e,children:t,onClick:s,...a}){const l={labels:e?.map(e=>e.name)||[],datasets:[{data:e?.map(e=>e.value)||[],backgroundColor:a.colors||["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],borderWidth:0}]},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:a.contentStyle?.backgroundColor||"rgba(255, 255, 255, 0.95)",titleColor:a.contentStyle?.color||"#111827",bodyColor:a.contentStyle?.color||"#111827",borderColor:a.contentStyle?.border?.split(" ")[2]||"#E5E7EB",borderWidth:1,callbacks:{label:e=>a.formatter?a.formatter(e.parsed):`${e.label}: ${e.parsed}`}}},onClick:(t,a)=>{if(a.length>0&&s){const t=a[0].index;s(e[t])}},cutout:a.innerRadius?"60%":void 0};return r.jsx(z,{data:l,options:n})}function s({children:e,...t}){return r.jsx("div",{style:{width:t.width||"100%",height:t.height||"100%"},children:e})}function a(){const{accounts:a,transactions:S,budgets:z}=d(),{formatCurrency:A,displayCurrency:B}=C(),F=l(),W=n(),[E,D]=i.useState(!1),[M,L]=i.useState([]),[T,R]=i.useState(!1);i.useEffect(()=>{const e=localStorage.getItem("dashboardKeyAccounts");L(e?JSON.parse(e):a.slice(0,4).map(e=>e.id))},[a]);const $=i.useMemo(()=>{const e=a.filter(e=>e.balance>0).reduce((e,t)=>e+t.balance,0),t=a.filter(e=>e.balance<0).reduce((e,t)=>e+Math.abs(t.balance),0),s=e-t,r=new Date;r.setDate(r.getDate()-30);const l=S.filter(e=>new Date(e.date)>=r),n=l.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),i=l.filter(e=>"expense"===e.type).reduce((e,t)=>e+Math.abs(t.amount),0),d=n-i,c=n>0?d/n*100:0,o=S.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).slice(0,5),x=a.filter(e=>("current"===e.type||"checking"===e.type)&&e.balance<500||!("credit"!==e.type||!e.creditLimit)&&Math.abs(e.balance)/e.creditLimit>.7);(new Date).toISOString().slice(0,7);const m=z.filter(e=>e.isActive),g=m.map(e=>{const t=l.filter(t=>t.category===e.category&&"expense"===t.type).reduce((e,t)=>e+Math.abs(t.amount),0),s=e.amount-t,a=e.amount>0?t/e.amount*100:0;return{...e,spent:t,remaining:s,percentUsed:a,isOverBudget:t>e.amount}}),h=m.reduce((e,t)=>e+t.amount,0),u=g.reduce((e,t)=>e+t.spent,0);return{netWorth:s,totalAssets:e,totalLiabilities:t,monthlyIncome:n,monthlyExpenses:i,monthlySavings:d,savingsRate:c,recentActivity:o,accountsNeedingAttention:x,budgetStatus:g,totalBudgeted:h,totalSpentOnBudgets:u,overallBudgetPercent:h>0?u/h*100:0,netWorthChange:0,netWorthChangePercent:0}},[a,S,z]),K=i.useMemo(()=>[{month:(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"}),netWorth:$.netWorth}],[$.netWorth]),O=i.useMemo(()=>a.filter(e=>e.balance>0).map(e=>({id:e.id,name:e.name,value:e.balance})).sort((e,t)=>t.value-e.value).slice(0,5),[a]),I=document.documentElement.classList.contains("dark"),P=i.useMemo(()=>({tooltip:{backgroundColor:I?"rgba(31, 41, 55, 0.95)":"rgba(255, 255, 255, 0.95)",border:I?"1px solid #374151":"1px solid #E5E7EB",borderRadius:"8px",color:I?"#E5E7EB":"#111827"},pieTooltip:{backgroundColor:I?"rgba(31, 41, 55, 0.95)":"rgba(255, 255, 255, 0.95)",border:I?"1px solid #374151":"1px solid #ccc",borderRadius:"8px",color:I?"#E5E7EB":"#111827"}}),[I]),U=a.filter(e=>M.includes(e.id));return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-purple-700 rounded-2xl p-6 sm:p-8 text-white shadow-xl",children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h2",{className:"text-lg sm:text-xl opacity-90 font-medium",children:"Your Net Worth"}),r.jsxs("div",{className:"mt-2 flex items-baseline gap-3",children:[r.jsx("span",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold",children:A($.netWorth)}),0!==$.netWorthChange&&($.netWorthChange>0?r.jsxs("span",{className:"flex items-center gap-1 text-green-300 text-sm sm:text-base",children:[r.jsx(c,{size:16}),"+",$.netWorthChangePercent.toFixed(1),"%"]}):r.jsxs("span",{className:"flex items-center gap-1 text-red-300 text-sm sm:text-base",children:[r.jsx(o,{size:16}),$.netWorthChangePercent.toFixed(1),"%"]}))]}),0!==$.netWorthChange&&r.jsxs("p",{className:"mt-3 opacity-80 text-sm sm:text-base",children:["vs last month: ",A($.netWorthChange)]})]}),r.jsx(x,{size:48,className:"opacity-50 hidden sm:block"})]}),r.jsxs("div",{"data-testid":"dashboard-grid",className:"grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-white/20",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm opacity-70",children:"Assets"}),r.jsx("p",{className:"text-xl font-semibold text-green-300",children:A($.totalAssets)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm opacity-70",children:"Liabilities"}),r.jsx("p",{className:"text-xl font-semibold text-red-300",children:A($.totalLiabilities)})]})]})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"This Month's Performance"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Income"}),r.jsx("p",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:A($.monthlyIncome)})]}),r.jsx(m,{size:24,className:"text-green-500"})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Expenses"}),r.jsx("p",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:A($.monthlyExpenses)})]}),r.jsx(g,{size:24,className:"text-red-500"})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Saved"}),r.jsx("p",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:A($.monthlySavings)}),r.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[$.savingsRate.toFixed(1),"% rate"]})]}),r.jsx(h,{size:24,className:"text-blue-500"})]})]})]}),$.budgetStatus.length>0&&r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6","data-testid":"budget-status",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[r.jsx(u,{size:24,className:"text-gray-500"}),"Budget Status",r.jsxs("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:["(",$.overallBudgetPercent.toFixed(0),"% used)"]})]}),r.jsxs("div",{className:"space-y-3",children:[$.budgetStatus.slice(0,3).map(e=>r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:e.category}),r.jsxs("span",{className:"font-medium "+(e.isOverBudget?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"),children:[A(e.spent)," / ",A(e.amount)]})]}),r.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden",children:r.jsx("div",{className:"h-full transition-all duration-300 "+(e.percentUsed>100?"bg-red-500":e.percentUsed>80?"bg-yellow-500":e.percentUsed>60?"bg-blue-500":"bg-green-500"),style:{width:`${Math.min(e.percentUsed,100)}%`}})})]},e.id)),$.budgetStatus.length>3&&r.jsxs("button",{onClick:()=>F(b("/budget",W.search)),className:"w-full mt-2 py-2 text-blue-600 dark:text-blue-400 text-sm hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:["View All Budgets (",$.budgetStatus.length,") \u2192"]})]})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[r.jsx(p,{size:24,className:"text-gray-500"}),"Key Account Balances",U.length>0&&r.jsxs("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:["(",U.length," of ",a.length,")"]})]}),r.jsx("button",{onClick:()=>D(!E),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors","aria-label":"Customize accounts",children:r.jsx(y,{size:20,className:"text-gray-500"})})]}),E&&r.jsxs("div",{className:"mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Select accounts to display on dashboard:"}),r.jsx("button",{onClick:()=>D(!1),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded",children:r.jsx(j,{size:16,className:"text-gray-500"})})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:a.map(e=>r.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-600 rounded cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:M.includes(e.id),onChange:()=>{return t=e.id,void L(e=>{const s=e.includes(t)?e.filter(e=>e!==t):[...e,t];return localStorage.setItem("dashboardKeyAccounts",JSON.stringify(s)),s});var t},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.name}),r.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-auto",children:A(e.balance)})]},e.id))}),r.jsx("div",{className:"mt-3 text-xs text-gray-500 dark:text-gray-400",children:"Tip: Select your most important accounts for quick access"})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:U.length>0?U.map(e=>r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors cursor-pointer","data-testid":"account-balance-card",onClick:()=>F(b(`/accounts/${e.id}`,W.search)),role:"button",tabIndex:0,onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||F(b(`/accounts/${e.id}`,W.search))},children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.institution||e.subtype})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-lg font-bold "+(e.balance<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:A(e.balance)}),e.creditLimit&&r.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Limit: ",A(e.creditLimit)]})]})]},e.id)):a.length>0?r.jsxs("div",{className:"col-span-2 text-center py-8 text-gray-500 dark:text-gray-400",children:[r.jsx(y,{size:48,className:"mx-auto mb-3 opacity-50"}),r.jsx("p",{className:"font-medium",children:"No accounts selected"}),r.jsx("p",{className:"text-sm mt-1",children:"Click the settings icon above to select accounts to display"})]}):r.jsxs("div",{className:"col-span-2 text-center py-8 text-gray-500 dark:text-gray-400",children:[r.jsx(p,{size:48,className:"mx-auto mb-3 opacity-50"}),r.jsx("p",{className:"font-medium",children:"No accounts added yet"}),r.jsx("p",{className:"text-sm mt-1",children:"Add your first account to start tracking"})]})})]}),$.accountsNeedingAttention.length>0&&r.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-6",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx(N,{size:24,className:"text-yellow-600 dark:text-yellow-400"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Needs Your Attention"})]}),r.jsx("div",{className:"space-y-3",children:$.accountsNeedingAttention.map(e=>r.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-800 rounded-lg cursor-pointer hover:shadow-md transition-shadow",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(p,{size:20,className:"text-gray-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),r.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[("current"===e.type||"checking"===e.type)&&e.balance<500&&"Low balance","credit"===e.type&&e.creditLimit&&Math.abs(e.balance)/e.creditLimit>.7&&"High utilization"]})]})]}),r.jsx(f,{size:20,className:"text-gray-400"})]},e.id))})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[r.jsx(k,{size:24,className:"text-gray-500"}),"Net Worth Over Time"]}),r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:1===K.length?"Current month's net worth (historical data will build up over time)":"Your wealth progression over time"}),r.jsx("div",{className:"h-64",children:1===K.length?r.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-500 dark:text-gray-400",children:[r.jsx(k,{size:48,className:"opacity-20 mb-3"}),r.jsx("p",{className:"text-lg font-medium mb-2",children:"Current Net Worth"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:A($.netWorth,B)}),r.jsx("p",{className:"text-sm mt-3 text-center max-w-md",children:"As you continue using WealthTracker, we'll track your net worth over time to show you trends and progress towards your financial goals."})]}):r.jsx(s,{width:"100%",height:"100%",children:r.jsx(e,{data:K,dataKey:"netWorth",fill:"#8B5CF6",label:"Net Worth",formatter:e=>A(e,B),contentStyle:P.tooltip,tickFormatter:e=>e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(0)}K`:e.toString()})})})]}),O.length>0&&r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[r.jsx(u,{size:24,className:"text-gray-500"}),"Account Distribution"]}),r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Your top 5 accounts by balance"}),r.jsx("div",{className:"h-64",children:r.jsx(s,{width:"100%",height:"100%",children:r.jsx(t,{data:O,innerRadius:!0,colors:["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],onClick:e=>{F(`/transactions?account=${e.id}`)},formatter:e=>A(e,B),contentStyle:P.pieTooltip})})})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[r.jsx(w,{size:24,className:"text-gray-500"}),"Recent Transactions"]}),r.jsxs("div",{className:"space-y-1 overflow-auto",style:{maxHeight:"400px"},children:[$.recentActivity.length>0?$.recentActivity.slice(0,10).map(e=>r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 py-2 sm:py-1.5 border-b dark:border-gray-700/50 last:border-0 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600/50 transition-colors rounded px-2 -mx-2",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-0 sm:gap-3 flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("span",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 whitespace-nowrap",children:new Date(e.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})}),r.jsx("span",{className:"text-xs sm:text-sm font-bold text-gray-600 dark:text-gray-400 w-4 text-center",children:e.cleared?"R":"N"})]}),r.jsx("p",{className:"text-xs sm:text-sm font-medium dark:text-white truncate flex-1",children:e.description})]}),r.jsx("span",{className:"text-xs sm:text-sm font-semibold whitespace-nowrap "+("income"===e.type||"transfer"===e.type&&e.amount>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:"expense"===e.type||"transfer"===e.type&&e.amount<0?A(-Math.abs(e.amount)):`+${A(Math.abs(e.amount))}`})]},e.id)):r.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-6",children:"No transactions yet"}),$.recentActivity.length>10&&r.jsx("button",{onClick:()=>F(b("/transactions",W.search)),className:"w-full mt-4 py-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:"View All Transactions \u2192"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[r.jsxs("button",{onClick:()=>R(!0),className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow hover:shadow-lg transition-shadow text-center",children:[r.jsx(w,{size:24,className:"mx-auto mb-2 text-blue-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Add Transaction"})]}),r.jsxs("button",{onClick:()=>F(b("/accounts",W.search)),className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow hover:shadow-lg transition-shadow text-center",children:[r.jsx(p,{size:24,className:"mx-auto mb-2 text-green-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"View Accounts"})]}),r.jsxs("button",{onClick:()=>F(b("/budget",W.search)),className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow hover:shadow-lg transition-shadow text-center",children:[r.jsx(h,{size:24,className:"mx-auto mb-2 text-purple-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Set Budget"})]}),r.jsxs("button",{onClick:()=>F(b("/analytics",W.search)),className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow hover:shadow-lg transition-shadow text-center",children:[r.jsx(m,{size:24,className:"mx-auto mb-2 text-orange-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Analytics"})]})]}),r.jsx(v,{isOpen:T,onClose:()=>R(!1)})]})}import{H as r,bY as l,bV as n,r as i}from"./chunk-DowOIOga.js";import{a as d,aC as c,aD as o,i as x,T as m,p as g,au as h,q as u,w as b,m as p,r as y,X as j,aa as N,N as f,B as k,o as w,Y as v}from"./index-qHm2isZb.js";import{u as C}from"./chunk-ByFoKVyi.js";import{e as S,f as z,g as A,h as B,i as F,j as W,k as E,l as D,A as M,p as L,m as T,n as R,o as $}from"./chunk-DoYVaa8Y.js";import"./chunk-ddLY9KjI.js";import"./chunk-B5pcS96K.js";A.register(B,F,W,E,D,M,L,T,R,$);export{a as ImprovedDashboard};
