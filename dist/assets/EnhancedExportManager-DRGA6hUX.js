function e(){const{accounts:e,transactions:a,budgets:o}=r(),[h,y]=c.useState(!1),[x,v]=c.useState(null),[C,T]=c.useState(!1),[S,D]=c.useState(!1),[_,z]=c.useState({format:"pdf",reportType:"transactions",dateRange:"thisMonth",accounts:e.map(e=>e.id),categories:[],includeCharts:!0,includeNotes:!1,groupBy:"none",paperSize:"a4",orientation:"portrait"}),R=()=>{const e=new Date;switch(_.dateRange){case"thisMonth":return{start:g(e),end:i(e)};case"lastMonth":const t=p(e,1);return{start:g(t),end:i(t)};case"thisYear":return{start:d(e),end:m(e)};case"lastYear":const a=new Date(e.getFullYear()-1,0,1);return{start:d(a),end:m(a)};case"custom":return{start:_.startDate?new Date(_.startDate):e,end:_.endDate?new Date(_.endDate):e};default:return{start:new Date(2e3,0,1),end:e}}},A=()=>{switch(_.reportType){case"transactions":return"Transaction Report";case"summary":return"Financial Summary";case"budget":return"Budget Analysis Report";case"tax":return"Tax Summary Report";case"investment":return"Investment Performance Report";case"networth":return"Net Worth Statement";default:return"Financial Report"}},$=()=>{const e=l(new Date,"yyyy-MM-dd");return`wealthtracker-${_.reportType}-${e}`};return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[s.jsx(b,{size:20}),"Advanced Export"]}),h&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Export Manager"}),s.jsx("button",{onClick:()=>y(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s.jsx(n,{size:20})})]})}),s.jsxs("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 140px)"},children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Quick Templates"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:F.map(e=>{const t=e.icon;return s.jsx("button",{onClick:()=>(e=>{const t=F.find(t=>t.id===e);t&&(v(e),z(e=>({...e,reportType:t.reportType,...t.defaults})))})(e.id),className:"p-4 rounded-lg border-2 transition-all text-left "+(x===e.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:s.jsx(t,{size:20,className:"text-gray-600 dark:text-gray-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-white text-sm",children:e.name}),s.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:e.description})]})]})},e.id)})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Export Format"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>z(e=>({...e,format:"pdf"})),className:"flex-1 p-3 rounded-lg border-2 transition-all "+("pdf"===_.format?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700"),children:[s.jsx(u,{size:24,className:"mx-auto mb-2 text-red-500"}),s.jsx("p",{className:"text-sm font-medium",children:"PDF"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Professional reports"})]}),s.jsxs("button",{onClick:()=>z(e=>({...e,format:"excel"})),className:"flex-1 p-3 rounded-lg border-2 transition-all "+("excel"===_.format?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700"),children:[s.jsx(j,{size:24,className:"mx-auto mb-2 text-green-500"}),s.jsx("p",{className:"text-sm font-medium",children:"Excel"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Advanced analysis"})]}),s.jsxs("button",{onClick:()=>z(e=>({...e,format:"csv"})),className:"flex-1 p-3 rounded-lg border-2 transition-all "+("csv"===_.format?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700"),children:[s.jsx(k,{size:24,className:"mx-auto mb-2 text-blue-500"}),s.jsx("p",{className:"text-sm font-medium",children:"CSV"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Universal format"})]})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Date Range"}),s.jsx("div",{className:"grid grid-cols-3 gap-3",children:["thisMonth","lastMonth","thisYear","lastYear","all","custom"].map(e=>s.jsxs("button",{onClick:()=>z(t=>({...t,dateRange:e})),className:"px-4 py-2 rounded-lg border transition-all "+(_.dateRange===e?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-600":"border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300"),children:["thisMonth"===e&&"This Month","lastMonth"===e&&"Last Month","thisYear"===e&&"This Year","lastYear"===e&&"Last Year","all"===e&&"All Time","custom"===e&&"Custom"]},e))}),"custom"===_.dateRange&&s.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[s.jsx("input",{type:"date",value:_.startDate,onChange:e=>z(t=>({...t,startDate:e.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700"}),s.jsx("input",{type:"date",value:_.endDate,onChange:e=>z(t=>({...t,endDate:e.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700"})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Options"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:_.includeCharts,onChange:e=>z(t=>({...t,includeCharts:e.target.checked})),className:"w-4 h-4 text-blue-600 rounded"}),s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include charts and visualizations (PDF only)"})]}),s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:_.includeNotes,onChange:e=>z(t=>({...t,includeNotes:e.target.checked})),className:"w-4 h-4 text-blue-600 rounded"}),s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include transaction notes"})]})]}),"pdf"===_.format&&s.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Paper Size"}),s.jsxs("select",{value:_.paperSize,onChange:e=>z(t=>({...t,paperSize:e.target.value})),className:"w-full mt-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:[s.jsx("option",{value:"a4",children:"A4"}),s.jsx("option",{value:"letter",children:"Letter"}),s.jsx("option",{value:"legal",children:"Legal"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Orientation"}),s.jsxs("select",{value:_.orientation,onChange:e=>z(t=>({...t,orientation:e.target.value})),className:"w-full mt-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:[s.jsx("option",{value:"portrait",children:"Portrait"}),s.jsx("option",{value:"landscape",children:"Landscape"})]})]})]})]})]}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[s.jsxs("button",{onClick:()=>D(!0),className:"flex items-center gap-2 px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[s.jsx(f,{size:16}),"Preview"]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"}),s.jsx("button",{onClick:async()=>{T(!0);try{if("pdf"===_.format)(await(async()=>{if(!M){const e=await t(()=>import("./chunk-C1eKK5Oc.js").then(e=>e.j),[]);M=e.jsPDF}if(!N){const e=await t(()=>import("./jspdf-D4ahhilI.js"),[]);N=e.default}const r=new M({orientation:_.orientation,unit:"mm",format:_.paperSize});r.setFontSize(20),r.text(_.customTitle||A(),20,20),r.setFontSize(10),r.setTextColor(100);const s=R();r.text(`Period: ${l(s.start,"MMM d, yyyy")} - ${l(s.end,"MMM d, yyyy")}`,20,30);const n=a.filter(e=>{const t=new Date(e.date);return t>=s.start&&t<=s.end&&(0===_.accounts.length||_.accounts.includes(e.accountId))&&(0===_.categories.length||_.categories.includes(e.category))});r.setFontSize(12),r.setTextColor(0),r.text("Summary",20,45);const d=n.filter(e=>parseFloat(e.amount)>0).reduce((e,t)=>e+parseFloat(t.amount),0),i=Math.abs(n.filter(e=>parseFloat(e.amount)<0).reduce((e,t)=>e+parseFloat(t.amount),0));if(r.setFontSize(10),r.text(`Total Income: \xa3${d.toFixed(2)}`,20,55),r.text(`Total Expenses: \xa3${i.toFixed(2)}`,20,62),r.text(`Net: \xa3${(d-i).toFixed(2)}`,20,69),r.text(`Transactions: ${n.length}`,20,76),"transactions"===_.reportType||"custom"===_.reportType){const t=n.map(t=>[l(new Date(t.date),"MMM d, yyyy"),t.description,t.category,e.find(e=>e.id===t.accountId)?.name||"Unknown",`\xa3${Math.abs(parseFloat(t.amount)).toFixed(2)}`,parseFloat(t.amount)>0?"Income":"Expense"]);N(r,{head:[["Date","Description","Category","Account","Amount","Type"]],body:t,startY:85,styles:{fontSize:8},headStyles:{fillColor:[41,128,185]},alternateRowStyles:{fillColor:[245,245,245]}})}if("budget"===_.reportType&&o.length>0){r.addPage(),r.setFontSize(16),r.text("Budget Analysis",20,20);const e=o.map(e=>{const t=Math.abs(n.filter(t=>t.category===e.category&&parseFloat(t.amount)<0).reduce((e,t)=>e+parseFloat(t.amount),0)),a=t/parseFloat(e.amount)*100;return[e.category,`\xa3${parseFloat(e.amount).toFixed(2)}`,`\xa3${t.toFixed(2)}`,`\xa3${(parseFloat(e.amount)-t).toFixed(2)}`,`${a.toFixed(1)}%`]});N(r,{head:[["Category","Budgeted","Spent","Remaining","% Used"]],body:e,startY:30,styles:{fontSize:9},headStyles:{fillColor:[41,128,185]}})}const c=r.getNumberOfPages();for(let e=1;e<=c;e++)r.setPage(e),r.setFontSize(8),r.setTextColor(150),r.text(`Page ${e} of ${c} | Generated by WealthTracker on ${l(new Date,"MMM d, yyyy")}`,r.internal.pageSize.width/2,r.internal.pageSize.height-10,{align:"center"});return r})()).save(`${$()}.pdf`);else if("excel"===_.format){const r=await(async()=>{w||(w=await t(()=>import("./xlsx-CngQiIXK.js"),[]));const r=w.utils.book_new(),s=R(),n=a.filter(e=>{const t=new Date(e.date);return t>=s.start&&t<=s.end&&(0===_.accounts.length||_.accounts.includes(e.accountId))&&(0===_.categories.length||_.categories.includes(e.category))}),d=[["WealthTracker Export Report"],[""],["Report Type:",A()],["Date Range:",`${l(s.start,"MMM d, yyyy")} - ${l(s.end,"MMM d, yyyy")}`],["Generated:",l(new Date,"MMM d, yyyy HH:mm")],[""],["Summary Statistics"],["Total Income:",n.filter(e=>parseFloat(e.amount)>0).reduce((e,t)=>e+parseFloat(t.amount),0)],["Total Expenses:",Math.abs(n.filter(e=>parseFloat(e.amount)<0).reduce((e,t)=>e+parseFloat(t.amount),0))],["Net Amount:",n.reduce((e,t)=>e+parseFloat(t.amount),0)],["Transaction Count:",n.length]],i=w.utils.aoa_to_sheet(d);if(w.utils.book_append_sheet(r,i,"Summary"),n.length>0){const t=[["Date","Description","Category","Account","Amount","Type","Balance"],...n.map(t=>[l(new Date(t.date),"yyyy-MM-dd"),t.description,t.category,e.find(e=>e.id===t.accountId)?.name||"Unknown",parseFloat(t.amount),parseFloat(t.amount)>0?"Income":"Expense",0])],a=w.utils.aoa_to_sheet(t),s=w.utils.decode_range(a["!ref"]||"A1");for(let e=s.s.c;e<=s.e.c;++e){const t=w.utils.encode_col(e)+"1";a[t]&&(a[t].s={font:{bold:!0},fill:{fgColor:{rgb:"2980B9"}},alignment:{horizontal:"center"}})}w.utils.book_append_sheet(r,a,"Transactions")}if("budget"===_.reportType&&o.length>0){const e=[["Category","Budgeted","Spent","Remaining","% Used","Status"],...o.map(e=>{const t=Math.abs(n.filter(t=>t.category===e.category&&parseFloat(t.amount)<0).reduce((e,t)=>e+parseFloat(t.amount),0)),a=parseFloat(e.amount)-t,r=t/parseFloat(e.amount)*100;return[e.category,parseFloat(e.amount),t,a,r,r>100?"Over Budget":r>80?"Warning":"On Track"]})],t=w.utils.aoa_to_sheet(e);w.utils.book_append_sheet(r,t,"Budget Analysis")}const c=new Map;n.forEach(e=>{const t=c.get(e.category)||0;c.set(e.category,t+parseFloat(e.amount))});const u=[["Category","Total Amount","Transaction Count","Average"],...Array.from(c.entries()).map(([e,t])=>{const a=n.filter(t=>t.category===e).length;return[e,t,a,t/a]})],m=w.utils.aoa_to_sheet(u);return w.utils.book_append_sheet(r,m,"Category Summary"),r})();w.writeFile(r,`${$()}.xlsx`)}else if("csv"===_.format){const t=(()=>{const t=R(),r=a.filter(e=>{const a=new Date(e.date);return a>=t.start&&a<=t.end&&(0===_.accounts.length||_.accounts.includes(e.accountId))&&(0===_.categories.length||_.categories.includes(e.category))}).map(t=>[l(new Date(t.date),"yyyy-MM-dd"),`"${t.description.replace(/"/g,'""')}"`,t.category,e.find(e=>e.id===t.accountId)?.name||"Unknown",t.amount,parseFloat(t.amount)>0?"Income":"Expense"]);return[["Date","Description","Category","Account","Amount","Type"].join(","),...r.map(e=>e.join(","))].join("\n")})(),r=new Blob([t],{type:"text/csv"}),s=URL.createObjectURL(r),n=document.createElement("a");n.href=s,n.download=`${$()}.csv`,n.click(),URL.revokeObjectURL(s)}y(!1)}catch(r){console.error("Export failed:",r)}finally{T(!1)}},disabled:C,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:C?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Exporting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(b,{size:16}),"Export"]})})]})]})]})})]})}import{_ as t}from"./chunk-C1eKK5Oc.js";import{l as a,g as r,j as s,cl as n,p as o,ab as l,b0 as d,aP as i}from"./index-CgJz7Gw0.js";import{a as c}from"./chunk-BWx9oMeS.js";import{F as u}from"./chunk-BOJXXpRf.js";import{e as m}from"./chunk-RPC-O8j3.js";import{s as p}from"./chunk-Bz0sHhCn.js";import{s as g}from"./chunk-BcvNNmv9.js";import"./chunk-BN8kgYrt.js";const h=a("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),y=a("chart-pie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),x=a("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),b=a("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),f=a("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),k=a("file-plus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]),j=a("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),v=a("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);let M=null,N=null,w=null;const F=[{id:"monthly-statement",name:"Monthly Statement",icon:h,description:"Professional bank-style monthly statement",reportType:"transactions",defaults:{dateRange:"lastMonth",groupBy:"account",includeCharts:!0}},{id:"tax-summary",name:"Tax Summary",icon:v,description:"Annual tax-deductible expenses report",reportType:"tax",defaults:{dateRange:"lastYear",groupBy:"category",includeCharts:!1}},{id:"investment-performance",name:"Investment Performance",icon:o,description:"Portfolio performance and holdings report",reportType:"investment",defaults:{dateRange:"thisYear",includeCharts:!0}},{id:"budget-analysis",name:"Budget Analysis",icon:y,description:"Budget vs actual spending analysis",reportType:"budget",defaults:{dateRange:"thisMonth",groupBy:"category",includeCharts:!0}},{id:"net-worth",name:"Net Worth Statement",icon:x,description:"Complete assets and liabilities statement",reportType:"networth",defaults:{dateRange:"all",includeCharts:!0}}];export{e as default};
