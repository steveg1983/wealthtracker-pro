function e({onAccountsLinked:e}){const[u,y]=m.useState([]),[b,k]=m.useState([]),[j,p]=m.useState(!1),[f,N]=m.useState(""),[w,v]=m.useState(!1),[C,S]=m.useState(new Set),[z,L]=m.useState({plaid:!1,trueLayer:!1});m.useEffect(()=>{A(),B(),T()},[]);const A=()=>{y(h.getConnections())},B=async()=>{const e=await h.getInstitutions();k(e)},T=()=>{L(h.getConfigStatus())},I=async t=>{S(e=>new Set(e).add(t));try{const s=await h.syncConnection(t);s.success?(A(),e?.()):console.error("Sync failed:",s.errors)}finally{S(e=>{const s=new Set(e);return s.delete(t),s})}},M=e=>{switch(e){case"connected":return t.jsx(g,{size:16,className:"text-green-600 dark:text-green-400"});case"error":return t.jsx(s,{size:16,className:"text-red-600 dark:text-red-400"});case"reauth_required":return t.jsx(s,{size:16,className:"text-yellow-600 dark:text-yellow-400"})}},O=b.filter(e=>e.name.toLowerCase().includes(f.toLowerCase())),P=u.filter(e=>"reauth_required"===e.status).length;return t.jsxs("div",{className:"space-y-6",children:[!z.plaid&&!z.trueLayer&&t.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(s,{className:"text-yellow-600 dark:text-yellow-400 mt-0.5",size:20}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Bank connections not configured"}),t.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"To enable automatic bank syncing, configure API credentials in the settings."})]})]})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Connected Banks"}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[u.length," bank",1!==u.length?"s":""," connected",P>0&&t.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400 ml-2",children:["(",P," need",1===P?"s":""," reauthorization)"]})]})]}),t.jsxs("div",{className:"flex gap-3",children:[u.length>0&&t.jsxs("button",{onClick:async()=>{const e=u.filter(e=>"connected"===e.status);for(const t of e)await I(t.id)},className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[t.jsx(a,{size:16}),"Sync All"]}),t.jsxs("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[t.jsx(r,{size:16}),"Add Bank"]})]})]}),u.length>0?t.jsx("div",{className:"space-y-3",children:u.map(e=>t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:t.jsx(n,{size:24,className:"text-gray-600 dark:text-gray-400"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.institutionName}),M(e.status)]}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mt-1",children:[t.jsxs("span",{children:[e.accounts.length," accounts linked"]}),e.lastSync&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(i,{size:12}),"Last synced ",l(new Date(e.lastSync),"MMM d, h:mm a")]})]}),e.error&&t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:e.error})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>I(e.id),disabled:C.has(e.id),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white disabled:opacity-50",title:"Sync now",children:t.jsx(a,{size:20,className:C.has(e.id)?"animate-spin":""})}),t.jsx("button",{onClick:()=>(async e=>{confirm("Are you sure you want to disconnect this bank? This will stop automatic syncing.")&&(await h.disconnect(e),A())})(e.id),className:"p-2 text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300",title:"Disconnect",children:t.jsx(c,{size:20})})]})]})},e.id))}):t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-8 text-center",children:[t.jsx(d,{size:48,className:"text-gray-300 dark:text-gray-600 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No banks connected"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Connect your bank accounts for automatic transaction imports and real-time balance updates."}),t.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[t.jsx(r,{size:20}),"Connect Your First Bank"]})]}),t.jsx(o,{isOpen:j,onClose:()=>p(!1),title:"Connect a Bank",size:"lg",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(x,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",value:f,onChange:e=>N(e.target.value),placeholder:"Search for your bank...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),t.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 text-sm",children:t.jsxs("p",{className:"text-blue-800 dark:text-blue-200",children:[t.jsx("strong",{children:"Secure Connection:"})," Your credentials are never stored. Connection is established directly with your bank using OAuth."]})}),t.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:O.map(e=>t.jsxs("button",{onClick:()=>(async e=>{v(!0);try{const t=await h.connectBank(e.id,e.provider);if(t.url){const e=window.open(t.url,"bankAuth","width=500,height=700,left=200,top=100"),s=setInterval(()=>{e?.closed&&(clearInterval(s),A(),p(!1))},1e3)}else t.linkToken&&alert("Plaid Link integration would open here with token: "+t.linkToken)}catch(t){console.error("Failed to connect bank:",t)}finally{v(!1)}})(e),disabled:w,className:"w-full p-4 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg transition-colors text-left flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center",children:t.jsx(n,{size:24,className:"text-gray-600 dark:text-gray-400"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["via ","truelayer"===e.provider?"TrueLayer":"Plaid"]})]}),t.jsx(d,{size:20,className:"text-gray-400"})]},e.id))}),0===O.length&&t.jsx("div",{className:"text-center py-8",children:t.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:['No banks found matching "',f,'"']})})]})})]})}import{j as t,ar as s,at as a,ag as r,ai as n,ab as l,aZ as i,cn as c,br as d,M as o,a3 as x,O as g}from"./index-Pkjq0qn3.js";import{a as m}from"./chunk-BWx9oMeS.js";import{b as h}from"./chunk-sYIUaUoe.js";import"./chunk-BN8kgYrt.js";import"./chunk-Drd-K-oK.js";export{e as default};
