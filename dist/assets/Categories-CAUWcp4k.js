function e({isOpen:e,onClose:t,categoryId:n,categoryName:r}){const{transactions:a,accounts:i}=je(),{formatCurrency:o}=Fe(),[s,l]=Le.useState(""),[c,d]=Le.useState(""),[u,g]=Le.useState(""),[h,f]=Le.useState(""),[p,v]=Le.useState("all"),m=Le.useMemo(()=>a.filter(e=>e.category===n),[a,n]),x=Le.useMemo(()=>{let e=m;if("income"===p?e=e.filter(e=>"income"===e.type||"transfer"===e.type&&e.amount>0):"expense"===p&&(e=e.filter(e=>"expense"===e.type||"transfer"===e.type&&e.amount<0)),s){const t=new Date(s);t.setHours(0,0,0,0),e=e.filter(e=>new Date(e.date)>=t)}if(c){const t=new Date(c);t.setHours(23,59,59,999),e=e.filter(e=>new Date(e.date)<=t)}if(h.trim()){const t=h.toLowerCase().trim().split(/\s+/);e=e.filter(e=>{const n=i.find(t=>t.id===e.accountId),a=e.description.toLowerCase();if(t.every(e=>a.includes(e)))return!0;const s=[e.description,e.amount.toString(),Math.abs(e.amount).toString(),o(Math.abs(e.amount)),n?.name||"",n?.institution||"",e.type,e.categoryName||r,new Date(e.date).toLocaleDateString(),new Date(e.date).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),e.notes||"",e.tags?.join(" ")||""].join(" ").toLowerCase();return t.every(e=>s.includes(e))})}return e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())},[m,s,c,h,p,i,o,r]);Le.useEffect(()=>{const e=setTimeout(()=>{f(u)},150);return()=>clearTimeout(e)},[u]);const b=Le.useMemo(()=>{let e=0,t=0;return x.forEach(n=>{"income"===n.type||"transfer"===n.type&&n.amount>0?e+=n.amount:("expense"===n.type||"transfer"===n.type&&n.amount<0)&&(t+=Math.abs(n.amount))}),{income:e,expense:t,net:e-t}},[x]);return Le.useEffect(()=>{if(e&&m.length>0){const e=m.map(e=>new Date(e.date).getTime()),t=new Date(Math.min(...e)),n=new Date(Math.max(...e));s||l(t.toISOString().split("T")[0]),c||d(n.toISOString().split("T")[0])}},[e,m,s,c]),Le.useEffect(()=>{e||(g(""),v("all"),l(""),d(""))},[e]),e?ke.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end sm:items-center justify-center z-50",children:ke.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-t-lg sm:rounded-lg shadow-xl w-full sm:max-w-4xl max-h-[90vh] sm:max-h-[85vh] flex flex-col",children:[ke.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200 dark:border-gray-700",children:ke.jsxs("div",{className:"flex justify-between items-center",children:[ke.jsxs("div",{children:[ke.jsxs("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900 dark:text-white",children:['Transactions in "',r,'"']}),ke.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mt-1",children:[m.length," total transactions"]})]}),ke.jsx("button",{onClick:t,className:"p-1 -m-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:ke.jsx(Be,{size:24})})]})}),ke.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200 dark:border-gray-700 space-y-3",children:[ke.jsxs("div",{className:"flex flex-wrap gap-2",children:[ke.jsx("button",{onClick:()=>v("all"),className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors "+("all"===p?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"All Transactions"}),ke.jsx("button",{onClick:()=>v("income"),className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors "+("income"===p?"bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"All Income"}),ke.jsx("button",{onClick:()=>v("expense"),className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors "+("expense"===p?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"All Outgoings"})]}),ke.jsxs("div",{className:"flex flex-col gap-3",children:[ke.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[ke.jsx(Ye,{className:"text-gray-400 hidden sm:block",size:18}),ke.jsxs("div",{className:"flex flex-wrap gap-2 items-center flex-1",children:[ke.jsx("input",{type:"date",value:s,onChange:e=>l(e.target.value),className:"flex-1 min-w-[130px] px-2 py-1.5 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white text-sm"}),ke.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"to"}),ke.jsx("input",{type:"date",value:c,onChange:e=>d(e.target.value),className:"flex-1 min-w-[130px] px-2 py-1.5 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white text-sm"})]})]}),ke.jsxs("div",{className:"relative",children:[ke.jsx(Ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),ke.jsx("input",{type:"text",value:u,onChange:e=>g(e.target.value),placeholder:"Search transactions...",className:"w-full pl-9 pr-3 py-1.5 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white text-sm"}),u&&ke.jsx("button",{onClick:()=>g(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",title:"Clear search",children:ke.jsx(Ke,{size:18})})]})]}),ke.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[ke.jsxs("div",{children:[ke.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:r.toLowerCase().includes("transfer")?"Money In:":"Income:"}),ke.jsx("span",{className:"ml-2 font-medium text-green-600 dark:text-green-400",children:o(b.income)})]}),ke.jsxs("div",{children:[ke.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:r.toLowerCase().includes("transfer")?"Money Out:":"Expense:"}),ke.jsx("span",{className:"ml-2 font-medium text-red-600 dark:text-red-400",children:o(b.expense)})]}),ke.jsxs("div",{children:[ke.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Net:"}),ke.jsxs("span",{className:"ml-2 font-medium "+(r.toLowerCase().includes("transfer")&&Math.abs(b.net)<.01||b.net>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[o(b.net),r.toLowerCase().includes("transfer")&&Math.abs(b.net)<.01&&" \u2713"]})]})]})]}),ke.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:0===x.length?ke.jsxs("div",{className:"text-center py-12",children:[ke.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:u?`No transactions matching "${u}"`:s||c||"all"!==p?"No matching transactions found":"No transactions in this category"}),u&&ke.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"Try searching for partial words, amounts, or account names"}),(s||c||"all"!==p)&&!u&&ke.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"Try adjusting your filters or date range"})]}):ke.jsxs(ke.Fragment,{children:[u&&ke.jsxs("div",{className:"mb-3 text-sm text-gray-600 dark:text-gray-400",children:["Found ",x.length," transaction",1!==x.length?"s":"",' matching "',u,'"']}),ke.jsx("div",{className:"space-y-2",children:x.map(e=>{const t=i.find(t=>t.id===e.accountId);return ke.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:ke.jsx("div",{className:"flex-1",children:ke.jsxs("div",{className:"flex items-start justify-between",children:[ke.jsxs("div",{children:[ke.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.description}),ke.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:[new Date(e.date).toLocaleDateString()," \u2022 ",t?.name||"Unknown Account"]})]}),ke.jsxs("div",{className:"text-right ml-4",children:[ke.jsxs("p",{className:"font-medium "+("income"===e.type||"transfer"===e.type&&e.amount>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[e.amount>=0?"+":"-",o(Math.abs(e.amount))]}),ke.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"transfer"===e.type?`transfer (${e.amount>0?"in":"out"})`:e.type})]})]})})},e.id)})})]})}),ke.jsx("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:ke.jsxs("div",{className:"flex justify-between items-center",children:[ke.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Showing ",x.length," of ",m.length," transactions"]}),ke.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600",children:"Close"})]})})]})}):null}function t(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function n(e){return"nodeType"in e}function r(e){var r,a;return e?t(e)?e:n(e)&&null!=(r=null==(a=e.ownerDocument)?void 0:a.defaultView)?r:window:window}function a(e){const{Document:t}=r(e);return e instanceof t}function i(e){return!t(e)&&e instanceof r(e).HTMLElement}function o(e){return e instanceof r(e).SVGElement}function s(e){return e?t(e)?e.document:n(e)?a(e)?e:i(e)||o(e)?e.ownerDocument:document:document:document}function l(e){const t=Le.useRef(e);return He(()=>{t.current=e}),Le.useCallback(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)},[])}function c(e,t){void 0===t&&(t=[e]);const n=Le.useRef(e);return He(()=>{n.current!==e&&(n.current=e)},t),n}function d(e,t){const n=Le.useRef();return Le.useMemo(()=>{const t=e(n.current);return n.current=t,t},[...t])}function u(e){const t=l(e),n=Le.useRef(null),r=Le.useCallback(e=>{e!==n.current&&(null==t||t(e,n.current)),n.current=e},[]);return[n,r]}function g(e){const t=Le.useRef();return Le.useEffect(()=>{t.current=e},[e]),t.current}function h(e,t){return Le.useMemo(()=>{if(t)return t;const n=null==$e[e]?0:$e[e]+1;return $e[e]=n,e+"-"+n},[e,t])}function f(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.reduce((t,n)=>{const r=Object.entries(n);for(const[a,i]of r){const n=t[a];null!=n&&(t[a]=n+e*i)}return t},{...t})}}function p(e){if(!e)return!1;const{KeyboardEvent:t}=r(e.target);return t&&e instanceof t}function v(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=r(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}function m(e){return e.matches(Ge)?e:e.querySelector(Ge)}function x(e){let{id:t,value:n}=e;return ze.createElement("div",{id:t,style:Qe},n)}function b(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;return ze.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":r,"aria-atomic":!0},n)}function y(e){let{announcements:t=tt,container:n,hiddenTextDescribedById:r,screenReaderInstructions:a=et}=e;const{announce:i,announcement:o}=function(){const[e,t]=Le.useState("");return{announce:Le.useCallback(e=>{null!=e&&t(e)},[]),announcement:e}}(),s=h("DndLiveRegion"),[l,c]=Le.useState(!1);if(Le.useEffect(()=>{c(!0)},[]),function(e){const t=Le.useContext(Ze);Le.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}(Le.useMemo(()=>({onDragStart(e){let{active:n}=e;i(t.onDragStart({active:n}))},onDragMove(e){let{active:n,over:r}=e;t.onDragMove&&i(t.onDragMove({active:n,over:r}))},onDragOver(e){let{active:n,over:r}=e;i(t.onDragOver({active:n,over:r}))},onDragEnd(e){let{active:n,over:r}=e;i(t.onDragEnd({active:n,over:r}))},onDragCancel(e){let{active:n,over:r}=e;i(t.onDragCancel({active:n,over:r}))}}),[i,t])),!l)return null;const d=ze.createElement(ze.Fragment,null,ze.createElement(x,{id:r,value:a.draggable}),ze.createElement(b,{id:s,announcement:o}));return n?Pe.createPortal(d,n):d}function w(){}function k(e,t){return Le.useMemo(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}function C(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function j(e,t){const n=v(e);return n?(n.x-t.left)/t.width*100+"% "+(n.y-t.top)/t.height*100+"%":"0 0"}function N(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function D(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function E(e){let{left:t,top:n,height:r,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+r},{x:t+a,y:n+r}]}function S(e,t){if(!e||0===e.length)return null;const[n]=e;return n[t]}function R(e,t,n){return void 0===t&&(t=e.left),void 0===n&&(n=e.top),{x:t+.5*e.width,y:n+.5*e.height}}function M(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),o=a-r,s=i-n;if(r<a&&n<i){const n=t.width*t.height,r=e.width*e.height,a=o*s;return Number((a/(n+r-a)).toFixed(4))}return 0}function I(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:at}function O(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.reduce((t,n)=>({...t,top:t.top+e*n.y,bottom:t.bottom+e*n.y,left:t.left+e*n.x,right:t.right+e*n.x}),{...t})}}function T(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function A(e,t){void 0===t&&(t=lt);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:a}=r(e).getComputedStyle(e);t&&(n=function(e,t,n){const r=T(t);if(!r)return e;const{scaleX:a,scaleY:i,x:o,y:s}=r,l=e.left-o-(1-a)*parseFloat(n),c=e.top-s-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),d=a?e.width/a:e.width,u=i?e.height/i:e.height;return{width:d,height:u,top:c,right:l+d,bottom:c+u,left:l}}(n,t,a))}const{top:a,left:i,width:o,height:s,bottom:l,right:c}=n;return{top:a,left:i,width:o,height:s,bottom:l,right:c}}function L(e){return A(e,{ignoreTransform:!0})}function z(e,t){const n=[];return e?function s(l){if(null!=t&&n.length>=t)return n;if(!l)return n;if(a(l)&&null!=l.scrollingElement&&!n.includes(l.scrollingElement))return n.push(l.scrollingElement),n;if(!i(l)||o(l))return n;if(n.includes(l))return n;const c=r(e).getComputedStyle(l);return l!==e&&function(e,t){void 0===t&&(t=r(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const r=t[e];return"string"==typeof r&&n.test(r)})}(l,c)&&n.push(l),function(e,t){return void 0===t&&(t=r(e).getComputedStyle(e)),"fixed"===t.position}(l,c)?n:s(l.parentNode)}(e):n}function P(e){const[t]=z(e,1);return null!=t?t:null}function B(e){return Ve&&e?t(e)?e:n(e)?a(e)||e===s(e).scrollingElement?window:i(e)?e:null:null:null}function F(e){return t(e)?e.scrollX:e.scrollLeft}function W(e){return t(e)?e.scrollY:e.scrollTop}function X(e){return{x:F(e),y:W(e)}}function Y(e){return!(!Ve||!e)&&e===document.scrollingElement}function U(e){const t={x:0,y:0},n=Y(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=r.y,isRight:e.scrollLeft>=r.x,maxScroll:r,minScroll:t}}function K(e,t,n,r,a){let{top:i,left:o,right:s,bottom:l}=n;void 0===r&&(r=10),void 0===a&&(a=ut);const{isTop:c,isBottom:d,isLeft:u,isRight:g}=U(e),h={x:0,y:0},f={x:0,y:0},p=t.height*a.y,v=t.width*a.x;return!c&&i<=t.top+p?(h.y=ct.Backward,f.y=r*Math.abs((t.top+p-i)/p)):!d&&l>=t.bottom-p&&(h.y=ct.Forward,f.y=r*Math.abs((t.bottom-p-l)/p)),!g&&s>=t.right-v?(h.x=ct.Forward,f.x=r*Math.abs((t.right-v-s)/v)):!u&&o<=t.left+v&&(h.x=ct.Backward,f.x=r*Math.abs((t.left+v-o)/v)),{direction:h,speed:f}}function V(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:n,right:r,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:a,width:e.clientWidth,height:e.clientHeight}}function H(e){return e.reduce((e,t)=>Je(e,X(t)),at)}function $(e,t){if(void 0===t&&(t=A),!e)return;const{top:n,left:r,bottom:a,right:i}=t(e);P(e)&&(a<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}function J(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return"number"==typeof t?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t&&r>t.y}function q(e){e.preventDefault()}function _(e){e.stopPropagation()}function G(e){return Boolean(e&&"distance"in e)}function Q(e){return Boolean(e&&"delay"in e)}function Z(e,t){return d(n=>e?n||("function"==typeof t?t(e):e):null,[t,e])}function ee(e){let{callback:t,disabled:n}=e;const r=l(t),a=Le.useMemo(()=>{if(n||"undefined"==typeof window||void 0===window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(r)},[n]);return Le.useEffect(()=>()=>null==a?void 0:a.disconnect(),[a]),a}function te(e){return new ht(A(e),e)}function ne(e,t,n){function r(){i(r=>{if(!e)return null;var a;if(!1===e.isConnected)return null!=(a=null!=r?r:n)?a:null;const i=t(e);return JSON.stringify(r)===JSON.stringify(i)?r:i})}void 0===t&&(t=te);const[a,i]=Le.useState(null),o=function(e){let{callback:t,disabled:n}=e;const r=l(t),a=Le.useMemo(()=>{if(n||"undefined"==typeof window||void 0===window.MutationObserver)return;const{MutationObserver:e}=window;return new e(r)},[r,n]);return Le.useEffect(()=>()=>null==a?void 0:a.disconnect(),[a]),a}({callback(t){if(e)for(const n of t){const{type:t,target:a}=n;if("childList"===t&&a instanceof HTMLElement&&a.contains(e)){r();break}}}}),s=ee({callback:r});return He(()=>{r(),e?(null==s||s.observe(e),null==o||o.observe(document.body,{childList:!0,subtree:!0})):(null==s||s.disconnect(),null==o||o.disconnect())},[e]),a}function re(e,t){void 0===t&&(t=[]);const n=Le.useRef(null);return Le.useEffect(()=>{n.current=null},t),Le.useEffect(()=>{const t=e!==at;t&&!n.current&&(n.current=e),!t&&n.current&&(n.current=null)},[e]),n.current?qe(e,n.current):at}function ae(e){return Le.useMemo(()=>e?function(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}(e):null,[e])}function ie(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return i(t)?t:e}function oe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ut}}}function se(e,t){switch(t.type){case nt.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case nt.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case nt.DragEnd:case nt.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case nt.RegisterDroppable:{const{element:n}=t,{id:r}=n,a=new Ut(e.droppable.containers);return a.set(r,n),{...e,droppable:{...e.droppable,containers:a}}}case nt.SetDroppableDisabled:{const{id:n,key:r,disabled:a}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const o=new Ut(e.droppable.containers);return o.set(n,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:o}}}case nt.UnregisterDroppable:{const{id:n,key:r}=t,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const i=new Ut(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function le(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:a}=Le.useContext(Ht),i=g(r),o=g(null==n?void 0:n.id);return Le.useEffect(()=>{if(!t&&!r&&i&&null!=o){if(!p(i))return;if(document.activeElement===i.target)return;const e=a.get(o);if(!e)return;const{activatorNode:t,node:n}=e;if(!t.current&&!n.current)return;requestAnimationFrame(()=>{for(const e of[t.current,n.current]){if(!e)continue;const t=m(e);if(t){t.focus();break}}})}},[r,t,a,o,i]),null}function ce(e,t){let{transform:n,...r}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...r}),n):n}function de(){return Le.useContext($t)}function ue(e){let{animation:t,children:n}=e;const[r,a]=Le.useState(null),[i,o]=Le.useState(null),s=g(n);return n||r||!s||a(s),He(()=>{if(!i)return;const e=null==r?void 0:r.key,n=null==r?void 0:r.props.id;null!=e&&null!=n?Promise.resolve(t(n,i)).then(()=>{a(null)}):a(null)},[t,r,i]),ze.createElement(ze.Fragment,null,n,r?Le.cloneElement(r,{ref:o}):null)}function ge(e){let{children:t}=e;return ze.createElement(Ht.Provider,{value:Vt},ze.createElement(Jt.Provider,{value:tn},t))}function he(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function fe(e,t){return e.reduce((e,n,r)=>{const a=t.get(n);return a&&(e[r]=a),e},Array(e.length))}function pe(e){return null!==e&&e>=0}function ve(e){let{children:t,id:n,items:r,strategy:a=cn,disabled:i=!1}=e;const{active:o,dragOverlay:s,droppableRects:l,over:c,measureDroppableContainers:d}=de(),u=h(gn,n),g=Boolean(null!==s.rect),f=Le.useMemo(()=>r.map(e=>"object"==typeof e&&"id"in e?e.id:e),[r]),p=null!=o,v=o?f.indexOf(o.id):-1,m=c?f.indexOf(c.id):-1,x=Le.useRef(f),b=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(f,x.current),y=-1!==m&&-1===v||b,w=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(i);He(()=>{b&&p&&d(f)},[b,f,p,d]),Le.useEffect(()=>{x.current=f},[f]);const k=Le.useMemo(()=>({activeIndex:v,containerId:u,disabled:w,disableTransforms:y,items:f,overIndex:m,useDragOverlay:g,sortedRects:fe(f,l),strategy:a}),[v,u,w.draggable,w.droppable,y,f,m,l,g,a]);return ze.createElement(hn.Provider,{value:k},t)}function me(e){let{animateLayoutChanges:t=pn,attributes:n,disabled:r,data:a,getNewIndex:i=fn,id:o,strategy:s,resizeObserverConfig:l,transition:d=vn}=e;const{items:g,containerId:f,activeIndex:v,disabled:m,disableTransforms:x,sortedRects:b,overIndex:y,useDragOverlay:w,strategy:k}=Le.useContext(hn),C=function(e,t){var n,r;return"boolean"==typeof e?{draggable:e,droppable:!1}:{draggable:null!=(n=null==e?void 0:e.draggable)?n:t.draggable,droppable:null!=(r=null==e?void 0:e.droppable)?r:t.droppable}}(r,m),j=g.indexOf(o),N=Le.useMemo(()=>({sortable:{containerId:f,index:j,items:g},...a}),[f,a,j,g]),D=Le.useMemo(()=>g.slice(g.indexOf(o)),[g,o]),{rect:E,node:S,isOver:R,setNodeRef:M}=function(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:a}=e;const i=h("Droppable"),{active:o,dispatch:s,over:l,measureDroppableContainers:d}=Le.useContext(Ht),g=Le.useRef({disabled:n}),f=Le.useRef(!1),p=Le.useRef(null),v=Le.useRef(null),{disabled:m,updateMeasurementsFor:x,timeout:b}={...en,...a},y=c(null!=x?x:r),w=ee({callback:Le.useCallback(()=>{f.current?(null!=v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{d(Array.isArray(y.current)?y.current:[y.current]),v.current=null},b)):f.current=!0},[b]),disabled:m||!o}),k=Le.useCallback((e,t)=>{w&&(t&&(w.unobserve(t),f.current=!1),e&&w.observe(e))},[w]),[C,j]=u(k),N=c(t);return Le.useEffect(()=>{w&&C.current&&(w.disconnect(),f.current=!1,w.observe(C.current))},[C,w]),Le.useEffect(()=>(s({type:nt.RegisterDroppable,element:{id:r,key:i,disabled:n,node:C,rect:p,data:N}}),()=>s({type:nt.UnregisterDroppable,key:i,id:r})),[r]),Le.useEffect(()=>{n!==g.current.disabled&&(s({type:nt.SetDroppableDisabled,id:r,key:i,disabled:n}),g.current.disabled=n)},[r,i,n,s]),{active:o,rect:p,isOver:(null==l?void 0:l.id)===r,node:C,over:l,setNodeRef:j}}({id:o,data:N,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:D,...l}}),{active:I,activatorEvent:O,activeNodeRect:T,attributes:L,setNodeRef:z,listeners:P,isDragging:B,over:F,setActivatorNodeRef:W,transform:X}=function(e){let{id:t,data:n,disabled:r=!1,attributes:a}=e;const i=h("Draggable"),{activators:o,activatorEvent:s,active:l,activeNodeRect:d,ariaDescribedById:g,draggableNodes:f,over:p}=Le.useContext(Ht),{role:v=Zt,roleDescription:m="draggable",tabIndex:x=0}=null!=a?a:{},b=(null==l?void 0:l.id)===t,y=Le.useContext(b?Jt:Qt),[w,k]=u(),[C,j]=u(),N=function(e,t){return Le.useMemo(()=>e.reduce((e,n)=>{let{eventName:r,handler:a}=n;return e[r]=e=>{a(e,t)},e},{}),[e,t])}(o,t),D=c(n);return He(()=>(f.set(t,{id:t,key:i,node:w,activatorNode:C,data:D}),()=>{const e=f.get(t);e&&e.key===i&&f.delete(t)}),[f,t]),{active:l,activatorEvent:s,activeNodeRect:d,attributes:Le.useMemo(()=>({role:v,tabIndex:x,"aria-disabled":r,"aria-pressed":!(!b||v!==Zt)||void 0,"aria-roledescription":m,"aria-describedby":g.draggable}),[r,v,x,b,m,g.draggable]),isDragging:b,listeners:r?void 0:N,node:w,over:p,setNodeRef:k,setActivatorNodeRef:j,transform:y}}({id:o,data:N,attributes:{...bn,...n},disabled:C.draggable}),Y=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Le.useMemo(()=>e=>{t.forEach(t=>t(e))},t)}(M,z),U=Boolean(I),K=U&&!x&&pe(v)&&pe(y),V=!w&&B,H=V&&K?X:null,$=K?null!=H?H:(null!=s?s:k)({rects:b,activeNodeRect:T,activeIndex:v,overIndex:y,index:j}):null,J=pe(v)&&pe(y)?i({id:o,items:g,activeIndex:v,overIndex:y}):j,q=null==I?void 0:I.id,_=Le.useRef({activeId:q,items:g,newIndex:J,containerId:f}),G=g!==_.current.items,Q=t({active:I,containerId:f,isDragging:B,isSorting:U,id:o,index:j,items:g,newIndex:_.current.newIndex,previousItems:_.current.items,previousContainerId:_.current.containerId,transition:d,wasDragging:null!=_.current.activeId}),Z=function(e){let{disabled:t,index:n,node:r,rect:a}=e;const[i,o]=Le.useState(null),s=Le.useRef(n);return He(()=>{if(!t&&n!==s.current&&r.current){const e=a.current;if(e){const t=A(r.current,{ignoreTransform:!0}),n={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(n.x||n.y)&&o(n)}}n!==s.current&&(s.current=n)},[t,n,r,a]),Le.useEffect(()=>{i&&o(null)},[i]),i}({disabled:!Q,index:j,node:S,rect:E});return Le.useEffect(()=>{U&&_.current.newIndex!==J&&(_.current.newIndex=J),f!==_.current.containerId&&(_.current.containerId=f),g!==_.current.items&&(_.current.items=g)},[U,J,f,g]),Le.useEffect(()=>{if(q===_.current.activeId)return;if(null!=q&&null==_.current.activeId)return void(_.current.activeId=q);const e=setTimeout(()=>{_.current.activeId=q},50);return()=>clearTimeout(e)},[q]),{active:I,activeIndex:v,attributes:L,data:N,rect:E,index:j,newIndex:J,items:g,isOver:R,isSorting:U,isDragging:B,listeners:P,node:S,overIndex:y,over:F,setNodeRef:Y,setActivatorNodeRef:W,setDroppableNodeRef:M,setDraggableNodeRef:z,transform:null!=Z?Z:$,transition:Z||G&&_.current.newIndex===j?xn:V&&!p(O)||!d?void 0:U||Q?_e.Transition.toString({...d,property:mn}):void 0}}function xe(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}function be(e,t){return!(!xe(e)||!xe(t))&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}function ye({category:e,isEditMode:t,isDeleteMode:n,isEditing:r,editingName:a,onEdit:i,onDelete:o,onNameChange:s,onSave:l,onCancel:c,onClick:d,children:u,isDraggable:g=!0}){const{attributes:h,listeners:f,setNodeRef:p,transform:v,transition:m,isDragging:x}=me({id:e.id,disabled:!t||!g||n}),b={transform:_e.Transform.toString(v),transition:m};return ke.jsx("div",{ref:p,style:b,children:ke.jsxs("div",{className:`flex items-center justify-between p-2 rounded ${x?"opacity-50":""} ${t?"hover:bg-gray-100 dark:hover:bg-gray-700":"hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[ke.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t&&g&&ke.jsx("div",{...h,...f,className:"cursor-move text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:ke.jsx(Oe,{size:16})}),!t&&!g&&ke.jsx("span",{className:"w-4"}),r?ke.jsx("input",{type:"text",value:a,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key?l():"Escape"===e.key&&c()},className:"px-2 py-1 bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm border border-gray-300/50 dark:border-gray-600/50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent dark:text-white flex-1",autoFocus:!0,onClick:e=>e.stopPropagation()}):ke.jsx("div",{className:"flex items-center gap-2 flex-1 "+(t||n||!d?"":"cursor-pointer"),onClick:e=>{e.stopPropagation(),n?o():t?i():d&&d()},children:ke.jsx("span",{className:`${"sub"===e.level?"font-medium":""} text-gray-900 dark:text-white ${n?"hover:text-red-600 dark:hover:text-red-400":t?"hover:text-primary dark:hover:text-primary":t||n?"":"hover:text-primary dark:hover:text-primary"}`,children:e.name})})]}),ke.jsx("div",{className:"flex items-center gap-2",children:r?ke.jsxs(ke.Fragment,{children:[ke.jsx(We,{onClick:l,icon:ke.jsx(Te,{size:16}),variant:"ghost",size:"sm",className:"text-gray-500 hover:text-gray-700"}),ke.jsx(We,{onClick:c,icon:ke.jsx(Ae,{size:16}),variant:"ghost",size:"sm",className:"text-gray-500 hover:text-gray-700"})]}):ke.jsx(ke.Fragment,{children:u})})]})})}function we(){const{transactions:t,categories:n,updateCategory:r,deleteCategory:a,updateTransaction:i,getSubCategories:o,getDetailCategories:s}=je(),l=e=>{const t=n.find(t=>t.id===e);if(!t)return e;if("detail"===t.level&&t.parentId){const e=n.find(e=>e.id===t.parentId);return e?`${e.name} > ${t.name}`:t.name}return t.name},[c,d]=Le.useState(!1),[u,g]=Le.useState(!1),[h,f]=Le.useState(null),[p,v]=Le.useState(""),[m,x]=Le.useState(!1),[b,y]=Le.useState(null),[w,C]=Le.useState(""),[j,N]=Le.useState(new Set),[D,E]=Le.useState(null),[S,R]=Le.useState({}),[M,I]=Le.useState(null),[O,T]=Le.useState(""),[A,L]=Le.useState(!1);Le.useState(()=>{const e={};return[...new Set(n.map(e=>e.parentId).filter(Boolean))].forEach(t=>{t&&(e[t]=n.filter(e=>e.parentId===t).map(e=>e.id))}),R(e),null});const z=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Le.useMemo(()=>[...t].filter(e=>null!=e),[...t])}(k(jt,{activationConstraint:{distance:8}}),k(wt,{coordinateGetter:wn})),P=(e,t)=>{f(e),v(t)},B=()=>{h&&p.trim()&&(r(h,{name:p.trim()}),f(null),v(""))},F=()=>{f(null),v("")},W=e=>{const r=n.find(t=>t.id===e);if(!r)return;const i=t.filter(t=>t.category===e).length;n.filter(t=>t.parentId===e).length>0?alert("Cannot delete category with subcategories. Delete subcategories first."):i>0?(y(e),C("")):confirm(`Are you sure you want to delete "${r.name}"?`)&&a(e)},X=(e,t)=>{c||u||(I(e),T(t))},Y=(e,r)=>{const a=[...o(r)].sort((e,t)=>{const n=S[r]||[],a=n.indexOf(e.id),i=n.indexOf(t.id);return-1!==a&&-1!==i?a-i:-1!==a?-1:-1!==i?1:0}),i=a.flatMap(e=>s(e.id).map(e=>e.id));return ke.jsxs("div",{children:[ke.jsx("h3",{className:"text-lg font-medium text-gray-700 dark:text-gray-300 mb-3",children:e}),ke.jsx(ve,{items:[...a.map(e=>e.id),...i],strategy:un,children:ke.jsx("div",{className:"space-y-1",children:a.map(e=>{const r=j.has(e.id),a=[...s(e.id)].sort((t,n)=>{const r=S[e.id]||[],a=r.indexOf(t.id),i=r.indexOf(n.id);return-1!==a&&-1!==i?a-i:-1!==a?-1:-1!==i?1:0}),i=t.filter(t=>{const r=n.find(e=>e.id===t.category);return r&&(r.id===e.id||r.parentId===e.id)}).length;return ke.jsxs("div",{children:[ke.jsx(ye,{category:e,isEditMode:c,isDeleteMode:u,isEditing:h===e.id,editingName:p,onEdit:()=>P(e.id,e.name),onDelete:()=>W(e.id),onNameChange:v,onSave:B,onCancel:F,onClick:()=>X(e.id,e.name),isDraggable:!0,children:ke.jsxs("div",{className:"flex items-center gap-2",children:[a.length>0&&ke.jsx(We,{onClick:t=>{t?.stopPropagation(),(e=>{const t=new Set(j);t.has(e)?t.delete(e):t.add(e),N(t)})(e.id)},icon:r?ke.jsx(Me,{size:16}):ke.jsx(Ie,{size:16}),variant:"ghost",size:"sm",className:"text-gray-500 hover:text-gray-700"}),!c&&ke.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",i,")"]})]})}),r&&a.length>0&&ke.jsx("div",{className:"ml-8 space-y-1",children:a.map(e=>{const n=t.filter(t=>t.category===e.id).length;return ke.jsx(ye,{category:e,isEditMode:c,isDeleteMode:u,isEditing:h===e.id,editingName:p,onEdit:()=>P(e.id,e.name),onDelete:()=>W(e.id),onNameChange:v,onSave:B,onCancel:F,onClick:()=>X(e.id,e.name),isDraggable:!0,children:!c&&ke.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",n,")"]})},e.id)})})]},e.id)})})})]})};return ke.jsxs(Xe,{title:"Categories",rightContent:ke.jsxs("div",{className:"flex gap-2",children:[ke.jsx("button",{onClick:()=>{d(!c),u&&g(!1),f(null)},className:"w-8 h-8 flex items-center justify-center transition-colors "+(c?"text-white bg-gray-600 hover:bg-gray-700":"text-gray-500 hover:text-gray-700"),title:c?"Done Editing":"Edit Categories",children:ke.jsx(Ee,{size:16})}),c&&ke.jsx(We,{onClick:()=>g(!u),icon:ke.jsx(Se,{size:16}),variant:u?"danger":"ghost",size:"sm",className:u?"":"text-gray-500 hover:text-gray-700",title:u?"Cancel Delete":"Delete Categories"}),ke.jsx(We,{onClick:()=>x(!0),icon:ke.jsx(Re,{size:16}),variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",title:"Add Category"})]}),children:[c||u?ke.jsx("div",{className:"border rounded-2xl p-4 mb-6 "+(u?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"),children:ke.jsxs("div",{className:"text-sm space-y-2 "+(u?"text-red-800 dark:text-red-200":"text-blue-800 dark:text-blue-200"),children:[ke.jsx("p",{children:ke.jsx("strong",{children:u?"Delete Mode Active:":"Edit Mode Active:"})}),ke.jsx("ul",{className:"list-disc list-inside space-y-1 ml-2",children:u?ke.jsxs(ke.Fragment,{children:[ke.jsx("li",{children:"Click on any category to delete it"}),ke.jsx("li",{children:"Categories with transactions will prompt for reassignment"}),ke.jsx("li",{children:"Categories with subcategories must have subcategories deleted first"})]}):ke.jsxs(ke.Fragment,{children:[ke.jsx("li",{children:"Click on any category name to rename it"}),ke.jsx("li",{children:"Drag detail categories to different subcategories to reorganize them"}),ke.jsx("li",{children:"Toggle Delete Mode to remove categories"}),ke.jsx("li",{children:"Default categories can be edited just like custom ones"})]})})]})}):ke.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-2xl p-4 mb-6",children:ke.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[ke.jsxs("p",{className:"mb-2",children:["\ud83d\udca1 ",ke.jsx("strong",{children:"Tip:"})]}),ke.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[ke.jsx("li",{children:"Click on any category name to view its transactions"}),ke.jsx("li",{children:"Click the arrow buttons to expand/collapse subcategories"}),ke.jsx("li",{children:"Use Edit Mode to rename or reorganize categories"}),ke.jsx("li",{children:"The number in parentheses shows how many transactions are in each category"})]})]})}),ke.jsx("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl rounded-2xl shadow-lg border border-white/20 dark:border-gray-700/50 p-6",children:ke.jsxs(Gt,{sensors:z,collisionDetection:it,onDragStart:e=>{E(e.active.id)},onDragEnd:e=>{const{active:t,over:a}=e;if(E(null),!a||t.id===a.id)return;const i=n.find(e=>e.id===t.id),o=n.find(e=>e.id===a.id);if(i&&o){if(i.parentId===o.parentId&&i.level===o.level){const e=i.parentId||"",n=S[e]||[],r=n.indexOf(t.id),o=n.indexOf(a.id);if(-1!==r&&-1!==o){const t=he(n,r,o);R(n=>({...n,[e]:t}))}return}if("detail"!==i.level||"sub"!==o.level){if("detail"===i.level&&"detail"===o.level&&i.parentId!==o.parentId){r(t.id,{parentId:o.parentId});const e=i.parentId||"",n=o.parentId||"";S[e]&&R(n=>({...n,[e]:n[e].filter(e=>e!==t.id)}));const s=S[n]?.indexOf(a.id)||0;return void R(e=>({...e,[n]:[...(e[n]||[]).slice(0,s+1),t.id,...(e[n]||[]).slice(s+1).filter(e=>e!==t.id)]}))}if("sub"===i.level&&"sub"===o.level){const e=n.find(e=>e.id===i.parentId),s=n.find(e=>e.id===o.parentId);if(e&&s&&e.id!==s.id){r(t.id,{parentId:s.id,type:"type-income"===s.id?"income":"type-expense"===s.id?"expense":"both"});const e=i.parentId||"",n=s.id;S[e]&&R(n=>({...n,[e]:n[e].filter(e=>e!==t.id)}));const o=S[n]?.indexOf(a.id)||0;R(e=>({...e,[n]:[...(e[n]||[]).slice(0,o+1),t.id,...(e[n]||[]).slice(o+1).filter(e=>e!==t.id)]}))}else if(e&&s&&e.id===s.id){const n=e.id,r=S[n]||[],i=r.indexOf(t.id),o=r.indexOf(a.id);if(-1!==i&&-1!==o){const e=he(r,i,o);R(t=>({...t,[n]:e}))}}return}}else if(i.type===o.type||"both"===i.type||"both"===o.type){r(t.id,{parentId:a.id});const e=i.parentId||"",n=a.id;S[e]&&R(n=>({...n,[e]:n[e].filter(e=>e!==t.id)})),R(e=>({...e,[n]:[...e[n]||[],t.id]}))}}},children:[ke.jsxs("div",{className:"space-y-6",children:[Y("Income Categories","type-income"),Y("Expense Categories","type-expense"),Y("Transfer Categories","type-transfer"),ke.jsxs("div",{children:[ke.jsx("h3",{className:"text-lg font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Other Categories"}),ke.jsx("div",{className:"space-y-1",children:n.filter(e=>"both"===e.type&&"detail"===e.level&&!e.parentId).map(e=>{const n=t.filter(t=>t.category===e.id).length;return ke.jsx("div",{className:"ml-4",children:ke.jsx(ye,{category:e,isEditMode:c,isDeleteMode:u,isEditing:h===e.id,editingName:p,onEdit:()=>P(e.id,e.name),onDelete:()=>W(e.id),onNameChange:v,onSave:B,onCancel:F,onClick:()=>X(e.id,e.name),isDraggable:!1,children:!c&&ke.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",n,")"]})})},e.id)})})]})]}),ke.jsx(ln,{children:D?ke.jsx("div",{className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-xl p-2 rounded-2xl shadow-lg border border-white/20 dark:border-gray-700/50 opacity-90",children:n.find(e=>e.id===D)?.name}):null})]})}),b&&ke.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:ke.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-md w-full",children:[ke.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[ke.jsx(Ne,{className:"text-orange-500",size:24}),ke.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Category"})]}),(()=>{const e=n.find(e=>e.id===b),r=t.filter(e=>e.category===b).length;return ke.jsxs(ke.Fragment,{children:[ke.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:['The category "',e?.name,'" has ',r," transaction",1!==r?"s":""," associated with it."]}),ke.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Please select a category to reassign these transactions to:"}),ke.jsxs("select",{value:w,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm border border-gray-300/50 dark:border-gray-600/50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent dark:text-white mb-6",children:[ke.jsx("option",{value:"",children:"Select a category..."}),n.filter(t=>t.id!==b&&"detail"===t.level&&("both"===e?.type||"both"===t.type||t.type===e?.type)).map(e=>ke.jsx("option",{value:e.id,children:l(e.id)},e.id))]}),ke.jsxs("div",{className:"flex gap-3",children:[ke.jsx("button",{onClick:()=>{y(null),C("")},className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),ke.jsx("button",{onClick:()=>{w&&(t.filter(e=>e.category===b).forEach(e=>{i(e.id,{category:w})}),a(b),y(null),C(""))},className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50",disabled:!w,children:"Delete & Reassign"})]})]})})()]})}),ke.jsx(De,{isOpen:m,onClose:()=>x(!1)}),M&&!A&&ke.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:ke.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-md w-full",children:[ke.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"View Transactions"}),ke.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:['Would you like to see all transactions in the "',O,'" category?']}),ke.jsxs("div",{className:"flex gap-3",children:[ke.jsx("button",{onClick:()=>{I(null),T("")},className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),ke.jsx("button",{onClick:()=>{L(!0)},className:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary",children:"View Transactions"})]})]})}),A&&M&&ke.jsx(e,{isOpen:!0,onClose:()=>{L(!1),I(null),T("")},categoryId:M,categoryName:O})]})}import{j as ke,bt as Ce,g as je,ar as Ne,z as De,be as Ee,V as Se,ag as Re,a2 as Me,a7 as Ie,bu as Oe,_ as Te,X as Ae}from"./index-Pkjq0qn3.js";import{a as Le,n as ze,f as Pe}from"./chunk-BWx9oMeS.js";import{X as Be}from"./chunk-B7HJJKUW.js";import{u as Fe}from"./chunk-BYFRQ0Wn.js";import{I as We}from"./chunk-B2-J6WC6.js";import{P as Xe}from"./chunk-BnYLBI7x.js";import"./chunk-BN8kgYrt.js";import"./chunk-Drd-K-oK.js";const Ye=e=>ke.jsxs(Ce,{...e,children:[ke.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2",fill:"none"}),ke.jsx("path",{d:"M16 2V6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),ke.jsx("path",{d:"M8 2V6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),ke.jsx("path",{d:"M3 10H21",stroke:"currentColor",strokeWidth:"2"})]}),Ue=e=>ke.jsxs(Ce,{...e,children:[ke.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:"currentColor",strokeWidth:"2",fill:"none"}),ke.jsx("path",{d:"M21 21L16.65 16.65",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),Ke=e=>ke.jsxs(Ce,{...e,children:[ke.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),ke.jsx("path",{d:"M15 9L9 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),ke.jsx("path",{d:"M9 9L15 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),Ve="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,He=Ve?Le.useLayoutEffect:Le.useEffect;let $e={};const Je=f(1),qe=f(-1),_e=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[_e.Translate.toString(e),_e.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Ge="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",Qe={display:"none"},Ze=Le.createContext(null),et={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},tt={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};var nt,rt;(rt=nt||(nt={})).DragStart="dragStart",rt.DragMove="dragMove",rt.DragEnd="dragEnd",rt.DragCancel="dragCancel",rt.DragOver="dragOver",rt.RegisterDroppable="registerDroppable",rt.SetDroppableDisabled="setDroppableDisabled",rt.UnregisterDroppable="unregisterDroppable";const at=Object.freeze({x:0,y:0}),it=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const a=R(t,t.left,t.top),i=[];for(const o of r){const{id:e}=o,t=n.get(e);if(t){const n=C(R(t),a);i.push({id:e,data:{droppableContainer:o,value:n}})}}return i.sort(N)},ot=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const a=[];for(const i of r){const{id:e}=i,r=n.get(e);if(r){const n=M(r,t);n>0&&a.push({id:e,data:{droppableContainer:i,value:n}})}}return a.sort(D)},st=O(1),lt={ignoreTransform:!1};var ct,dt;(dt=ct||(ct={}))[dt.Forward=1]="Forward",dt[dt.Backward=-1]="Backward";const ut={x:.2,y:.2},gt=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+F(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+W(t),0)}]];class ht{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=z(t),r=H(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,i,o]of gt)for(const e of i)Object.defineProperty(this,e,{get:()=>{const t=o(n),i=r[a]-t;return this.rect[e]+i},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ft{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,n){var r;null==(r=this.target)||r.addEventListener(e,t,n),this.listeners.push([e,t,n])}}var pt,vt,mt,xt;(vt=pt||(pt={})).Click="click",vt.DragStart="dragstart",vt.Keydown="keydown",vt.ContextMenu="contextmenu",vt.Resize="resize",vt.SelectionChange="selectionchange",vt.VisibilityChange="visibilitychange",(xt=mt||(mt={})).Space="Space",xt.Down="ArrowDown",xt.Right="ArrowRight",xt.Left="ArrowLeft",xt.Up="ArrowUp",xt.Esc="Escape",xt.Enter="Enter",xt.Tab="Tab";const bt={start:[mt.Space,mt.Enter],cancel:[mt.Esc],end:[mt.Space,mt.Enter,mt.Tab]},yt=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case mt.Right:return{...n,x:n.x+25};case mt.Left:return{...n,x:n.x-25};case mt.Down:return{...n,y:n.y+25};case mt.Up:return{...n,y:n.y-25}}};class wt{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new ft(s(t)),this.windowListeners=new ft(r(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(pt.Resize,this.handleCancel),this.windowListeners.add(pt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(pt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&$(n),t(at)}handleKeyDown(e){if(p(e)){const{active:t,context:n,options:r}=this.props,{keyboardCodes:a=bt,coordinateGetter:i=yt,scrollBehavior:o="smooth"}=r,{code:s}=e;if(a.end.includes(s))return void this.handleEnd(e);if(a.cancel.includes(s))return void this.handleCancel(e);const{collisionRect:l}=n.current,c=l?{x:l.left,y:l.top}:at;this.referenceCoordinates||(this.referenceCoordinates=c);const d=i(e,{active:t,context:n.current,currentCoordinates:c});if(d){const t=qe(d,c),r={x:0,y:0},{scrollableAncestors:a}=n.current;for(const n of a){const a=e.code,{isTop:i,isRight:s,isLeft:l,isBottom:c,maxScroll:u,minScroll:g}=U(n),h=V(n),f={x:Math.min(a===mt.Right?h.right-h.width/2:h.right,Math.max(a===mt.Right?h.left:h.left+h.width/2,d.x)),y:Math.min(a===mt.Down?h.bottom-h.height/2:h.bottom,Math.max(a===mt.Down?h.top:h.top+h.height/2,d.y))},p=a===mt.Right&&!s||a===mt.Left&&!l,v=a===mt.Down&&!c||a===mt.Up&&!i;if(p&&f.x!==d.x){const e=n.scrollLeft+t.x,i=a===mt.Right&&e<=u.x||a===mt.Left&&e>=g.x;if(i&&!t.y)return void n.scrollTo({left:e,behavior:o});r.x=i?n.scrollLeft-e:a===mt.Right?n.scrollLeft-u.x:n.scrollLeft-g.x,r.x&&n.scrollBy({left:-r.x,behavior:o});break}if(v&&f.y!==d.y){const e=n.scrollTop+t.y,i=a===mt.Down&&e<=u.y||a===mt.Up&&e>=g.y;if(i&&!t.x)return void n.scrollTo({top:e,behavior:o});r.y=i?n.scrollTop-e:a===mt.Down?n.scrollTop-u.y:n.scrollTop-g.y,r.y&&n.scrollBy({top:-r.y,behavior:o});break}}this.handleMove(e,Je(qe(d,this.referenceCoordinates),r))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}wt.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=bt,onActivation:a}=t,{active:i}=n;const{code:o}=e.nativeEvent;if(r.start.includes(o)){const t=i.activatorNode.current;return!(t&&e.target!==t||(e.preventDefault(),null==a||a({event:e.nativeEvent}),0))}return!1}}];class kt{constructor(e,t,n){var a;void 0===n&&(n=function(e){const{EventTarget:t}=r(e);return e instanceof t?e:s(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:i}=e,{target:o}=i;this.props=e,this.events=t,this.document=s(o),this.documentListeners=new ft(this.document),this.listeners=new ft(n),this.windowListeners=new ft(r(o)),this.initialCoordinates=null!=(a=v(i))?a:at,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(pt.Resize,this.handleCancel),this.windowListeners.add(pt.DragStart,q),this.windowListeners.add(pt.VisibilityChange,this.handleCancel),this.windowListeners.add(pt.ContextMenu,q),this.documentListeners.add(pt.Keydown,this.handleKeydown),t){if(null!=n&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Q(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(G(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:r}=this.props;r(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(pt.Click,_,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(pt.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:r,props:a}=this,{onMove:i,options:{activationConstraint:o}}=a;if(!r)return;const s=null!=(t=v(e))?t:at,l=qe(r,s);if(!n&&o){if(G(o)){if(null!=o.tolerance&&J(l,o.tolerance))return this.handleCancel();if(J(l,o.distance))return this.handleStart()}return Q(o)&&J(l,o.tolerance)?this.handleCancel():void this.handlePending(o,l)}e.cancelable&&e.preventDefault(),i(s)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===mt.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const Ct={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class jt extends kt{constructor(e){const{event:t}=e,n=s(t.target);super(e,Ct,n)}}jt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!(!n.isPrimary||0!==n.button||(null==r||r({event:n}),0))}}];const Nt={move:{name:"mousemove"},end:{name:"mouseup"}};var Dt,Et;(Et=Dt||(Dt={}))[Et.RightClick=2]="RightClick",class extends kt{constructor(e){super(e,Nt,s(e.event.target))}}.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button!==Dt.RightClick&&(null==r||r({event:n}),!0)}}];const St={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var Rt,Mt,It,Ot;(class extends kt{constructor(e){super(e,St)}static setup(){function e(){}return window.addEventListener(St.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(St.move.name,e)}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:a}=n;return!(a.length>1||(null==r||r({event:n}),0))}}],(Mt=Rt||(Rt={}))[Mt.Pointer=0]="Pointer",Mt[Mt.DraggableRect=1]="DraggableRect",(Ot=It||(It={}))[Ot.TreeOrder=0]="TreeOrder",Ot[Ot.ReversedTreeOrder=1]="ReversedTreeOrder";const Tt={x:{[ct.Backward]:!1,[ct.Forward]:!1},y:{[ct.Backward]:!1,[ct.Forward]:!1}};var At,Lt,zt;(Lt=At||(At={}))[Lt.Always=0]="Always",Lt[Lt.BeforeDragging=1]="BeforeDragging",Lt[Lt.WhileDragging=2]="WhileDragging",(zt||(zt={})).Optimized="optimized";const Pt=new Map,Bt=[],Ft=[],Wt=[{sensor:jt,options:{}},{sensor:wt,options:{}}],Xt={current:{}},Yt={draggable:{measure:L},droppable:{measure:L,strategy:At.WhileDragging,frequency:zt.Optimized},dragOverlay:{measure:A}};class Ut extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return null!=(t=null==(n=this.get(e))?void 0:n.node.current)?t:void 0}}const Kt={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ut,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:w},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Yt,measureDroppableContainers:w,windowRect:null,measuringScheduled:!1},Vt={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:w,draggableNodes:new Map,over:null,measureDroppableContainers:w},Ht=Le.createContext(Vt),$t=Le.createContext(Kt),Jt=Le.createContext({...at,scaleX:1,scaleY:1});var qt,_t;(_t=qt||(qt={}))[_t.Uninitialized=0]="Uninitialized",_t[_t.Initializing=1]="Initializing",_t[_t.Initialized=2]="Initialized";const Gt=Le.memo(function(e){var t,n,a,o;let{id:s,accessibility:l,autoScroll:f=!0,children:p,sensors:m=Wt,collisionDetection:x=ot,measuring:b,modifiers:w,...k}=e;const C=Le.useReducer(se,void 0,oe),[j,N]=C,[D,E]=function(){const[e]=Le.useState(()=>new Set),t=Le.useCallback(t=>(e.add(t),()=>e.delete(t)),[e]);return[Le.useCallback(t=>{let{type:n,event:r}=t;e.forEach(e=>{var t;return null==(t=e[n])?void 0:t.call(e,r)})},[e]),t]}(),[R,M]=Le.useState(qt.Uninitialized),O=R===qt.Initialized,{draggable:{active:T,nodes:L,translate:F},droppable:{containers:W}}=j,U=null!=T?L.get(T):null,V=Le.useRef({initial:null,translated:null}),$=Le.useMemo(()=>{var e;return null!=T?{id:T,data:null!=(e=null==U?void 0:U.data)?e:Xt,rect:V}:null},[T,U]),J=Le.useRef(null),[q,_]=Le.useState(null),[G,Q]=Le.useState(null),te=c(k,Object.values(k)),de=h("DndDescribedBy",s),ue=Le.useMemo(()=>W.getEnabled(),[W]),ge=(he=b,Le.useMemo(()=>({draggable:{...Yt.draggable,...null==he?void 0:he.draggable},droppable:{...Yt.droppable,...null==he?void 0:he.droppable},dragOverlay:{...Yt.dragOverlay,...null==he?void 0:he.dragOverlay}}),[null==he?void 0:he.draggable,null==he?void 0:he.droppable,null==he?void 0:he.dragOverlay]));var he;const{droppableRects:fe,measureDroppableContainers:pe,measuringScheduled:ve}=function(e,t){let{dragging:n,dependencies:r,config:a}=t;const[i,o]=Le.useState(null),{frequency:s,measure:l,strategy:u}=a,g=Le.useRef(e),h=function(){switch(u){case At.Always:return!1;case At.BeforeDragging:return n;default:return!n}}(),f=c(h),p=Le.useCallback(function(e){void 0===e&&(e=[]),f.current||o(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[f]),v=Le.useRef(null),m=d(t=>{if(h&&!n)return Pt;if(!t||t===Pt||g.current!==e||null!=i){const t=new Map;for(let n of e){if(!n)continue;if(i&&i.length>0&&!i.includes(n.id)&&n.rect.current){t.set(n.id,n.rect.current);continue}const e=n.node.current,r=e?new ht(l(e),e):null;n.rect.current=r,r&&t.set(n.id,r)}return t}return t},[e,i,n,h,l]);return Le.useEffect(()=>{g.current=e},[e]),Le.useEffect(()=>{h||p()},[n,h]),Le.useEffect(()=>{i&&i.length>0&&o(null)},[JSON.stringify(i)]),Le.useEffect(()=>{h||"number"!=typeof s||null!==v.current||(v.current=setTimeout(()=>{p(),v.current=null},s))},[s,h,p,...r]),{droppableRects:m,measureDroppableContainers:p,measuringScheduled:null!=i}}(ue,{dragging:O,dependencies:[F.x,F.y],config:ge.droppable}),me=function(e,t){const n=null!=t?e.get(t):void 0,r=n?n.node.current:null;return d(e=>{var n;return null==t?null:null!=(n=null!=r?r:e)?n:null},[r,t])}(L,T),xe=Le.useMemo(()=>G?v(G):null,[G]),be=function(){const e=!1===(null==q?void 0:q.autoScrollEnabled),t="object"==typeof f?!1===f.enabled:!1===f,n=O&&!e&&!t;return"object"==typeof f?{...f,enabled:n}:{enabled:n}}(),ye=function(e,t){return Z(e,t)}(me,ge.draggable.measure);!function(e){let{activeNode:t,measure:n,initialRect:r,config:a=!0}=e;const i=Le.useRef(!1),{x:o,y:s}="boolean"==typeof a?{x:a,y:a}:a;He(()=>{if(!o&&!s||!t)return void(i.current=!1);if(i.current||!r)return;const e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;const a=I(n(e),r);if(o||(a.x=0),s||(a.y=0),i.current=!0,Math.abs(a.x)>0||Math.abs(a.y)>0){const t=P(e);t&&t.scrollBy({top:a.y,left:a.x})}},[t,o,s,r,n])}({activeNode:null!=T?L.get(T):null,config:be.layoutShiftCompensation,initialRect:ye,measure:ge.draggable.measure});const we=ne(me,ge.draggable.measure,ye),ke=ne(me?me.parentElement:null),Ce=Le.useRef({activatorEvent:null,active:null,activeNode:me,collisionRect:null,collisions:null,droppableRects:fe,draggableNodes:L,draggingNode:null,draggingNodeRect:null,droppableContainers:W,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),je=W.getNodeFor(null==(t=Ce.current.over)?void 0:t.id),Ne=function(e){let{measure:t}=e;const[n,r]=Le.useState(null),a=ee({callback:Le.useCallback(e=>{for(const{target:n}of e)if(i(n)){r(e=>{const r=t(n);return e?{...e,width:r.width,height:r.height}:r});break}},[t])}),o=Le.useCallback(e=>{const n=ie(e);null==a||a.disconnect(),n&&(null==a||a.observe(n)),r(n?t(n):null)},[t,a]),[s,l]=u(o);return Le.useMemo(()=>({nodeRef:s,rect:n,setRef:l}),[n,s,l])}({measure:ge.dragOverlay.measure}),De=null!=(n=Ne.nodeRef.current)?n:me,Ee=O?null!=(a=Ne.rect)?a:we:null,Se=Boolean(Ne.nodeRef.current&&Ne.rect),Re=I(Me=Se?null:we,Z(Me));var Me;const Ie=ae(De?r(De):null),Oe=function(e){const t=Le.useRef(e),n=d(n=>e?n&&n!==Bt&&e&&t.current&&e.parentNode===t.current.parentNode?n:z(e):Bt,[e]);return Le.useEffect(()=>{t.current=e},[e]),n}(O?null!=je?je:me:null),Te=function(e,t){function n(){s(()=>e.length?e.map(e=>Y(e)?i:new ht(t(e),e)):Ft)}void 0===t&&(t=A);const[a]=e,i=ae(a?r(a):null),[o,s]=Le.useState(Ft),l=ee({callback:n});return He(()=>{null==l||l.disconnect(),n(),e.forEach(e=>null==l?void 0:l.observe(e))},[e]),o}(Oe),Ae=ce(w,{transform:{x:F.x-Re.x,y:F.y-Re.y,scaleX:1,scaleY:1},activatorEvent:G,active:$,activeNodeRect:we,containerNodeRect:ke,draggingNodeRect:Ee,over:Ce.current.over,overlayNodeRect:Ne.rect,scrollableAncestors:Oe,scrollableAncestorRects:Te,windowRect:Ie}),Be=xe?Je(xe,F):null,Fe=function(e){const[t,n]=Le.useState(null),r=Le.useRef(e),a=Le.useCallback(e=>{const t=B(e.target);t&&n(e=>e?(e.set(t,X(t)),new Map(e)):null)},[]);return Le.useEffect(()=>{function t(e){e.forEach(e=>{const t=B(e);null==t||t.removeEventListener("scroll",a)})}const i=r.current;if(e!==i){t(i);const o=e.map(e=>{const t=B(e);return t?(t.addEventListener("scroll",a,{passive:!0}),[t,X(t)]):null}).filter(e=>null!=e);n(o.length?new Map(o):null),r.current=e}return()=>{t(e),t(i)}},[a,e]),Le.useMemo(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>Je(e,t),at):H(e):at,[e,t])}(Oe),We=re(Fe),Xe=re(Fe,[we]),Ye=Je(Ae,We),Ue=Ee?st(Ee,Ae):null,Ke=$&&Ue?x({active:$,collisionRect:Ue,droppableRects:fe,droppableContainers:ue,pointerCoordinates:Be}):null,$e=S(Ke,"id"),[qe,_e]=Le.useState(null),Ge=function(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}(Se?Ae:Je(Ae,Xe),null!=(o=null==qe?void 0:qe.rect)?o:null,we),Qe=Le.useRef(null),et=Le.useCallback((e,t)=>{function n(e){return async function(){const{active:t,collisions:n,over:r,scrollAdjustedTranslate:a}=Ce.current;let i=null;if(t&&a){const{cancelDrop:s}=te.current;i={activatorEvent:o,active:t,collisions:n,delta:a,over:r},e===nt.DragEnd&&"function"==typeof s&&await Promise.resolve(s(i))&&(e=nt.DragCancel)}J.current=null,Pe.unstable_batchedUpdates(()=>{N({type:e}),M(qt.Uninitialized),_e(null),_(null),Q(null),Qe.current=null;const t=e===nt.DragEnd?"onDragEnd":"onDragCancel";if(i){const e=te.current[t];null==e||e(i),D({type:t,event:i})}})}}let{sensor:r,options:a}=t;if(null==J.current)return;const i=L.get(J.current);if(!i)return;const o=e.nativeEvent,s=new r({active:J.current,activeNode:i,event:o,options:a,context:Ce,onAbort(e){if(!L.get(e))return;const{onDragAbort:t}=te.current,n={id:e};null==t||t(n),D({type:"onDragAbort",event:n})},onPending(e,t,n,r){if(!L.get(e))return;const{onDragPending:a}=te.current,i={id:e,constraint:t,initialCoordinates:n,offset:r};null==a||a(i),D({type:"onDragPending",event:i})},onStart(e){const t=J.current;if(null==t)return;const n=L.get(t);if(!n)return;const{onDragStart:r}=te.current,a={activatorEvent:o,active:{id:t,data:n.data,rect:V}};Pe.unstable_batchedUpdates(()=>{null==r||r(a),M(qt.Initializing),N({type:nt.DragStart,initialCoordinates:e,active:t}),D({type:"onDragStart",event:a}),_(Qe.current),Q(o)})},onMove(e){N({type:nt.DragMove,coordinates:e})},onEnd:n(nt.DragEnd),onCancel:n(nt.DragCancel)});Qe.current=s},[L]),tt=function(e,t){return Le.useMemo(()=>e.reduce((e,n)=>{const{sensor:r}=n;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:t(e.handler,n)}))]},[]),[e,t])}(m,Le.useCallback((e,t)=>(n,r)=>{const a=n.nativeEvent,i=L.get(r);if(null!==J.current||!i||a.dndKit||a.defaultPrevented)return;const o={active:i};!0===e(n,t.options,o)&&(a.dndKit={capturedBy:t.sensor},J.current=r,et(n,t))},[L,et]));!function(e){Le.useEffect(()=>{if(!Ve)return;const t=e.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const e of t)null==e||e()}},e.map(e=>{let{sensor:t}=e;return t}))}(m),He(()=>{we&&R===qt.Initializing&&M(qt.Initialized)},[we,R]),Le.useEffect(()=>{const{onDragMove:e}=te.current,{active:t,activatorEvent:n,collisions:r,over:a}=Ce.current;if(!t||!n)return;const i={active:t,activatorEvent:n,collisions:r,delta:{x:Ye.x,y:Ye.y},over:a};Pe.unstable_batchedUpdates(()=>{null==e||e(i),D({type:"onDragMove",event:i})})},[Ye.x,Ye.y]),Le.useEffect(()=>{const{active:e,activatorEvent:t,collisions:n,droppableContainers:r,scrollAdjustedTranslate:a}=Ce.current;if(!e||null==J.current||!t||!a)return;const{onDragOver:i}=te.current,o=r.get($e),s=o&&o.rect.current?{id:o.id,rect:o.rect.current,data:o.data,disabled:o.disabled}:null,l={active:e,activatorEvent:t,collisions:n,delta:{x:a.x,y:a.y},over:s};Pe.unstable_batchedUpdates(()=>{_e(s),null==i||i(l),D({type:"onDragOver",event:l})})},[$e]),He(()=>{Ce.current={activatorEvent:G,active:$,activeNode:me,collisionRect:Ue,collisions:Ke,droppableRects:fe,draggableNodes:L,draggingNode:De,draggingNodeRect:Ee,droppableContainers:W,over:qe,scrollableAncestors:Oe,scrollAdjustedTranslate:Ye},V.current={initial:Ee,translated:Ue}},[$,me,Ke,Ue,L,De,Ee,fe,W,qe,Oe,Ye]),function(e){let{acceleration:t,activator:n=Rt.Pointer,canScroll:r,draggingRect:a,enabled:i,interval:o=5,order:s=It.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:h,threshold:f}=e;const p=function(e){let{delta:t,disabled:n}=e;const r=g(t);return d(e=>{if(n||!r||!e)return Tt;const a=Math.sign(t.x-r.x),i=Math.sign(t.y-r.y);return{x:{[ct.Backward]:e.x[ct.Backward]||-1===a,[ct.Forward]:e.x[ct.Forward]||1===a},y:{[ct.Backward]:e.y[ct.Backward]||-1===i,[ct.Forward]:e.y[ct.Forward]||1===i}}},[n,t,r])}({delta:h,disabled:!i}),[v,m]=function(){const e=Le.useRef(null);return[Le.useCallback((t,n)=>{e.current=setInterval(t,n)},[]),Le.useCallback(()=>{null!==e.current&&(clearInterval(e.current),e.current=null)},[])]}(),x=Le.useRef({x:0,y:0}),b=Le.useRef({x:0,y:0}),y=Le.useMemo(()=>{switch(n){case Rt.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Rt.DraggableRect:return a}},[n,a,l]),w=Le.useRef(null),k=Le.useCallback(()=>{const e=w.current;if(!e)return;const t=x.current.x*b.current.x,n=x.current.y*b.current.y;e.scrollBy(t,n)},[]),C=Le.useMemo(()=>s===It.TreeOrder?[...c].reverse():c,[s,c]);Le.useEffect(()=>{if(i&&c.length&&y){for(const e of C){if(!1===(null==r?void 0:r(e)))continue;const n=c.indexOf(e),a=u[n];if(!a)continue;const{direction:i,speed:s}=K(e,a,y,t,f);for(const e of["x","y"])p[e][i[e]]||(s[e]=0,i[e]=0);if(s.x>0||s.y>0)return m(),w.current=e,v(k,o),x.current=s,void(b.current=i)}x.current={x:0,y:0},b.current={x:0,y:0},m()}else m()},[t,k,r,m,i,o,JSON.stringify(y),JSON.stringify(p),v,c,C,u,JSON.stringify(f)])}({...be,delta:F,draggingRect:Ue,pointerCoordinates:Be,scrollableAncestors:Oe,scrollableAncestorRects:Te});const rt=Le.useMemo(()=>({active:$,activeNode:me,activeNodeRect:we,activatorEvent:G,collisions:Ke,containerNodeRect:ke,dragOverlay:Ne,draggableNodes:L,droppableContainers:W,droppableRects:fe,over:qe,measureDroppableContainers:pe,scrollableAncestors:Oe,scrollableAncestorRects:Te,measuringConfiguration:ge,measuringScheduled:ve,windowRect:Ie}),[$,me,we,G,Ke,ke,Ne,L,W,fe,qe,pe,Oe,Te,ge,ve,Ie]),it=Le.useMemo(()=>({activatorEvent:G,activators:tt,active:$,activeNodeRect:we,ariaDescribedById:{draggable:de},dispatch:N,draggableNodes:L,over:qe,measureDroppableContainers:pe}),[G,tt,$,we,N,de,L,qe,pe]);return ze.createElement(Ze.Provider,{value:E},ze.createElement(Ht.Provider,{value:it},ze.createElement($t.Provider,{value:rt},ze.createElement(Jt.Provider,{value:Ge},p)),ze.createElement(le,{disabled:!1===(null==l?void 0:l.restoreFocus)})),ze.createElement(y,{...l,hiddenTextDescribedById:de}))}),Qt=Le.createContext(null),Zt="button",en={timeout:25},tn={x:0,y:0,scaleX:1,scaleY:1},nn={position:"fixed",touchAction:"none"},rn=e=>p(e)?"transform 250ms ease":void 0,an=Le.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:a,children:i,className:o,rect:s,style:l,transform:c,transition:d=rn}=e;if(!s)return null;const u=a?c:{...c,scaleX:1,scaleY:1},g={...nn,width:s.width,height:s.height,top:s.top,left:s.left,transform:_e.Transform.toString(u),transformOrigin:a&&r?j(r,s):void 0,transition:"function"==typeof d?d(r):d,...l};return ze.createElement(n,{className:o,style:g,ref:t},i)}),on={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:n}}=e;return[{transform:_e.Transform.toString(t)},{transform:_e.Transform.toString(n)}]},sideEffects:(e=>t=>{let{active:n,dragOverlay:r}=t;const a={},{styles:i,className:o}=e;if(null!=i&&i.active)for(const[e,s]of Object.entries(i.active))void 0!==s&&(a[e]=n.node.style.getPropertyValue(e),n.node.style.setProperty(e,s));if(null!=i&&i.dragOverlay)for(const[e,s]of Object.entries(i.dragOverlay))void 0!==s&&r.node.style.setProperty(e,s);return null!=o&&o.active&&n.node.classList.add(o.active),null!=o&&o.dragOverlay&&r.node.classList.add(o.dragOverlay),function(){for(const[e,t]of Object.entries(a))n.node.style.setProperty(e,t);null!=o&&o.active&&n.node.classList.remove(o.active)}})({styles:{active:{opacity:"0"}}})};let sn=0;const ln=ze.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:a,style:i,transition:o,modifiers:s,wrapperElement:c="div",className:d,zIndex:u=999}=e;const{activatorEvent:g,active:h,activeNodeRect:f,containerNodeRect:p,draggableNodes:v,droppableContainers:m,dragOverlay:x,over:b,measuringConfiguration:y,scrollableAncestors:w,scrollableAncestorRects:k,windowRect:C}=de(),j=Le.useContext(Jt),N=(D=null==h?void 0:h.id,Le.useMemo(()=>{if(null!=D)return sn++,sn},[D]));var D;const E=ce(s,{activatorEvent:g,active:h,activeNodeRect:f,containerNodeRect:p,draggingNodeRect:x.rect,over:b,overlayNodeRect:x.rect,scrollableAncestors:w,scrollableAncestorRects:k,transform:j,windowRect:C}),S=Z(f),R=function(e){let{config:t,draggableNodes:n,droppableContainers:a,measuringConfiguration:i}=e;return l((e,o)=>{if(null===t)return;const s=n.get(e);if(!s)return;const l=s.node.current;if(!l)return;const c=ie(o);if(!c)return;const{transform:d}=r(o).getComputedStyle(o),u=T(d);if(!u)return;const g="function"==typeof t?t:function(e){const{duration:t,easing:n,sideEffects:r,keyframes:a}={...on,...e};return e=>{let{active:i,dragOverlay:o,transform:s,...l}=e;if(!t)return;const c=o.rect.left-i.rect.left,d=o.rect.top-i.rect.top,u={scaleX:1!==s.scaleX?i.rect.width*s.scaleX/o.rect.width:1,scaleY:1!==s.scaleY?i.rect.height*s.scaleY/o.rect.height:1},g={x:s.x-c,y:s.y-d,...u},h=a({...l,active:i,dragOverlay:o,transform:{initial:s,final:g}}),[f]=h,p=h[h.length-1];if(JSON.stringify(f)===JSON.stringify(p))return;const v=null==r?void 0:r({active:i,dragOverlay:o,...l}),m=o.node.animate(h,{duration:t,easing:n,fill:"forwards"});return new Promise(e=>{m.onfinish=()=>{null==v||v(),e()}})}}(t);return $(l,i.draggable.measure),g({active:{id:e,data:s.data,node:l,rect:i.draggable.measure(l)},draggableNodes:n,dragOverlay:{node:o,rect:i.dragOverlay.measure(c)},droppableContainers:a,measuringConfiguration:i,transform:u})})}({config:a,draggableNodes:v,droppableContainers:m,measuringConfiguration:y}),M=S?x.setRef:void 0;return ze.createElement(ge,null,ze.createElement(ue,{animation:R},h&&N?ze.createElement(an,{key:N,id:h.id,ref:M,as:c,activatorEvent:g,adjustScale:t,className:d,transition:o,rect:S,style:{zIndex:u,...i},transform:E},n):null))}),cn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:a}=e;const i=he(t,r,n),o=t[a],s=i[a];return s&&o?{x:s.left-o.left,y:s.top-o.top,scaleX:s.width/o.width,scaleY:s.height/o.height}:null},dn={scaleX:1,scaleY:1},un=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:a,rects:i,overIndex:o}=e;const s=null!=(t=i[n])?t:r;if(!s)return null;if(a===n){const e=i[o];return e?{x:0,y:n<o?e.top+e.height-(s.top+s.height):e.top-s.top,...dn}:null}const l=function(e,t,n){const r=e[t],a=e[t-1],i=e[t+1];return r?n<t?a?r.top-(a.top+a.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):a?r.top-(a.top+a.height):0:0}(i,a,n);return a>n&&a<=o?{x:0,y:-s.height-l,...dn}:a<n&&a>=o?{x:0,y:s.height+l,...dn}:{x:0,y:0,...dn}},gn="Sortable",hn=ze.createContext({activeIndex:-1,containerId:gn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:cn,disabled:{draggable:!1,droppable:!1}}),fn=e=>{let{id:t,items:n,activeIndex:r,overIndex:a}=e;return he(n,r,a).indexOf(t)},pn=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:a,items:i,newIndex:o,previousItems:s,previousContainerId:l,transition:c}=e;return!(!c||!r||s!==i&&a===o||!n&&(o===a||t!==l))},vn={duration:200,easing:"ease"},mn="transform",xn=_e.Transition.toString({property:mn,duration:0,easing:"linear"}),bn={roleDescription:"sortable"},yn=[mt.Down,mt.Right,mt.Up,mt.Left],wn=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:a,droppableContainers:i,over:o,scrollableAncestors:s}}=t;if(yn.includes(e.code)){if(e.preventDefault(),!n||!r)return;const t=[];i.getEnabled().forEach(n=>{if(!n||null!=n&&n.disabled)return;const i=a.get(n.id);if(i)switch(e.code){case mt.Down:r.top<i.top&&t.push(n);break;case mt.Up:r.top>i.top&&t.push(n);break;case mt.Left:r.left>i.left&&t.push(n);break;case mt.Right:r.left<i.left&&t.push(n)}});const d=(e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const a=E(t),i=[];for(const o of r){const{id:e}=o,t=n.get(e);if(t){const n=E(t),r=a.reduce((e,t,r)=>e+C(n[r],t),0),s=Number((r/4).toFixed(4));i.push({id:e,data:{droppableContainer:o,value:s}})}}return i.sort(N)})({collisionRect:r,droppableRects:a,droppableContainers:t});let u=S(d,"id");if(u===(null==o?void 0:o.id)&&d.length>1&&(u=d[1].id),null!=u){const e=i.get(n.id),t=i.get(u),o=t?a.get(t.id):null,d=null==t?void 0:t.node.current;if(d&&o&&e&&t){const n=z(d).some((e,t)=>s[t]!==e),a=be(e,t),i=(c=t,!(!xe(l=e)||!xe(c))&&!!be(l,c)&&l.data.current.sortable.index<c.data.current.sortable.index),u=n||!a?{x:0,y:0}:{x:i?r.width-o.width:0,y:i?r.height-o.height:0},g={x:o.left,y:o.top};return u.x&&u.y?g:qe(g,u)}}}var l,c};export{we as default};
