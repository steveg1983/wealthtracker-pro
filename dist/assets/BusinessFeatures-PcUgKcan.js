function e({onDataChange:e}){const[s,r]=c.useState([]),[i,n]=c.useState(!1),[d,l]=c.useState(!1),[v,N]=c.useState(null),[k,f]=c.useState(null);c.useEffect(()=>{w()},[]);const w=()=>{r(R.getInvoices())},D=()=>{f(null),n(!0)},C=e=>{f(e),n(!0)},S=e=>{N(e),l(!0)},A=t=>{window.confirm("Are you sure you want to delete this invoice?")&&(R.deleteInvoice(t.id),w(),e())},E=t=>{R.markInvoiceAsPaid(t.id),w(),e()},I=e=>{switch(e){case"draft":return x.jsx(h,{size:16,className:"text-gray-500"});case"sent":return x.jsx(j,{size:16,className:"text-blue-500"});case"paid":return x.jsx(u,{size:16,className:"text-green-500"});case"overdue":return x.jsx(b,{size:16,className:"text-red-500"});default:return x.jsx(y,{size:16,className:"text-gray-500"})}},T=e=>{switch(e){case"draft":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200";case"sent":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-200";case"paid":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-200";case"overdue":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-200"}},z=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),M=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Invoice Management"}),x.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Create, send, and track your invoices"})]}),x.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[x.jsx(o,{size:16}),"Create Invoice"]})]}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden",children:0===s.length?x.jsxs("div",{className:"text-center py-12",children:[x.jsx(m,{size:48,className:"mx-auto mb-4 text-gray-400"}),x.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No invoices yet"}),x.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Create your first invoice to get started"}),x.jsxs("button",{onClick:D,className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[x.jsx(o,{size:16}),"Create Invoice"]})]}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"sm:hidden space-y-3",children:s.map(e=>x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700",children:[x.jsxs("div",{className:"flex justify-between items-start mb-3",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(m,{size:20,className:"text-gray-400"}),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.invoiceNumber}),x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.clientName})]})]}),x.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${T(e.status)}`,children:[I(e.status),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3 text-sm",children:[x.jsxs("div",{children:[x.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Amount"}),x.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:z(e.total)})]}),x.jsxs("div",{children:[x.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Due Date"}),x.jsx("span",{className:"text-gray-900 dark:text-white",children:M(e.dueDate)})]}),x.jsxs("div",{children:[x.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Issue Date"}),x.jsx("span",{className:"text-gray-900 dark:text-white",children:M(e.issueDate)})]}),x.jsxs("div",{children:[x.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Email"}),x.jsx("span",{className:"text-gray-900 dark:text-white text-xs",children:e.clientEmail})]})]}),x.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t border-gray-200 dark:border-gray-700",children:[x.jsx("button",{onClick:()=>S(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-blue-600 hover:text-blue-900 dark:text-blue-400",title:"View",children:x.jsx(g,{size:20})}),x.jsx("button",{onClick:()=>C(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-gray-600 hover:text-gray-900 dark:text-gray-400",title:"Edit",children:x.jsx(h,{size:20})}),"paid"!==e.status&&x.jsx("button",{onClick:()=>E(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-green-600 hover:text-green-900 dark:text-green-400",title:"Mark as Paid",children:x.jsx(u,{size:20})}),x.jsx("button",{onClick:()=>A(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-red-600 hover:text-red-900 dark:text-red-400",title:"Delete",children:x.jsx(p,{size:20})})]})]},e.id))}),x.jsx("div",{className:"hidden sm:block overflow-x-auto",children:x.jsxs("table",{className:"w-full",children:[x.jsx("thead",{className:"bg-secondary dark:bg-gray-700",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Invoice"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Client"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Amount"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Status"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Due Date"}),x.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),x.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map(e=>x.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsxs("div",{className:"flex items-center",children:[x.jsx(m,{size:16,className:"text-gray-400 mr-2"}),x.jsxs("div",{children:[x.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.invoiceNumber}),x.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:M(e.issueDate)})]})]})}),x.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[x.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:e.clientName}),x.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.clientEmail})]}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:z(e.total)}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${T(e.status)}`,children:[I(e.status),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:M(e.dueDate)}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:x.jsxs("div",{className:"flex items-center justify-end gap-2",children:[x.jsx("button",{onClick:()=>S(e),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:x.jsx(g,{size:16})}),x.jsx("button",{onClick:()=>C(e),className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300",children:x.jsx(h,{size:16})}),"paid"!==e.status&&x.jsx("button",{onClick:()=>E(e),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",title:"Mark as Paid",children:x.jsx(u,{size:16})}),x.jsx("button",{onClick:()=>A(e),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:x.jsx(p,{size:16})})]})})]},e.id))})]})})]})}),i&&x.jsx(t,{invoice:k,onClose:()=>n(!1),onSave:t=>{k?R.updateInvoice(k.id,t):R.createInvoice(t),n(!1),w(),e()}}),d&&v&&x.jsx(a,{invoice:v,onClose:()=>l(!1)})]})}function t({invoice:e,onClose:t,onSave:a}){const[s,r]=c.useState({invoiceNumber:e?.invoiceNumber||R.generateInvoiceNumber(),clientName:e?.clientName||"",clientEmail:e?.clientEmail||"",issueDate:e?.issueDate.toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],dueDate:e?.dueDate.toISOString().split("T")[0]||new Date(Date.now()+2592e6).toISOString().split("T")[0],paymentTerms:e?.paymentTerms||"Net 30",notes:e?.notes||"",status:e?.status||"draft"}),[i,n]=c.useState(e?.items||[{id:"1",description:"",quantity:1,unitPrice:0,vatRate:.2,total:0}]),d=(e,t)=>{const a=[...i];a[e]={...a[e],...t};const s=a[e].quantity,r=a[e].unitPrice,d=a[e].vatRate;a[e].total=s*r*(1+d),n(a)},l=()=>R.calculateInvoiceTotals(i),m=l();return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:x.jsxs("form",{onSubmit:e=>{e.preventDefault();const t=l();a({...s,issueDate:new Date(s.issueDate),dueDate:new Date(s.dueDate),items:i,subtotal:t.subtotal,vatAmount:t.vatAmount,total:t.total})},className:"p-6",children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e?"Edit Invoice":"Create Invoice"}),x.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:x.jsx(o,{size:20,className:"rotate-45"})})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Invoice Number"}),x.jsx("input",{type:"text",value:s.invoiceNumber,onChange:e=>r({...s,invoiceNumber:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),x.jsxs("select",{value:s.status,onChange:e=>r({...s,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:"draft",children:"Draft"}),x.jsx("option",{value:"sent",children:"Sent"}),x.jsx("option",{value:"paid",children:"Paid"}),x.jsx("option",{value:"overdue",children:"Overdue"})]})]})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Client Name"}),x.jsx("input",{type:"text",value:s.clientName,onChange:e=>r({...s,clientName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Client Email"}),x.jsx("input",{type:"email",value:s.clientEmail,onChange:e=>r({...s,clientEmail:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Issue Date"}),x.jsx("input",{type:"date",value:s.issueDate,onChange:e=>r({...s,issueDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Due Date"}),x.jsx("input",{type:"date",value:s.dueDate,onChange:e=>r({...s,dueDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Payment Terms"}),x.jsxs("select",{value:s.paymentTerms,onChange:e=>r({...s,paymentTerms:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:"Net 15",children:"Net 15"}),x.jsx("option",{value:"Net 30",children:"Net 30"}),x.jsx("option",{value:"Net 60",children:"Net 60"}),x.jsx("option",{value:"Due on Receipt",children:"Due on Receipt"})]})]})]}),x.jsxs("div",{className:"mb-6",children:[x.jsxs("div",{className:"flex items-center justify-between mb-4",children:[x.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Items"}),x.jsxs("button",{type:"button",onClick:()=>{const e={id:Date.now().toString(),description:"",quantity:1,unitPrice:0,vatRate:.2,total:0};n([...i,e])},className:"flex items-center gap-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[x.jsx(o,{size:14}),"Add Item"]})]}),x.jsx("div",{className:"space-y-4",children:i.map((e,t)=>x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[x.jsx("div",{className:"md:col-span-2",children:x.jsx("input",{type:"text",placeholder:"Description",value:e.description,onChange:e=>d(t,{description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})}),x.jsx("div",{children:x.jsx("input",{type:"number",placeholder:"Qty",value:e.quantity,onChange:e=>d(t,{quantity:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"1",required:!0})}),x.jsx("div",{children:x.jsx("input",{type:"number",placeholder:"Unit Price",value:e.unitPrice,onChange:e=>d(t,{unitPrice:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"0",step:"0.01",required:!0})}),x.jsx("div",{children:x.jsxs("select",{value:e.vatRate,onChange:e=>d(t,{vatRate:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:0,children:"0%"}),x.jsx("option",{value:.05,children:"5%"}),x.jsx("option",{value:.2,children:"20%"})]})}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("span",{className:"text-sm text-gray-900 dark:text-white",children:["$",e.total.toFixed(2)]}),i.length>1&&x.jsx("button",{type:"button",onClick:()=>(e=>{i.length>1&&n(i.filter((t,a)=>a!==e))})(t),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:x.jsx(p,{size:16})})]})]},e.id))})]}),x.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6",children:[x.jsxs("div",{className:"flex justify-between items-center mb-2",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Subtotal:"}),x.jsxs("span",{className:"text-sm text-gray-900 dark:text-white",children:["$",m.subtotal.toFixed(2)]})]}),x.jsxs("div",{className:"flex justify-between items-center mb-2",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"VAT:"}),x.jsxs("span",{className:"text-sm text-gray-900 dark:text-white",children:["$",m.vatAmount.toFixed(2)]})]}),x.jsxs("div",{className:"flex justify-between items-center font-semibold text-lg",children:[x.jsx("span",{className:"text-gray-900 dark:text-white",children:"Total:"}),x.jsxs("span",{className:"text-gray-900 dark:text-white",children:["$",m.total.toFixed(2)]})]})]}),x.jsxs("div",{className:"mb-6",children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes"}),x.jsx("textarea",{value:s.notes,onChange:e=>r({...s,notes:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"Additional notes or payment instructions..."})]}),x.jsxs("div",{className:"flex justify-end gap-3",children:[x.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"Cancel"}),x.jsxs("button",{type:"submit",className:"px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[e?"Update":"Create"," Invoice"]})]})]})})})}function a({invoice:e,onClose:t}){const a=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),s=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:x.jsxs("div",{className:"p-6",children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Invoice Preview"}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsxs("button",{onClick:()=>window.print(),className:"flex items-center gap-2 px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:[x.jsx(v,{size:16}),"Print"]}),x.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:x.jsx(o,{size:20,className:"rotate-45"})})]})]}),x.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-8 border border-gray-200 dark:border-gray-700",children:[x.jsxs("div",{className:"flex justify-between items-start mb-8",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"INVOICE"}),x.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.invoiceNumber})]}),x.jsxs("div",{className:"text-right",children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Issue Date:"}),x.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:s(e.issueDate)}),x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Due Date:"}),x.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:s(e.dueDate)})]})]}),x.jsxs("div",{className:"mb-8",children:[x.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Bill To:"}),x.jsx("p",{className:"text-gray-900 dark:text-white",children:e.clientName}),x.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.clientEmail})]}),x.jsx("div",{className:"mb-8",children:x.jsxs("table",{className:"w-full border-collapse border border-gray-200 dark:border-gray-700",children:[x.jsx("thead",{children:x.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[x.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-left text-sm font-medium text-gray-900 dark:text-white",children:"Description"}),x.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:"Qty"}),x.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:"Unit Price"}),x.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:"VAT"}),x.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-right text-sm font-medium text-gray-900 dark:text-white",children:"Total"})]})}),x.jsx("tbody",{children:e.items.map(e=>x.jsxs("tr",{children:[x.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-gray-900 dark:text-white",children:e.description}),x.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-center text-gray-900 dark:text-white",children:e.quantity}),x.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-center text-gray-900 dark:text-white",children:a(e.unitPrice)}),x.jsxs("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-center text-gray-900 dark:text-white",children:[(100*e.vatRate).toFixed(0),"%"]}),x.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-right text-gray-900 dark:text-white",children:a(e.total)})]},e.id))})]})}),x.jsx("div",{className:"flex justify-end mb-8",children:x.jsxs("div",{className:"w-64",children:[x.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-700",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Subtotal:"}),x.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:a(e.subtotal)})]}),x.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-700",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"VAT:"}),x.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:a(e.vatAmount)})]}),x.jsxs("div",{className:"flex justify-between items-center py-2 font-semibold text-lg",children:[x.jsx("span",{className:"text-gray-900 dark:text-white",children:"Total:"}),x.jsx("span",{className:"text-gray-900 dark:text-white",children:a(e.total)})]})]})}),x.jsxs("div",{className:"mb-8",children:[x.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Payment Terms:"}),x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.paymentTerms})]}),e.notes&&x.jsxs("div",{children:[x.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Notes:"}),x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.notes})]})]})]})})})}function s({onDataChange:e}){const[t,a]=c.useState([]),[s,i]=c.useState([]),[n,d]=c.useState(!1),[l,m]=c.useState(null),[g,u]=c.useState({category:"",dateRange:""});c.useEffect(()=>{y()},[]),c.useEffect(()=>{b()},[t,g]);const y=()=>{const e=R.getMileageEntries();a(e)},b=()=>{let e=[...t];if(g.category&&(e=e.filter(e=>e.category===g.category)),g.dateRange){const t=new Date;let a=new Date;switch(g.dateRange){case"this-month":a=new Date(t.getFullYear(),t.getMonth(),1);break;case"last-month":a=new Date(t.getFullYear(),t.getMonth()-1,1);break;case"this-quarter":{const e=Math.floor(t.getMonth()/3);a=new Date(t.getFullYear(),3*e,1);break}case"this-year":a=new Date(t.getFullYear(),0,1);break;default:a=new Date(0)}e=e.filter(e=>e.date>=a)}i(e)},j=()=>{m(null),d(!0)},v=e=>{m(e),d(!0)},C=t=>{window.confirm("Are you sure you want to delete this mileage entry?")&&(R.deleteMileageEntry(t.id),y(),e())},S=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),A=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),E=e=>{switch(e){case"business":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-200";case"medical":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-200";case"charitable":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-200";case"moving":return"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}},I=s.reduce((e,t)=>e+t.distance,0),T=s.reduce((e,t)=>e+t.amount,0),z=s.length>0?s.reduce((e,t)=>e+t.rate,0)/s.length:0;return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Mileage Tracker"}),x.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Track business mileage for tax deductions"})]}),x.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[x.jsx(o,{size:16}),x.jsx("span",{className:"hidden sm:inline",children:"Add Mileage"}),x.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Miles"}),x.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:I.toFixed(1)})]}),x.jsx(N,{size:24,className:"text-blue-500"})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Amount"}),x.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:S(T)})]}),x.jsx(k,{size:24,className:"text-green-500"})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Average Rate"}),x.jsxs("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:["$",z.toFixed(2),"/mi"]})]}),x.jsx(f,{size:24,className:"text-purple-500"})]})})]}),x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[x.jsx(w,{size:20,className:"text-gray-500"}),x.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Filters"})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),x.jsxs("select",{value:g.category,onChange:e=>u({...g,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:"",children:"All Categories"}),x.jsx("option",{value:"business",children:"Business"}),x.jsx("option",{value:"medical",children:"Medical"}),x.jsx("option",{value:"charitable",children:"Charitable"}),x.jsx("option",{value:"moving",children:"Moving"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),x.jsxs("select",{value:g.dateRange,onChange:e=>u({...g,dateRange:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:"",children:"All Time"}),x.jsx("option",{value:"this-month",children:"This Month"}),x.jsx("option",{value:"last-month",children:"Last Month"}),x.jsx("option",{value:"this-quarter",children:"This Quarter"}),x.jsx("option",{value:"this-year",children:"This Year"})]})]})]})]}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden",children:0===s.length?x.jsxs("div",{className:"text-center py-12",children:[x.jsx(D,{size:48,className:"mx-auto mb-4 text-gray-400"}),x.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No mileage entries found"}),x.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:0===t.length?"Add your first mileage entry to get started":"Try adjusting your filters"}),0===t.length&&x.jsxs("button",{onClick:j,className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[x.jsx(o,{size:16}),x.jsx("span",{children:"Add Mileage"})]})]}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"sm:hidden",children:s.map(e=>x.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[x.jsxs("div",{className:"flex justify-between items-start mb-3",children:[x.jsxs("div",{className:"flex-1",children:[x.jsxs("div",{className:"font-medium text-gray-900 dark:text-white",children:[e.startLocation," \u2192 ",e.endLocation]}),x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.purpose}),e.notes&&x.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e.notes})]}),x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>v(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:x.jsx(h,{size:20})}),x.jsx("button",{onClick:()=>C(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:x.jsx(p,{size:20})})]})]}),x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ${E(e.category)}`,children:e.category}),x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:A(e.date)})]}),x.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[x.jsxs("div",{children:[x.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Distance"}),x.jsxs("span",{className:"text-gray-900 dark:text-white font-medium",children:[e.distance.toFixed(1)," mi"]})]}),x.jsxs("div",{children:[x.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Rate"}),x.jsxs("span",{className:"text-gray-900 dark:text-white",children:["$",e.rate.toFixed(2),"/mi"]})]}),x.jsxs("div",{children:[x.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Amount"}),x.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:S(e.amount)})]})]})]},e.id))}),x.jsx("div",{className:"hidden sm:block overflow-x-auto",children:x.jsxs("table",{className:"w-full",children:[x.jsx("thead",{className:"bg-secondary dark:bg-gray-700",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Trip"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Category"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Distance"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Rate"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Amount"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Date"}),x.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),x.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map(e=>x.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsxs("div",{className:"flex items-center",children:[x.jsx(N,{size:16,className:"text-gray-400 mr-2"}),x.jsxs("div",{children:[x.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.startLocation," \u2192 ",e.endLocation]}),x.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.purpose}),e.notes&&x.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e.notes})]})]})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ${E(e.category)}`,children:e.category})}),x.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:[e.distance.toFixed(1)," mi"]}),x.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:["$",e.rate.toFixed(2),"/mi"]}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:S(e.amount)}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:A(e.date)}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:x.jsxs("div",{className:"flex items-center justify-end gap-2",children:[x.jsx("button",{onClick:()=>v(e),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:x.jsx(h,{size:16})}),x.jsx("button",{onClick:()=>C(e),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:x.jsx(p,{size:16})})]})})]},e.id))})]})})]})}),n&&x.jsx(r,{entry:l,onClose:()=>d(!1),onSave:t=>{l?R.updateMileageEntry(l.id,t):R.addMileageEntry(t),d(!1),y(),e()}})]})}function r({entry:e,onClose:t,onSave:a}){const[s,r]=c.useState({date:e?.date.toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],startLocation:e?.startLocation||"",endLocation:e?.endLocation||"",distance:e?.distance||0,purpose:e?.purpose||"",rate:e?.rate||.67,category:e?.category||"business",notes:e?.notes||""}),i=s.distance*s.rate;return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-lg",children:x.jsxs("form",{onSubmit:e=>{e.preventDefault(),a({...s,date:new Date(s.date)})},className:"p-6",children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e?"Edit Mileage Entry":"Add Mileage Entry"}),x.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:x.jsx(o,{size:20,className:"rotate-45"})})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date"}),x.jsx("input",{type:"date",value:s.date,onChange:e=>r({...s,date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Location"}),x.jsx("input",{type:"text",value:s.startLocation,onChange:e=>r({...s,startLocation:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter starting location",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"End Location"}),x.jsx("input",{type:"text",value:s.endLocation,onChange:e=>r({...s,endLocation:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter destination",required:!0})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Distance (miles)"}),x.jsx("input",{type:"number",value:s.distance,onChange:e=>r({...s,distance:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"0.0",step:"0.1",min:"0",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rate (per mile)"}),x.jsx("input",{type:"number",value:s.rate,onChange:e=>r({...s,rate:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"0.67",step:"0.01",min:"0",required:!0})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Purpose"}),x.jsx("input",{type:"text",value:s.purpose,onChange:e=>r({...s,purpose:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter purpose of trip",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),x.jsxs("select",{value:s.category,onChange:e=>r({...s,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,children:[x.jsx("option",{value:"business",children:"Business"}),x.jsx("option",{value:"medical",children:"Medical"}),x.jsx("option",{value:"charitable",children:"Charitable"}),x.jsx("option",{value:"moving",children:"Moving"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes (Optional)"}),x.jsx("textarea",{value:s.notes,onChange:e=>r({...s,notes:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"Additional details..."})]}),x.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Calculated Amount:"}),x.jsxs("span",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:["$",i.toFixed(2)]})]}),x.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[s.distance.toFixed(1)," miles \xd7 $",s.rate.toFixed(2),"/mile"]})]})]}),x.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[x.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"Cancel"}),x.jsxs("button",{type:"submit",className:"px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[e?"Update":"Add"," Entry"]})]})]})})})}function i({onDataChange:e}){const[t,a]=c.useState([]),[s,r]=c.useState([]),[i,d]=c.useState(!1),[l,g]=c.useState(null),[y,b]=c.useState({category:"",isDeductible:"",dateRange:""});c.useEffect(()=>{j()},[]),c.useEffect(()=>{v()},[t,y]);const j=()=>{const e=R.getBusinessExpenses();a(e)},v=()=>{let e=[...t];if(y.category&&(e=e.filter(e=>e.category===y.category)),y.isDeductible){const t="true"===y.isDeductible;e=e.filter(e=>e.isDeductible===t)}if(y.dateRange){const t=new Date;let a=new Date;switch(y.dateRange){case"this-month":a=new Date(t.getFullYear(),t.getMonth(),1);break;case"last-month":a=new Date(t.getFullYear(),t.getMonth()-1,1);break;case"this-quarter":{const e=Math.floor(t.getMonth()/3);a=new Date(t.getFullYear(),3*e,1);break}case"this-year":a=new Date(t.getFullYear(),0,1);break;default:a=new Date(0)}e=e.filter(e=>e.date>=a)}r(e)},N=()=>{g(null),d(!0)},f=e=>{g(e),d(!0)},D=t=>{window.confirm("Are you sure you want to delete this expense?")&&(R.deleteBusinessExpense(t.id),j(),e())},E=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),I=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=e=>e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()),z=e=>{switch(e){case"office_supplies":return x.jsx(m,{size:16,className:"text-blue-500"});case"travel":return x.jsx(A,{size:16,className:"text-green-500"});case"meals":return x.jsx(k,{size:16,className:"text-orange-500"});case"software":return x.jsx(S,{size:16,className:"text-purple-500"});default:return x.jsx(k,{size:16,className:"text-gray-500"})}},M=s.reduce((e,t)=>e+t.amount,0),F=s.filter(e=>e.isDeductible).reduce((e,t)=>e+t.amount,0),P=s.reduce((e,t)=>e+(t.vatAmount||0),0);return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Business Expenses"}),x.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Track and categorize your business expenses"})]}),x.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[x.jsx(o,{size:16}),"Add Expense"]})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Expenses"}),x.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:E(M)})]}),x.jsx(k,{size:24,className:"text-red-500"})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Deductible Expenses"}),x.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:E(F)})]}),x.jsx(u,{size:24,className:"text-green-500"})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total VAT"}),x.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:E(P)})]}),x.jsx(m,{size:24,className:"text-blue-500"})]})})]}),x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[x.jsx(w,{size:20,className:"text-gray-500"}),x.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Filters"})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),x.jsxs("select",{value:y.category,onChange:e=>b({...y,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:"",children:"All Categories"}),x.jsx("option",{value:"office_supplies",children:"Office Supplies"}),x.jsx("option",{value:"travel",children:"Travel"}),x.jsx("option",{value:"meals",children:"Meals"}),x.jsx("option",{value:"utilities",children:"Utilities"}),x.jsx("option",{value:"rent",children:"Rent"}),x.jsx("option",{value:"marketing",children:"Marketing"}),x.jsx("option",{value:"professional_services",children:"Professional Services"}),x.jsx("option",{value:"equipment",children:"Equipment"}),x.jsx("option",{value:"software",children:"Software"}),x.jsx("option",{value:"insurance",children:"Insurance"}),x.jsx("option",{value:"other",children:"Other"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Deductible"}),x.jsxs("select",{value:y.isDeductible,onChange:e=>b({...y,isDeductible:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:"",children:"All Expenses"}),x.jsx("option",{value:"true",children:"Deductible Only"}),x.jsx("option",{value:"false",children:"Non-Deductible Only"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),x.jsxs("select",{value:y.dateRange,onChange:e=>b({...y,dateRange:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:"",children:"All Time"}),x.jsx("option",{value:"this-month",children:"This Month"}),x.jsx("option",{value:"last-month",children:"Last Month"}),x.jsx("option",{value:"this-quarter",children:"This Quarter"}),x.jsx("option",{value:"this-year",children:"This Year"})]})]})]})]}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden",children:0===s.length?x.jsxs("div",{className:"text-center py-12",children:[x.jsx(k,{size:48,className:"mx-auto mb-4 text-gray-400"}),x.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No expenses found"}),x.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:0===t.length?"Add your first business expense to get started":"Try adjusting your filters"}),0===t.length&&x.jsxs("button",{onClick:N,className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[x.jsx(o,{size:16}),"Add Expense"]})]}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"sm:hidden space-y-3",children:s.map(e=>x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700",children:[x.jsxs("div",{className:"flex justify-between items-start mb-3",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[z(e.category),x.jsxs("div",{className:"flex-1",children:[x.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.description}),e.notes&&x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.notes})]})]}),x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>f(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-blue-600 hover:text-blue-900 dark:text-blue-400",children:x.jsx(h,{size:20})}),x.jsx("button",{onClick:()=>D(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-red-600 hover:text-red-900 dark:text-red-400",children:x.jsx(p,{size:20})})]})]}),x.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[x.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:T(e.category)}),x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:I(e.date)}),e.isDeductible?x.jsxs("span",{className:"inline-flex items-center gap-1 text-green-600 dark:text-green-400 text-xs",children:[x.jsx(u,{size:14}),"Deductible"]}):x.jsxs("span",{className:"inline-flex items-center gap-1 text-red-600 dark:text-red-400 text-xs",children:[x.jsx(C,{size:14}),"Non-deductible"]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[x.jsxs("div",{children:[x.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Amount"}),x.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:E(e.amount)})]}),x.jsxs("div",{children:[x.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"VAT"}),x.jsx("span",{className:"text-gray-900 dark:text-white",children:e.vatAmount?E(e.vatAmount):"-"})]})]})]},e.id))}),x.jsx("div",{className:"hidden sm:block overflow-x-auto",children:x.jsxs("table",{className:"w-full",children:[x.jsx("thead",{className:"bg-secondary dark:bg-gray-700",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Expense"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Category"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Amount"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"VAT"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Deductible"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Date"}),x.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),x.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map(e=>x.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsxs("div",{className:"flex items-center",children:[z(e.category),x.jsxs("div",{className:"ml-3",children:[x.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.description}),e.notes&&x.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.notes})]})]})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:T(e.category)})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:E(e.amount)}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.vatAmount?E(e.vatAmount):"-"}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.isDeductible?x.jsx(u,{size:16,className:"text-green-500"}):x.jsx(C,{size:16,className:"text-red-500"})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:I(e.date)}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:x.jsxs("div",{className:"flex items-center justify-end gap-2",children:[x.jsx("button",{onClick:()=>f(e),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:x.jsx(h,{size:16})}),x.jsx("button",{onClick:()=>D(e),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:x.jsx(p,{size:16})})]})})]},e.id))})]})})]})}),i&&x.jsx(n,{expense:l,onClose:()=>d(!1),onSave:t=>{l?R.updateBusinessExpense(l.id,t):R.addBusinessExpense(t),d(!1),j(),e()}})]})}function n({expense:e,onClose:t,onSave:a}){const[s,r]=c.useState({date:e?.date.toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],description:e?.description||"",amount:e?.amount||0,category:e?.category||"other",vatAmount:e?.vatAmount||0,isDeductible:e?.isDeductible??!0,notes:e?.notes||""});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-md",children:x.jsxs("form",{onSubmit:e=>{e.preventDefault(),a({...s,date:new Date(s.date),vatAmount:s.vatAmount||void 0})},className:"p-6",children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e?"Edit Expense":"Add Expense"}),x.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:x.jsx(o,{size:20,className:"rotate-45"})})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date"}),x.jsx("input",{type:"date",value:s.date,onChange:e=>r({...s,date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),x.jsx("input",{type:"text",value:s.description,onChange:e=>r({...s,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter expense description",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Amount"}),x.jsx("input",{type:"number",value:s.amount,onChange:e=>r({...s,amount:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"0.00",step:"0.01",min:"0",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),x.jsxs("select",{value:s.category,onChange:e=>r({...s,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,children:[x.jsx("option",{value:"office_supplies",children:"Office Supplies"}),x.jsx("option",{value:"travel",children:"Travel"}),x.jsx("option",{value:"meals",children:"Meals"}),x.jsx("option",{value:"utilities",children:"Utilities"}),x.jsx("option",{value:"rent",children:"Rent"}),x.jsx("option",{value:"marketing",children:"Marketing"}),x.jsx("option",{value:"professional_services",children:"Professional Services"}),x.jsx("option",{value:"equipment",children:"Equipment"}),x.jsx("option",{value:"software",children:"Software"}),x.jsx("option",{value:"insurance",children:"Insurance"}),x.jsx("option",{value:"other",children:"Other"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"VAT Amount (Optional)"}),x.jsx("input",{type:"number",value:s.vatAmount,onChange:e=>r({...s,vatAmount:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"0.00",step:"0.01",min:"0"})]}),x.jsx("div",{children:x.jsxs("label",{className:"flex items-center gap-2",children:[x.jsx("input",{type:"checkbox",checked:s.isDeductible,onChange:e=>r({...s,isDeductible:e.target.checked}),className:"rounded border-gray-300 dark:border-gray-600"}),x.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Tax deductible"})]})}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes (Optional)"}),x.jsx("textarea",{value:s.notes,onChange:e=>r({...s,notes:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"Additional notes..."})]})]}),x.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[x.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"Cancel"}),x.jsxs("button",{type:"submit",className:"px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[e?"Update":"Add"," Expense"]})]})]})})})}function d(){const[t,a]=c.useState("overview"),[r,n]=c.useState(null),[d,l]=c.useState(!0);c.useEffect(()=>{o()},[]);const o=async()=>{l(!0);try{const e=R.getBusinessMetrics();n(e)}catch(e){console.error("Error loading business data:",e)}finally{l(!1)}},g=()=>{o()},h=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return d?x.jsx(z,{title:"Business Features",children:x.jsx("div",{className:"flex items-center justify-center min-h-64",children:x.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading business data..."})})}):x.jsx(z,{title:"Business Features",children:x.jsxs("div",{className:"max-w-7xl mx-auto",children:[x.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-800 dark:to-indigo-800 rounded-2xl p-6 mb-6 text-white shadow-lg",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Business Features"}),x.jsx("p",{className:"text-blue-100",children:"Manage invoices, track expenses, and monitor business performance"})]}),x.jsx(E,{size:48,className:"text-white/80"})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm mb-6",children:x.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:x.jsxs("nav",{className:"flex space-x-8",children:[x.jsx("button",{onClick:()=>a("overview"),className:"py-4 px-6 border-b-2 font-medium text-sm "+("overview"===t?"border-[var(--color-primary)] text-[var(--color-primary)]":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(I,{size:16}),"Overview"]})}),x.jsx("button",{onClick:()=>a("invoices"),className:"py-4 px-6 border-b-2 font-medium text-sm "+("invoices"===t?"border-[var(--color-primary)] text-[var(--color-primary)]":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(m,{size:16}),"Invoices"]})}),x.jsx("button",{onClick:()=>a("expenses"),className:"py-4 px-6 border-b-2 font-medium text-sm "+("expenses"===t?"border-[var(--color-primary)] text-[var(--color-primary)]":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(k,{size:16}),"Expenses"]})}),x.jsx("button",{onClick:()=>a("mileage"),className:"py-4 px-6 border-b-2 font-medium text-sm "+("mileage"===t?"border-[var(--color-primary)] text-[var(--color-primary)]":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(N,{size:16}),"Mileage"]})})]})})}),"overview"===t&&r&&x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Revenue"}),x.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:h(r.totalRevenue)})]}),x.jsx(f,{size:24,className:"text-green-500"})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Expenses"}),x.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:h(r.totalExpenses)})]}),x.jsx(k,{size:24,className:"text-red-500"})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Net Profit"}),x.jsx("p",{className:"text-2xl font-bold "+(r.netProfit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:h(r.netProfit)})]}),x.jsx(T,{size:24,className:r.netProfit>=0?"text-green-500":"text-red-500"})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Profit Margin"}),x.jsx("p",{className:"text-2xl font-bold "+(r.profitMargin>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:(u=r.profitMargin,`${u.toFixed(1)}%`)})]}),x.jsx(I,{size:24,className:r.profitMargin>=0?"text-green-500":"text-red-500"})]})})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[x.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[x.jsx(m,{size:20,className:"text-blue-600 dark:text-blue-400"}),x.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Invoice Status"})]}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Outstanding"}),x.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.outstandingInvoices})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Overdue"}),x.jsx("span",{className:"font-medium text-red-600 dark:text-red-400",children:r.overdueInvoices})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Payment Time"}),x.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[r.averagePaymentTime.toFixed(0)," days"]})]})]})]}),x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[x.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[x.jsx(k,{size:20,className:"text-green-600 dark:text-green-400"}),x.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Top Expenses"})]}),x.jsx("div",{className:"space-y-3",children:r.topExpenseCategories.slice(0,3).map((e,t)=>x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 capitalize",children:e.category.replace("_"," ")}),x.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:h(e.amount)})]},e.category))})]}),x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[x.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[x.jsx(A,{size:20,className:"text-purple-600 dark:text-purple-400"}),x.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"This Month"})]}),x.jsx("div",{className:"space-y-3",children:r.monthlyTrends.slice(-1).map((e,t)=>x.jsxs("div",{className:"space-y-2",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Revenue"}),x.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:h(e.revenue)})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Expenses"}),x.jsx("span",{className:"font-medium text-red-600 dark:text-red-400",children:h(e.expenses)})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Profit"}),x.jsx("span",{className:"font-medium "+(e.profit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:h(e.profit)})]})]},t))})]})]}),x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[x.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Monthly Trends"}),x.jsx("div",{className:"space-y-4",children:r.monthlyTrends.slice(-6).map((e,t)=>x.jsxs("div",{className:"flex items-center justify-between py-2",children:[x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white w-20",children:e.month}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Revenue"})]}),x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Expenses"})]}),x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Profit"})]})]})]}),x.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[x.jsx("span",{className:"text-green-600 dark:text-green-400",children:h(e.revenue)}),x.jsx("span",{className:"text-red-600 dark:text-red-400",children:h(e.expenses)}),x.jsx("span",{className:e.profit>=0?"text-blue-600 dark:text-blue-400":"text-red-600 dark:text-red-400",children:h(e.profit)})]})]},t))})]})]}),"invoices"===t&&x.jsx(e,{onDataChange:g}),"expenses"===t&&x.jsx(i,{onDataChange:g}),"mileage"===t&&x.jsx(s,{onDataChange:g})]})});var u}import{bP as l,r as c,H as x}from"./chunk-DowOIOga.js";import{$ as o,aH as m,ag as g,E as h,v as u,ao as p,aF as y,aa as b,bz as j,ay as v,br as N,ak as k,T as f,R as w,bA as D,b0 as C,k as S,C as A,bB as E,B as I,f as T}from"./index-qHm2isZb.js";import{P as z}from"./chunk-r7IQz9KP.js";import"./chunk-ddLY9KjI.js";import"./chunk-B5pcS96K.js";const R=new class{vatRates=[{id:"1",name:"Standard Rate",rate:.2,isDefault:!0},{id:"2",name:"Reduced Rate",rate:.05,isDefault:!1},{id:"3",name:"Zero Rate",rate:0,isDefault:!1}];invoices=[];mileageEntries=[];businessExpenses=[];constructor(){this.loadData(),this.createSampleData()}loadData(){try{const e=localStorage.getItem("business-vat-rates");e&&(this.vatRates=JSON.parse(e));const t=localStorage.getItem("business-invoices");t&&(this.invoices=JSON.parse(t).map(e=>({...e,issueDate:new Date(e.issueDate),dueDate:new Date(e.dueDate),createdAt:new Date(e.createdAt),paidAt:e.paidAt?new Date(e.paidAt):void 0})));const a=localStorage.getItem("business-mileage");a&&(this.mileageEntries=JSON.parse(a).map(e=>({...e,date:new Date(e.date),createdAt:new Date(e.createdAt)})));const s=localStorage.getItem("business-expenses");s&&(this.businessExpenses=JSON.parse(s).map(e=>({...e,date:new Date(e.date),createdAt:new Date(e.createdAt)})))}catch(e){console.error("Error loading business data:",e)}}saveData(){try{localStorage.setItem("business-vat-rates",JSON.stringify(this.vatRates)),localStorage.setItem("business-invoices",JSON.stringify(this.invoices)),localStorage.setItem("business-mileage",JSON.stringify(this.mileageEntries)),localStorage.setItem("business-expenses",JSON.stringify(this.businessExpenses))}catch(e){console.error("Error saving business data:",e)}}createSampleData(){if(0===this.invoices.length){const e=[{id:"1",invoiceNumber:"INV-2024-001",clientName:"Acme Corporation",clientEmail:"accounts@acme.com",issueDate:new Date("2024-01-15"),dueDate:new Date("2024-02-15"),items:[{id:"1",description:"Web Development Services",quantity:40,unitPrice:75,vatRate:.2,total:3600}],subtotal:3e3,vatAmount:600,total:3600,status:"paid",paymentTerms:"Net 30",notes:"Thank you for your business!",createdAt:new Date("2024-01-15"),paidAt:new Date("2024-02-10")},{id:"2",invoiceNumber:"INV-2024-002",clientName:"Tech Solutions Ltd",clientEmail:"billing@techsolutions.com",issueDate:new Date("2024-02-01"),dueDate:new Date("2024-03-01"),items:[{id:"2",description:"Monthly Maintenance",quantity:1,unitPrice:500,vatRate:.2,total:600}],subtotal:500,vatAmount:100,total:600,status:"sent",paymentTerms:"Net 30",createdAt:new Date("2024-02-01")}];this.invoices=e}if(0===this.mileageEntries.length){const e=[{id:"1",date:new Date("2024-01-15"),startLocation:"Office",endLocation:"Client Meeting - Downtown",distance:25,purpose:"Client consultation",rate:.67,amount:16.75,category:"business",notes:"Meeting with Acme Corporation",createdAt:new Date("2024-01-15")},{id:"2",date:new Date("2024-01-20"),startLocation:"Home",endLocation:"Networking Event",distance:15,purpose:"Business networking",rate:.67,amount:10.05,category:"business",createdAt:new Date("2024-01-20")}];this.mileageEntries=e}if(0===this.businessExpenses.length){const e=[{id:"1",date:new Date("2024-01-10"),description:"Office Supplies - Stationery",amount:125.5,category:"office_supplies",vatAmount:25.1,isDeductible:!0,notes:"Paper, pens, folders",createdAt:new Date("2024-01-10")},{id:"2",date:new Date("2024-01-15"),description:"Software Subscription - Adobe Creative Suite",amount:52.99,category:"software",vatAmount:10.6,isDeductible:!0,notes:"Monthly subscription",createdAt:new Date("2024-01-15")},{id:"3",date:new Date("2024-01-20"),description:"Business Lunch - Client Meeting",amount:85,category:"meals",vatAmount:17,isDeductible:!0,notes:"Meeting with Tech Solutions Ltd",createdAt:new Date("2024-01-20")}];this.businessExpenses=e}this.saveData()}getVATRates(){return this.vatRates}getDefaultVATRate(){return this.vatRates.find(e=>e.isDefault)||this.vatRates[0]}addVATRate(e){const t={...e,id:Date.now().toString()};return e.isDefault&&(this.vatRates=this.vatRates.map(e=>({...e,isDefault:!1}))),this.vatRates.push(t),this.saveData(),t}updateVATRate(e,t){const a=this.vatRates.findIndex(t=>t.id===e);return-1===a?null:(t.isDefault&&(this.vatRates=this.vatRates.map(e=>({...e,isDefault:!1}))),this.vatRates[a]={...this.vatRates[a],...t},this.saveData(),this.vatRates[a])}deleteVATRate(e){const t=this.vatRates.findIndex(t=>t.id===e);return-1!==t&&(this.vatRates.splice(t,1),this.saveData(),!0)}getInvoices(){return this.invoices.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime())}getInvoiceById(e){return this.invoices.find(t=>t.id===e)||null}createInvoice(e){const t={...e,id:Date.now().toString(),createdAt:new Date};return this.invoices.push(t),this.saveData(),t}updateInvoice(e,t){const a=this.invoices.findIndex(t=>t.id===e);return-1===a?null:(this.invoices[a]={...this.invoices[a],...t},this.saveData(),this.invoices[a])}deleteInvoice(e){const t=this.invoices.findIndex(t=>t.id===e);return-1!==t&&(this.invoices.splice(t,1),this.saveData(),!0)}markInvoiceAsPaid(e,t=new Date){return this.getInvoiceById(e)?this.updateInvoice(e,{status:"paid",paidAt:t}):null}calculateInvoiceTotals(e){let t=new l(0),a=new l(0);e.forEach(e=>{const s=new l(e.quantity).mul(e.unitPrice),r=s.mul(e.vatRate);t=t.plus(s),a=a.plus(r)});const s=t.plus(a);return{subtotal:t.toNumber(),vatAmount:a.toNumber(),total:s.toNumber()}}getMileageEntries(){return this.mileageEntries.sort((e,t)=>t.date.getTime()-e.date.getTime())}addMileageEntry(e){const t=new l(e.distance).mul(e.rate).toNumber(),a={...e,id:Date.now().toString(),amount:t,createdAt:new Date};return this.mileageEntries.push(a),this.saveData(),a}updateMileageEntry(e,t){const a=this.mileageEntries.findIndex(t=>t.id===e);if(-1===a)return null;const s={...this.mileageEntries[a],...t};return void 0===t.distance&&void 0===t.rate||(s.amount=new l(s.distance).mul(s.rate).toNumber()),this.mileageEntries[a]=s,this.saveData(),s}deleteMileageEntry(e){const t=this.mileageEntries.findIndex(t=>t.id===e);return-1!==t&&(this.mileageEntries.splice(t,1),this.saveData(),!0)}getBusinessExpenses(){return this.businessExpenses.sort((e,t)=>t.date.getTime()-e.date.getTime())}addBusinessExpense(e){const t={...e,id:Date.now().toString(),createdAt:new Date};return this.businessExpenses.push(t),this.saveData(),t}updateBusinessExpense(e,t){const a=this.businessExpenses.findIndex(t=>t.id===e);return-1===a?null:(this.businessExpenses[a]={...this.businessExpenses[a],...t},this.saveData(),this.businessExpenses[a])}deleteBusinessExpense(e){const t=this.businessExpenses.findIndex(t=>t.id===e);return-1!==t&&(this.businessExpenses.splice(t,1),this.saveData(),!0)}getBusinessMetrics(e,t){const a=this.getInvoicesInRange(e,t),s=this.getExpensesInRange(e,t),r=this.getMileageInRange(e,t),i=a.filter(e=>"paid"===e.status).reduce((e,t)=>e+t.total,0),n=s.reduce((e,t)=>e+t.amount,0)+r.reduce((e,t)=>e+t.amount,0),d=i-n,l=i>0?d/i*100:0,c=a.filter(e=>"sent"===e.status||"overdue"===e.status).length,x=a.filter(e=>"overdue"===e.status||"sent"===e.status&&e.dueDate<new Date).length,o=a.filter(e=>"paid"===e.status&&e.paidAt),m=o.length>0?o.reduce((e,t)=>e+Math.ceil((t.paidAt.getTime()-t.issueDate.getTime())/864e5),0)/o.length:0,g=s.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+t.amount,e),{}),h=Object.entries(g).map(([e,t])=>({category:e,amount:t,percentage:n>0?t/n*100:0})).sort((e,t)=>t.amount-e.amount).slice(0,5),u=this.calculateMonthlyTrends(a,s,r);return{totalRevenue:i,totalExpenses:n,netProfit:d,profitMargin:l,outstandingInvoices:c,overdueInvoices:x,averagePaymentTime:m,topExpenseCategories:h,monthlyTrends:u}}getInvoicesInRange(e,t){return e||t?this.invoices.filter(a=>{const s=a.issueDate;return!(e&&s<e||t&&s>t)}):this.invoices}getExpensesInRange(e,t){return e||t?this.businessExpenses.filter(a=>{const s=a.date;return!(e&&s<e||t&&s>t)}):this.businessExpenses}getMileageInRange(e,t){return e||t?this.mileageEntries.filter(a=>{const s=a.date;return!(e&&s<e||t&&s>t)}):this.mileageEntries}calculateMonthlyTrends(e,t,a){const s=[];for(let r=11;r>=0;r--){const i=new Date;i.setMonth(i.getMonth()-r);const n=new Date(i.getFullYear(),i.getMonth(),1),d=new Date(i.getFullYear(),i.getMonth()+1,0),l=e.filter(e=>"paid"===e.status&&e.paidAt&&e.paidAt>=n&&e.paidAt<=d),c=t.filter(e=>e.date>=n&&e.date<=d),x=a.filter(e=>e.date>=n&&e.date<=d),o=l.reduce((e,t)=>e+t.total,0),m=c.reduce((e,t)=>e+t.amount,0)+x.reduce((e,t)=>e+t.amount,0);s.push({month:i.toLocaleDateString("en-US",{month:"short",year:"numeric"}),revenue:o,expenses:m,profit:o-m})}return s}generateInvoiceNumber(){return`INV-${(new Date).getFullYear()}-${(this.invoices.length+1).toString().padStart(3,"0")}`}exportBusinessData(){return{invoices:this.invoices,expenses:this.businessExpenses,mileage:this.mileageEntries,metrics:this.getBusinessMetrics()}}};export{d as default};
