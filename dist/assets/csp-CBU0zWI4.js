const e=e=>{const t={"default-src":["'self'"],"script-src":["'self'","","https:","","'unsafe-eval'"].filter(Boolean),"style-src":["'self'","'unsafe-inline'","https://fonts.googleapis.com"],"img-src":["'self'","data:","blob:","https:","https://logo.clearbit.com"],"font-src":["'self'","https://fonts.gstatic.com"],"connect-src":["'self'","ws:","wss:","https://api.exchangerate-api.com","https://cdn.jsdelivr.net","https://*.clerk.accounts.dev","https://clerk.com","https://*.clerk.com","https://api.stripe.com","https://*.supabase.co","https://supabase.co"],"media-src":["'self'","blob:"],"object-src":["'none'"],"frame-ancestors":["'none'"],"frame-src":["'self'","https://js.stripe.com","https://hooks.stripe.com"],"worker-src":["'self'","blob:"],"base-uri":["'self'"],"form-action":["'self'"],"upgrade-insecure-requests":[],"block-all-mixed-content":[]};return Object.keys(t).forEach(e=>{0===t[e].length&&delete t[e]}),t},t=t=>{const o=e();return Object.entries(o).map(([e,t])=>0===t.length?e:`${e} ${t.join(" ")}`).join("; ")},o=()=>{if("undefined"==typeof document)return;const e=document.querySelector('meta[http-equiv="Content-Security-Policy"]');e&&e.remove();const o=document.createElement("meta");o.httpEquiv="Content-Security-Policy",o.content=t(),document.head.appendChild(o)},s=()=>{"undefined"!=typeof window&&"SecurityPolicyViolationEvent"in window&&"undefined"!=typeof document&&document.addEventListener("securitypolicyviolation",e=>{console.error("CSP Violation:",{blockedURI:e.blockedURI,violatedDirective:e.violatedDirective,originalPolicy:e.originalPolicy,disposition:e.disposition,documentURI:e.documentURI,effectiveDirective:e.effectiveDirective,lineNumber:e.lineNumber,columnNumber:e.columnNumber,sourceFile:e.sourceFile,statusCode:e.statusCode})})};export{o as applyCSPMetaTag,e as getCSPDirectives,t as getCSPHeader,s as setupCSPReporting};
