function e({onSave:e,onCancel:b,initialQuery:m}){t();const[x,y]=a.useState(m?.name||""),[p,v]=a.useState(m?.dataSource||"transactions"),[h,j]=a.useState(m?.conditions||[]),[k,N]=a.useState(m?.aggregations||[]),[f,w]=a.useState(m?.groupBy||[]),[C,S]=a.useState(m?.sortBy||[]),[A,z]=a.useState(m?.limit||100),[B,D]=a.useState(m?.dateRange),T=u[p],_=(e,a)=>{const r=[...h];r[e]={...r[e],...a},j(r)},Q=(e,a)=>{const r=[...k];r[e]={...r[e],...a},N(r)},R=(e,a)=>{const r=[...C];r[e]={...r[e],...a},S(r)},G=e=>{const a=T.find(a=>a.value===e);return a?.type||"text"},I=e=>{const a=G(e);return g.filter(e=>e.types.includes(a))};return r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Query Builder"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:b,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:"Cancel"}),r.jsx("button",{onClick:()=>{const a={id:m?.id||`query-${Date.now()}`,name:x||"Untitled Query",dataSource:p,conditions:h,aggregations:k,groupBy:f,sortBy:C,limit:A,dateRange:B};e(a)},className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90",children:"Save Query"})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Query Name"}),r.jsx("input",{type:"text",value:x,onChange:e=>y(e.target.value),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Monthly Expense Analysis"})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data Source"}),r.jsxs("select",{value:p,onChange:e=>{v(e.target.value),j([]),N([]),w([]),S([])},className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg",children:[r.jsx("option",{value:"transactions",children:"Transactions"}),r.jsx("option",{value:"accounts",children:"Accounts"}),r.jsx("option",{value:"budgets",children:"Budgets"}),r.jsx("option",{value:"goals",children:"Goals"}),r.jsx("option",{value:"investments",children:"Investments"})]})]}),r.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(l,{size:20,className:"text-gray-600 dark:text-gray-400"}),r.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Date Range"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("select",{value:B?.field||"",onChange:e=>D(e.target.value?{...B,field:e.target.value}:void 0),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-sm",children:[r.jsx("option",{value:"",children:"No date filter"}),T.filter(e=>"date"===e.type).map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))]}),B&&r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"date",value:B.start,onChange:e=>D({...B,start:e.target.value}),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-sm"}),r.jsx("input",{type:"date",value:B.end,onChange:e=>D({...B,end:e.target.value}),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-sm"})]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(s,{size:20,className:"text-gray-600 dark:text-gray-400"}),r.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Filters"})]}),r.jsxs("button",{onClick:()=>{j([...h,{field:T[0].value,operator:"equals",value:""}])},className:"flex items-center gap-1 px-3 py-1 bg-primary text-white rounded-lg hover:bg-primary/90 text-sm",children:[r.jsx(n,{size:16}),"Add Filter"]})]}),r.jsx("div",{className:"space-y-2",children:h.map((e,a)=>r.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[r.jsx("select",{value:e.field,onChange:e=>_(a,{field:e.target.value}),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm",children:T.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))}),r.jsx("select",{value:e.operator,onChange:e=>_(a,{operator:e.target.value}),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm",children:I(e.field).map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))}),r.jsx("input",{type:"number"===G(e.field)?"number":"text",value:e.value,onChange:e=>_(a,{value:e.target.value}),className:"flex-1 px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm",placeholder:"Value"}),"between"===e.operator&&r.jsx("input",{type:"number"===G(e.field)?"number":"text",value:e.value2||"",onChange:e=>_(a,{value2:e.target.value}),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm",placeholder:"To"}),r.jsx("button",{onClick:()=>(e=>{j(h.filter((a,r)=>r!==e))})(a),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:r.jsx(d,{size:16})})]},a))})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(i,{size:20,className:"text-gray-600 dark:text-gray-400"}),r.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Aggregations"})]}),r.jsxs("button",{onClick:()=>{N([...k,{field:T[0].value,function:"sum",alias:""}])},className:"flex items-center gap-1 px-3 py-1 bg-primary text-white rounded-lg hover:bg-primary/90 text-sm",children:[r.jsx(n,{size:16}),"Add Aggregation"]})]}),r.jsx("div",{className:"space-y-2",children:k.map((e,a)=>r.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[r.jsx("select",{value:e.function,onChange:e=>Q(a,{function:e.target.value}),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm",children:c.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))}),r.jsx("select",{value:e.field,onChange:e=>Q(a,{field:e.target.value}),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm",children:T.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))}),r.jsx("input",{type:"text",value:e.alias||"",onChange:e=>Q(a,{alias:e.target.value}),className:"flex-1 px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm",placeholder:"Alias (optional)"}),r.jsx("button",{onClick:()=>(e=>{N(k.filter((a,r)=>r!==e))})(a),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:r.jsx(d,{size:16})})]},a))})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Group By"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(e=>r.jsx("button",{onClick:()=>{f.includes(e.value)?w(f.filter(a=>a!==e.value)):w([...f,e.value])},className:"px-3 py-1 rounded-lg text-sm transition-colors "+(f.includes(e.value)?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:e.label},e.value))})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(o,{size:20,className:"text-gray-600 dark:text-gray-400"}),r.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Sort By"})]}),r.jsxs("button",{onClick:()=>{S([...C,{field:T[0].value,direction:"asc"}])},className:"flex items-center gap-1 px-3 py-1 bg-primary text-white rounded-lg hover:bg-primary/90 text-sm",children:[r.jsx(n,{size:16}),"Add Sort"]})]}),r.jsx("div",{className:"space-y-2",children:C.map((e,a)=>r.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[r.jsx("select",{value:e.field,onChange:e=>R(a,{field:e.target.value}),className:"flex-1 px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm",children:T.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))}),r.jsxs("select",{value:e.direction,onChange:e=>R(a,{direction:e.target.value}),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm",children:[r.jsx("option",{value:"asc",children:"Ascending"}),r.jsx("option",{value:"desc",children:"Descending"})]}),r.jsx("button",{onClick:()=>(e=>{S(C.filter((a,r)=>r!==e))})(a),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:r.jsx(d,{size:16})})]},a))})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Result Limit"}),r.jsx("input",{type:"number",value:A,onChange:e=>z(parseInt(e.target.value)||100),min:"1",max:"10000",className:"w-32 px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"})]})]})}import{r as a,L as r}from"./chunk-Bcp2Zi4E.js";import{a as t,C as l,R as s,$ as n,X as d,bL as i,aC as o}from"./index-LbveD3Go.js";import"./chunk-oUGr0aFc.js";import"./chunk-a7oqB5tI.js";import"./chunk-B5pcS96K.js";const u={transactions:[{value:"date",label:"Date",type:"date"},{value:"description",label:"Description",type:"text"},{value:"amount",label:"Amount",type:"number"},{value:"category",label:"Category",type:"text"},{value:"account_id",label:"Account",type:"text"},{value:"type",label:"Type",type:"text"},{value:"tags",label:"Tags",type:"array"}],accounts:[{value:"name",label:"Account Name",type:"text"},{value:"type",label:"Account Type",type:"text"},{value:"balance",label:"Balance",type:"number"},{value:"currency",label:"Currency",type:"text"},{value:"institution",label:"Institution",type:"text"}],budgets:[{value:"category",label:"Category",type:"text"},{value:"amount",label:"Budget Amount",type:"number"},{value:"spent",label:"Amount Spent",type:"number"},{value:"period",label:"Period",type:"text"}],goals:[{value:"name",label:"Goal Name",type:"text"},{value:"target_amount",label:"Target Amount",type:"number"},{value:"current_amount",label:"Current Amount",type:"number"},{value:"target_date",label:"Target Date",type:"date"},{value:"category",label:"Category",type:"text"}],investments:[{value:"symbol",label:"Symbol",type:"text"},{value:"name",label:"Investment Name",type:"text"},{value:"shares",label:"Shares",type:"number"},{value:"purchase_price",label:"Purchase Price",type:"number"},{value:"current_price",label:"Current Price",type:"number"},{value:"value",label:"Total Value",type:"number"},{value:"gain_loss",label:"Gain/Loss",type:"number"}]},g=[{value:"equals",label:"=",types:["text","number","date"]},{value:"contains",label:"contains",types:["text"]},{value:"greater",label:">",types:["number","date"]},{value:"less",label:"<",types:["number","date"]},{value:"between",label:"between",types:["number","date"]},{value:"in",label:"in",types:["text","array"]},{value:"not_in",label:"not in",types:["text","array"]}],c=[{value:"sum",label:"Sum"},{value:"avg",label:"Average"},{value:"count",label:"Count"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"distinct",label:"Distinct Count"}];export{e as default};
