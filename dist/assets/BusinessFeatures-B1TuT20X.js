function e({onDataChange:e}){const[s,r]=T.useState([]),[i,n]=T.useState(!1),[d,l]=T.useState(!1),[j,v]=T.useState(null),[N,k]=T.useState(null);T.useEffect(()=>{f()},[]);const f=()=>{r(R.getInvoices())},w=()=>{k(null),n(!0)},D=e=>{k(e),n(!0)},C=e=>{v(e),l(!0)},S=t=>{window.confirm("Are you sure you want to delete this invoice?")&&(R.deleteInvoice(t.id),f(),e())},A=t=>{R.markInvoiceAsPaid(t.id),f(),e()},E=e=>{switch(e){case"draft":return c.jsx(g,{size:16,className:"text-gray-500"});case"sent":return c.jsx(b,{size:16,className:"text-blue-500"});case"paid":return c.jsx(h,{size:16,className:"text-green-500"});case"overdue":return c.jsx(y,{size:16,className:"text-red-500"});default:return c.jsx(p,{size:16,className:"text-gray-500"})}},I=e=>{switch(e){case"draft":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200";case"sent":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-200";case"paid":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-200";case"overdue":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-200"}},z=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),M=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Invoice Management"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Create, send, and track your invoices"})]}),c.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[c.jsx(x,{size:16}),"Create Invoice"]})]}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden",children:0===s.length?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(o,{size:48,className:"mx-auto mb-4 text-gray-400"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No invoices yet"}),c.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Create your first invoice to get started"}),c.jsxs("button",{onClick:w,className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[c.jsx(x,{size:16}),"Create Invoice"]})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"sm:hidden space-y-3",children:s.map(e=>c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700",children:[c.jsxs("div",{className:"flex justify-between items-start mb-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(o,{size:20,className:"text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.invoiceNumber}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.clientName})]})]}),c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${I(e.status)}`,children:[E(e.status),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Amount"}),c.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:z(e.total)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Due Date"}),c.jsx("span",{className:"text-gray-900 dark:text-white",children:M(e.dueDate)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Issue Date"}),c.jsx("span",{className:"text-gray-900 dark:text-white",children:M(e.issueDate)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Email"}),c.jsx("span",{className:"text-gray-900 dark:text-white text-xs",children:e.clientEmail})]})]}),c.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t border-gray-200 dark:border-gray-700",children:[c.jsx("button",{onClick:()=>C(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-blue-600 hover:text-blue-900 dark:text-blue-400",title:"View",children:c.jsx(m,{size:20})}),c.jsx("button",{onClick:()=>D(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-gray-600 hover:text-gray-900 dark:text-gray-400",title:"Edit",children:c.jsx(g,{size:20})}),"paid"!==e.status&&c.jsx("button",{onClick:()=>A(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-green-600 hover:text-green-900 dark:text-green-400",title:"Mark as Paid",children:c.jsx(h,{size:20})}),c.jsx("button",{onClick:()=>S(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-red-600 hover:text-red-900 dark:text-red-400",title:"Delete",children:c.jsx(u,{size:20})})]})]},e.id))}),c.jsx("div",{className:"hidden sm:block overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-secondary dark:bg-gray-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Invoice"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Client"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Amount"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Due Date"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map(e=>c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(o,{size:16,className:"text-gray-400 mr-2"}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.invoiceNumber}),c.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:M(e.issueDate)})]})]})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[c.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:e.clientName}),c.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.clientEmail})]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:z(e.total)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${I(e.status)}`,children:[E(e.status),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:M(e.dueDate)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>C(e),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:c.jsx(m,{size:16})}),c.jsx("button",{onClick:()=>D(e),className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300",children:c.jsx(g,{size:16})}),"paid"!==e.status&&c.jsx("button",{onClick:()=>A(e),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",title:"Mark as Paid",children:c.jsx(h,{size:16})}),c.jsx("button",{onClick:()=>S(e),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:c.jsx(u,{size:16})})]})})]},e.id))})]})})]})}),i&&c.jsx(t,{invoice:N,onClose:()=>n(!1),onSave:t=>{N?R.updateInvoice(N.id,t):R.createInvoice(t),n(!1),f(),e()}}),d&&j&&c.jsx(a,{invoice:j,onClose:()=>l(!1)})]})}function t({invoice:e,onClose:t,onSave:a}){const[s,r]=T.useState({invoiceNumber:e?.invoiceNumber||R.generateInvoiceNumber(),clientName:e?.clientName||"",clientEmail:e?.clientEmail||"",issueDate:e?.issueDate.toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],dueDate:e?.dueDate.toISOString().split("T")[0]||new Date(Date.now()+2592e6).toISOString().split("T")[0],paymentTerms:e?.paymentTerms||"Net 30",notes:e?.notes||"",status:e?.status||"draft"}),[i,n]=T.useState(e?.items||[{id:"1",description:"",quantity:1,unitPrice:0,vatRate:.2,total:0}]),d=(e,t)=>{const a=[...i];a[e]={...a[e],...t};const s=a[e].quantity,r=a[e].unitPrice,d=a[e].vatRate;a[e].total=s*r*(1+d),n(a)},l=()=>R.calculateInvoiceTotals(i),o=l();return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:c.jsxs("form",{onSubmit:e=>{e.preventDefault();const t=l();a({...s,issueDate:new Date(s.issueDate),dueDate:new Date(s.dueDate),items:i,subtotal:t.subtotal,vatAmount:t.vatAmount,total:t.total})},className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e?"Edit Invoice":"Create Invoice"}),c.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:c.jsx(x,{size:20,className:"rotate-45"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Invoice Number"}),c.jsx("input",{type:"text",value:s.invoiceNumber,onChange:e=>r({...s,invoiceNumber:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),c.jsxs("select",{value:s.status,onChange:e=>r({...s,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[c.jsx("option",{value:"draft",children:"Draft"}),c.jsx("option",{value:"sent",children:"Sent"}),c.jsx("option",{value:"paid",children:"Paid"}),c.jsx("option",{value:"overdue",children:"Overdue"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Client Name"}),c.jsx("input",{type:"text",value:s.clientName,onChange:e=>r({...s,clientName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Client Email"}),c.jsx("input",{type:"email",value:s.clientEmail,onChange:e=>r({...s,clientEmail:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Issue Date"}),c.jsx("input",{type:"date",value:s.issueDate,onChange:e=>r({...s,issueDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Due Date"}),c.jsx("input",{type:"date",value:s.dueDate,onChange:e=>r({...s,dueDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Payment Terms"}),c.jsxs("select",{value:s.paymentTerms,onChange:e=>r({...s,paymentTerms:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[c.jsx("option",{value:"Net 15",children:"Net 15"}),c.jsx("option",{value:"Net 30",children:"Net 30"}),c.jsx("option",{value:"Net 60",children:"Net 60"}),c.jsx("option",{value:"Due on Receipt",children:"Due on Receipt"})]})]})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Items"}),c.jsxs("button",{type:"button",onClick:()=>{const e={id:Date.now().toString(),description:"",quantity:1,unitPrice:0,vatRate:.2,total:0};n([...i,e])},className:"flex items-center gap-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[c.jsx(x,{size:14}),"Add Item"]})]}),c.jsx("div",{className:"space-y-4",children:i.map((e,t)=>c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[c.jsx("div",{className:"md:col-span-2",children:c.jsx("input",{type:"text",placeholder:"Description",value:e.description,onChange:e=>d(t,{description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})}),c.jsx("div",{children:c.jsx("input",{type:"number",placeholder:"Qty",value:e.quantity,onChange:e=>d(t,{quantity:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"1",required:!0})}),c.jsx("div",{children:c.jsx("input",{type:"number",placeholder:"Unit Price",value:e.unitPrice,onChange:e=>d(t,{unitPrice:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"0",step:"0.01",required:!0})}),c.jsx("div",{children:c.jsxs("select",{value:e.vatRate,onChange:e=>d(t,{vatRate:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[c.jsx("option",{value:0,children:"0%"}),c.jsx("option",{value:.05,children:"5%"}),c.jsx("option",{value:.2,children:"20%"})]})}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-sm text-gray-900 dark:text-white",children:["$",e.total.toFixed(2)]}),i.length>1&&c.jsx("button",{type:"button",onClick:()=>(e=>{i.length>1&&n(i.filter((t,a)=>a!==e))})(t),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:c.jsx(u,{size:16})})]})]},e.id))})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Subtotal:"}),c.jsxs("span",{className:"text-sm text-gray-900 dark:text-white",children:["$",o.subtotal.toFixed(2)]})]}),c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"VAT:"}),c.jsxs("span",{className:"text-sm text-gray-900 dark:text-white",children:["$",o.vatAmount.toFixed(2)]})]}),c.jsxs("div",{className:"flex justify-between items-center font-semibold text-lg",children:[c.jsx("span",{className:"text-gray-900 dark:text-white",children:"Total:"}),c.jsxs("span",{className:"text-gray-900 dark:text-white",children:["$",o.total.toFixed(2)]})]})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes"}),c.jsx("textarea",{value:s.notes,onChange:e=>r({...s,notes:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"Additional notes or payment instructions..."})]}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[e?"Update":"Create"," Invoice"]})]})]})})})}function a({invoice:e,onClose:t}){const a=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),s=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Invoice Preview"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:()=>window.print(),className:"flex items-center gap-2 px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:[c.jsx(j,{size:16}),"Print"]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:c.jsx(x,{size:20,className:"rotate-45"})})]})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-8 border border-gray-200 dark:border-gray-700",children:[c.jsxs("div",{className:"flex justify-between items-start mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"INVOICE"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.invoiceNumber})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Issue Date:"}),c.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:s(e.issueDate)}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Due Date:"}),c.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:s(e.dueDate)})]})]}),c.jsxs("div",{className:"mb-8",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Bill To:"}),c.jsx("p",{className:"text-gray-900 dark:text-white",children:e.clientName}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.clientEmail})]}),c.jsx("div",{className:"mb-8",children:c.jsxs("table",{className:"w-full border-collapse border border-gray-200 dark:border-gray-700",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[c.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-left text-sm font-medium text-gray-900 dark:text-white",children:"Description"}),c.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:"Qty"}),c.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:"Unit Price"}),c.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:"VAT"}),c.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-right text-sm font-medium text-gray-900 dark:text-white",children:"Total"})]})}),c.jsx("tbody",{children:e.items.map(e=>c.jsxs("tr",{children:[c.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-gray-900 dark:text-white",children:e.description}),c.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-center text-gray-900 dark:text-white",children:e.quantity}),c.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-center text-gray-900 dark:text-white",children:a(e.unitPrice)}),c.jsxs("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-center text-gray-900 dark:text-white",children:[(100*e.vatRate).toFixed(0),"%"]}),c.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-2 text-sm text-right text-gray-900 dark:text-white",children:a(e.total)})]},e.id))})]})}),c.jsx("div",{className:"flex justify-end mb-8",children:c.jsxs("div",{className:"w-64",children:[c.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-700",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Subtotal:"}),c.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:a(e.subtotal)})]}),c.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-700",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"VAT:"}),c.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:a(e.vatAmount)})]}),c.jsxs("div",{className:"flex justify-between items-center py-2 font-semibold text-lg",children:[c.jsx("span",{className:"text-gray-900 dark:text-white",children:"Total:"}),c.jsx("span",{className:"text-gray-900 dark:text-white",children:a(e.total)})]})]})}),c.jsxs("div",{className:"mb-8",children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Payment Terms:"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.paymentTerms})]}),e.notes&&c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Notes:"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.notes})]})]})]})})})}function s({onDataChange:e}){const[t,a]=T.useState([]),[s,i]=T.useState([]),[n,d]=T.useState(!1),[l,o]=T.useState(null),[m,h]=T.useState({category:"",dateRange:""});T.useEffect(()=>{p()},[]),T.useEffect(()=>{y()},[t,m]);const p=()=>{const e=R.getMileageEntries();a(e)},y=()=>{let e=[...t];if(m.category&&(e=e.filter(e=>e.category===m.category)),m.dateRange){const t=new Date;let a=new Date;switch(m.dateRange){case"this-month":a=new Date(t.getFullYear(),t.getMonth(),1);break;case"last-month":a=new Date(t.getFullYear(),t.getMonth()-1,1);break;case"this-quarter":{const e=Math.floor(t.getMonth()/3);a=new Date(t.getFullYear(),3*e,1);break}case"this-year":a=new Date(t.getFullYear(),0,1);break;default:a=new Date(0)}e=e.filter(e=>e.date>=a)}i(e)},b=()=>{o(null),d(!0)},j=e=>{o(e),d(!0)},D=t=>{window.confirm("Are you sure you want to delete this mileage entry?")&&(R.deleteMileageEntry(t.id),p(),e())},C=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),S=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),A=e=>{switch(e){case"business":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-200";case"medical":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-200";case"charitable":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-200";case"moving":return"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}},E=s.reduce((e,t)=>e+t.distance,0),I=s.reduce((e,t)=>e+t.amount,0),z=s.length>0?s.reduce((e,t)=>e+t.rate,0)/s.length:0;return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Mileage Tracker"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Track business mileage for tax deductions"})]}),c.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[c.jsx(x,{size:16}),c.jsx("span",{className:"hidden sm:inline",children:"Add Mileage"}),c.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Miles"}),c.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:E.toFixed(1)})]}),c.jsx(v,{size:24,className:"text-blue-500"})]})}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Amount"}),c.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:C(I)})]}),c.jsx(N,{size:24,className:"text-green-500"})]})}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Average Rate"}),c.jsxs("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:["$",z.toFixed(2),"/mi"]})]}),c.jsx(k,{size:24,className:"text-purple-500"})]})})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(f,{size:20,className:"text-gray-500"}),c.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Filters"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),c.jsxs("select",{value:m.category,onChange:e=>h({...m,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[c.jsx("option",{value:"",children:"All Categories"}),c.jsx("option",{value:"business",children:"Business"}),c.jsx("option",{value:"medical",children:"Medical"}),c.jsx("option",{value:"charitable",children:"Charitable"}),c.jsx("option",{value:"moving",children:"Moving"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),c.jsxs("select",{value:m.dateRange,onChange:e=>h({...m,dateRange:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[c.jsx("option",{value:"",children:"All Time"}),c.jsx("option",{value:"this-month",children:"This Month"}),c.jsx("option",{value:"last-month",children:"Last Month"}),c.jsx("option",{value:"this-quarter",children:"This Quarter"}),c.jsx("option",{value:"this-year",children:"This Year"})]})]})]})]}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden",children:0===s.length?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(w,{size:48,className:"mx-auto mb-4 text-gray-400"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No mileage entries found"}),c.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:0===t.length?"Add your first mileage entry to get started":"Try adjusting your filters"}),0===t.length&&c.jsxs("button",{onClick:b,className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[c.jsx(x,{size:16}),c.jsx("span",{children:"Add Mileage"})]})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"sm:hidden",children:s.map(e=>c.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[c.jsxs("div",{className:"flex justify-between items-start mb-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"font-medium text-gray-900 dark:text-white",children:[e.startLocation," \u2192 ",e.endLocation]}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.purpose}),e.notes&&c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e.notes})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>j(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:c.jsx(g,{size:20})}),c.jsx("button",{onClick:()=>D(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:c.jsx(u,{size:20})})]})]}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ${A(e.category)}`,children:e.category}),c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:S(e.date)})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Distance"}),c.jsxs("span",{className:"text-gray-900 dark:text-white font-medium",children:[e.distance.toFixed(1)," mi"]})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Rate"}),c.jsxs("span",{className:"text-gray-900 dark:text-white",children:["$",e.rate.toFixed(2),"/mi"]})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Amount"}),c.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:C(e.amount)})]})]})]},e.id))}),c.jsx("div",{className:"hidden sm:block overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-secondary dark:bg-gray-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Trip"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Category"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Distance"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Rate"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Amount"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Date"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map(e=>c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(v,{size:16,className:"text-gray-400 mr-2"}),c.jsxs("div",{children:[c.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.startLocation," \u2192 ",e.endLocation]}),c.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.purpose}),e.notes&&c.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e.notes})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ${A(e.category)}`,children:e.category})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:[e.distance.toFixed(1)," mi"]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:["$",e.rate.toFixed(2),"/mi"]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:C(e.amount)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:S(e.date)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>j(e),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:c.jsx(g,{size:16})}),c.jsx("button",{onClick:()=>D(e),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:c.jsx(u,{size:16})})]})})]},e.id))})]})})]})}),n&&c.jsx(r,{entry:l,onClose:()=>d(!1),onSave:t=>{l?R.updateMileageEntry(l.id,t):R.addMileageEntry(t),d(!1),p(),e()}})]})}function r({entry:e,onClose:t,onSave:a}){const[s,r]=T.useState({date:e?.date.toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],startLocation:e?.startLocation||"",endLocation:e?.endLocation||"",distance:e?.distance||0,purpose:e?.purpose||"",rate:e?.rate||.67,category:e?.category||"business",notes:e?.notes||""}),i=s.distance*s.rate;return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-lg",children:c.jsxs("form",{onSubmit:e=>{e.preventDefault(),a({...s,date:new Date(s.date)})},className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e?"Edit Mileage Entry":"Add Mileage Entry"}),c.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:c.jsx(x,{size:20,className:"rotate-45"})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date"}),c.jsx("input",{type:"date",value:s.date,onChange:e=>r({...s,date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Location"}),c.jsx("input",{type:"text",value:s.startLocation,onChange:e=>r({...s,startLocation:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter starting location",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"End Location"}),c.jsx("input",{type:"text",value:s.endLocation,onChange:e=>r({...s,endLocation:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter destination",required:!0})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Distance (miles)"}),c.jsx("input",{type:"number",value:s.distance,onChange:e=>r({...s,distance:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"0.0",step:"0.1",min:"0",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rate (per mile)"}),c.jsx("input",{type:"number",value:s.rate,onChange:e=>r({...s,rate:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"0.67",step:"0.01",min:"0",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Purpose"}),c.jsx("input",{type:"text",value:s.purpose,onChange:e=>r({...s,purpose:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter purpose of trip",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),c.jsxs("select",{value:s.category,onChange:e=>r({...s,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,children:[c.jsx("option",{value:"business",children:"Business"}),c.jsx("option",{value:"medical",children:"Medical"}),c.jsx("option",{value:"charitable",children:"Charitable"}),c.jsx("option",{value:"moving",children:"Moving"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes (Optional)"}),c.jsx("textarea",{value:s.notes,onChange:e=>r({...s,notes:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"Additional details..."})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Calculated Amount:"}),c.jsxs("span",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:["$",i.toFixed(2)]})]}),c.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[s.distance.toFixed(1)," miles \xd7 $",s.rate.toFixed(2),"/mile"]})]})]}),c.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[e?"Update":"Add"," Entry"]})]})]})})})}function i({onDataChange:e}){const[t,a]=T.useState([]),[s,r]=T.useState([]),[i,d]=T.useState(!1),[l,m]=T.useState(null),[p,y]=T.useState({category:"",isDeductible:"",dateRange:""});T.useEffect(()=>{b()},[]),T.useEffect(()=>{j()},[t,p]);const b=()=>{const e=R.getBusinessExpenses();a(e)},j=()=>{let e=[...t];if(p.category&&(e=e.filter(e=>e.category===p.category)),p.isDeductible){const t="true"===p.isDeductible;e=e.filter(e=>e.isDeductible===t)}if(p.dateRange){const t=new Date;let a=new Date;switch(p.dateRange){case"this-month":a=new Date(t.getFullYear(),t.getMonth(),1);break;case"last-month":a=new Date(t.getFullYear(),t.getMonth()-1,1);break;case"this-quarter":{const e=Math.floor(t.getMonth()/3);a=new Date(t.getFullYear(),3*e,1);break}case"this-year":a=new Date(t.getFullYear(),0,1);break;default:a=new Date(0)}e=e.filter(e=>e.date>=a)}r(e)},v=()=>{m(null),d(!0)},k=e=>{m(e),d(!0)},w=t=>{window.confirm("Are you sure you want to delete this expense?")&&(R.deleteBusinessExpense(t.id),b(),e())},A=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),E=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),I=e=>e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()),z=e=>{switch(e){case"office_supplies":return c.jsx(o,{size:16,className:"text-blue-500"});case"travel":return c.jsx(S,{size:16,className:"text-green-500"});case"meals":return c.jsx(N,{size:16,className:"text-orange-500"});case"software":return c.jsx(C,{size:16,className:"text-purple-500"});default:return c.jsx(N,{size:16,className:"text-gray-500"})}},M=s.reduce((e,t)=>e+t.amount,0),F=s.filter(e=>e.isDeductible).reduce((e,t)=>e+t.amount,0),q=s.reduce((e,t)=>e+(t.vatAmount||0),0);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Business Expenses"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Track and categorize your business expenses"})]}),c.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[c.jsx(x,{size:16}),"Add Expense"]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Expenses"}),c.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:A(M)})]}),c.jsx(N,{size:24,className:"text-red-500"})]})}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Deductible Expenses"}),c.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:A(F)})]}),c.jsx(h,{size:24,className:"text-green-500"})]})}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total VAT"}),c.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:A(q)})]}),c.jsx(o,{size:24,className:"text-blue-500"})]})})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(f,{size:20,className:"text-gray-500"}),c.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Filters"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),c.jsxs("select",{value:p.category,onChange:e=>y({...p,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[c.jsx("option",{value:"",children:"All Categories"}),c.jsx("option",{value:"office_supplies",children:"Office Supplies"}),c.jsx("option",{value:"travel",children:"Travel"}),c.jsx("option",{value:"meals",children:"Meals"}),c.jsx("option",{value:"utilities",children:"Utilities"}),c.jsx("option",{value:"rent",children:"Rent"}),c.jsx("option",{value:"marketing",children:"Marketing"}),c.jsx("option",{value:"professional_services",children:"Professional Services"}),c.jsx("option",{value:"equipment",children:"Equipment"}),c.jsx("option",{value:"software",children:"Software"}),c.jsx("option",{value:"insurance",children:"Insurance"}),c.jsx("option",{value:"other",children:"Other"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Deductible"}),c.jsxs("select",{value:p.isDeductible,onChange:e=>y({...p,isDeductible:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[c.jsx("option",{value:"",children:"All Expenses"}),c.jsx("option",{value:"true",children:"Deductible Only"}),c.jsx("option",{value:"false",children:"Non-Deductible Only"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),c.jsxs("select",{value:p.dateRange,onChange:e=>y({...p,dateRange:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[c.jsx("option",{value:"",children:"All Time"}),c.jsx("option",{value:"this-month",children:"This Month"}),c.jsx("option",{value:"last-month",children:"Last Month"}),c.jsx("option",{value:"this-quarter",children:"This Quarter"}),c.jsx("option",{value:"this-year",children:"This Year"})]})]})]})]}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden",children:0===s.length?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(N,{size:48,className:"mx-auto mb-4 text-gray-400"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No expenses found"}),c.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:0===t.length?"Add your first business expense to get started":"Try adjusting your filters"}),0===t.length&&c.jsxs("button",{onClick:v,className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[c.jsx(x,{size:16}),"Add Expense"]})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"sm:hidden space-y-3",children:s.map(e=>c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700",children:[c.jsxs("div",{className:"flex justify-between items-start mb-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[z(e.category),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.description}),e.notes&&c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.notes})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>k(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-blue-600 hover:text-blue-900 dark:text-blue-400",children:c.jsx(g,{size:20})}),c.jsx("button",{onClick:()=>w(e),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-red-600 hover:text-red-900 dark:text-red-400",children:c.jsx(u,{size:20})})]})]}),c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:I(e.category)}),c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:E(e.date)}),e.isDeductible?c.jsxs("span",{className:"inline-flex items-center gap-1 text-green-600 dark:text-green-400 text-xs",children:[c.jsx(h,{size:14}),"Deductible"]}):c.jsxs("span",{className:"inline-flex items-center gap-1 text-red-600 dark:text-red-400 text-xs",children:[c.jsx(D,{size:14}),"Non-deductible"]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"Amount"}),c.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:A(e.amount)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs",children:"VAT"}),c.jsx("span",{className:"text-gray-900 dark:text-white",children:e.vatAmount?A(e.vatAmount):"-"})]})]})]},e.id))}),c.jsx("div",{className:"hidden sm:block overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-secondary dark:bg-gray-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Expense"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Category"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Amount"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"VAT"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Deductible"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Date"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map(e=>c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[z(e.category),c.jsxs("div",{className:"ml-3",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.description}),e.notes&&c.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.notes})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:I(e.category)})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:A(e.amount)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.vatAmount?A(e.vatAmount):"-"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.isDeductible?c.jsx(h,{size:16,className:"text-green-500"}):c.jsx(D,{size:16,className:"text-red-500"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:E(e.date)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>k(e),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:c.jsx(g,{size:16})}),c.jsx("button",{onClick:()=>w(e),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:c.jsx(u,{size:16})})]})})]},e.id))})]})})]})}),i&&c.jsx(n,{expense:l,onClose:()=>d(!1),onSave:t=>{l?R.updateBusinessExpense(l.id,t):R.addBusinessExpense(t),d(!1),b(),e()}})]})}function n({expense:e,onClose:t,onSave:a}){const[s,r]=T.useState({date:e?.date.toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],description:e?.description||"",amount:e?.amount||0,category:e?.category||"other",vatAmount:e?.vatAmount||0,isDeductible:e?.isDeductible??!0,notes:e?.notes||""});return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-md",children:c.jsxs("form",{onSubmit:e=>{e.preventDefault(),a({...s,date:new Date(s.date),vatAmount:s.vatAmount||void 0})},className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e?"Edit Expense":"Add Expense"}),c.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:c.jsx(x,{size:20,className:"rotate-45"})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date"}),c.jsx("input",{type:"date",value:s.date,onChange:e=>r({...s,date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),c.jsx("input",{type:"text",value:s.description,onChange:e=>r({...s,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter expense description",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Amount"}),c.jsx("input",{type:"number",value:s.amount,onChange:e=>r({...s,amount:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"0.00",step:"0.01",min:"0",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),c.jsxs("select",{value:s.category,onChange:e=>r({...s,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,children:[c.jsx("option",{value:"office_supplies",children:"Office Supplies"}),c.jsx("option",{value:"travel",children:"Travel"}),c.jsx("option",{value:"meals",children:"Meals"}),c.jsx("option",{value:"utilities",children:"Utilities"}),c.jsx("option",{value:"rent",children:"Rent"}),c.jsx("option",{value:"marketing",children:"Marketing"}),c.jsx("option",{value:"professional_services",children:"Professional Services"}),c.jsx("option",{value:"equipment",children:"Equipment"}),c.jsx("option",{value:"software",children:"Software"}),c.jsx("option",{value:"insurance",children:"Insurance"}),c.jsx("option",{value:"other",children:"Other"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"VAT Amount (Optional)"}),c.jsx("input",{type:"number",value:s.vatAmount,onChange:e=>r({...s,vatAmount:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"0.00",step:"0.01",min:"0"})]}),c.jsx("div",{children:c.jsxs("label",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:s.isDeductible,onChange:e=>r({...s,isDeductible:e.target.checked}),className:"rounded border-gray-300 dark:border-gray-600"}),c.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Tax deductible"})]})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes (Optional)"}),c.jsx("textarea",{value:s.notes,onChange:e=>r({...s,notes:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"Additional notes..."})]})]}),c.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90",children:[e?"Update":"Add"," Expense"]})]})]})})})}function d(){const[t,a]=T.useState("overview"),[r,n]=T.useState(null),[d,l]=T.useState(!0);T.useEffect(()=>{x()},[]);const x=async()=>{l(!0);try{const e=R.getBusinessMetrics();n(e)}catch(e){console.error("Error loading business data:",e)}finally{l(!1)}},m=()=>{x()},g=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return d?c.jsx(z,{title:"Business Features",children:c.jsx("div",{className:"flex items-center justify-center min-h-64",children:c.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading business data..."})})}):c.jsx(z,{title:"Business Features",children:c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-800 dark:to-indigo-800 rounded-2xl p-6 mb-6 text-white shadow-lg",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Business Features"}),c.jsx("p",{className:"text-blue-100",children:"Manage invoices, track expenses, and monitor business performance"})]}),c.jsx(A,{size:48,className:"text-white/80"})]})}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm mb-6",children:c.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:c.jsxs("nav",{className:"flex space-x-8",children:[c.jsx("button",{onClick:()=>a("overview"),className:"py-4 px-6 border-b-2 font-medium text-sm "+("overview"===t?"border-[var(--color-primary)] text-[var(--color-primary)]":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(E,{size:16}),"Overview"]})}),c.jsx("button",{onClick:()=>a("invoices"),className:"py-4 px-6 border-b-2 font-medium text-sm "+("invoices"===t?"border-[var(--color-primary)] text-[var(--color-primary)]":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(o,{size:16}),"Invoices"]})}),c.jsx("button",{onClick:()=>a("expenses"),className:"py-4 px-6 border-b-2 font-medium text-sm "+("expenses"===t?"border-[var(--color-primary)] text-[var(--color-primary)]":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(N,{size:16}),"Expenses"]})}),c.jsx("button",{onClick:()=>a("mileage"),className:"py-4 px-6 border-b-2 font-medium text-sm "+("mileage"===t?"border-[var(--color-primary)] text-[var(--color-primary)]":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(v,{size:16}),"Mileage"]})})]})})}),"overview"===t&&r&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Revenue"}),c.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:g(r.totalRevenue)})]}),c.jsx(k,{size:24,className:"text-green-500"})]})}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Expenses"}),c.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:g(r.totalExpenses)})]}),c.jsx(N,{size:24,className:"text-red-500"})]})}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Net Profit"}),c.jsx("p",{className:"text-2xl font-bold "+(r.netProfit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:g(r.netProfit)})]}),c.jsx(I,{size:24,className:r.netProfit>=0?"text-green-500":"text-red-500"})]})}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Profit Margin"}),c.jsx("p",{className:"text-2xl font-bold "+(r.profitMargin>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:(h=r.profitMargin,`${h.toFixed(1)}%`)})]}),c.jsx(E,{size:24,className:r.profitMargin>=0?"text-green-500":"text-red-500"})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx(o,{size:20,className:"text-blue-600 dark:text-blue-400"}),c.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Invoice Status"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Outstanding"}),c.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.outstandingInvoices})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Overdue"}),c.jsx("span",{className:"font-medium text-red-600 dark:text-red-400",children:r.overdueInvoices})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Payment Time"}),c.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[r.averagePaymentTime.toFixed(0)," days"]})]})]})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx(N,{size:20,className:"text-green-600 dark:text-green-400"}),c.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Top Expenses"})]}),c.jsx("div",{className:"space-y-3",children:r.topExpenseCategories.slice(0,3).map((e,t)=>c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 capitalize",children:e.category.replace("_"," ")}),c.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:g(e.amount)})]},e.category))})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx(S,{size:20,className:"text-purple-600 dark:text-purple-400"}),c.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"This Month"})]}),c.jsx("div",{className:"space-y-3",children:r.monthlyTrends.slice(-1).map((e,t)=>c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Revenue"}),c.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:g(e.revenue)})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Expenses"}),c.jsx("span",{className:"font-medium text-red-600 dark:text-red-400",children:g(e.expenses)})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Profit"}),c.jsx("span",{className:"font-medium "+(e.profit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:g(e.profit)})]})]},t))})]})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Monthly Trends"}),c.jsx("div",{className:"space-y-4",children:r.monthlyTrends.slice(-6).map((e,t)=>c.jsxs("div",{className:"flex items-center justify-between py-2",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white w-20",children:e.month}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Revenue"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Expenses"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Profit"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[c.jsx("span",{className:"text-green-600 dark:text-green-400",children:g(e.revenue)}),c.jsx("span",{className:"text-red-600 dark:text-red-400",children:g(e.expenses)}),c.jsx("span",{className:e.profit>=0?"text-blue-600 dark:text-blue-400":"text-red-600 dark:text-red-400",children:g(e.profit)})]})]},t))})]})]}),"invoices"===t&&c.jsx(e,{onDataChange:m}),"expenses"===t&&c.jsx(i,{onDataChange:m}),"mileage"===t&&c.jsx(s,{onDataChange:m})]})});var h}import{aN as l,j as c,ag as x,b2 as o,ax as m,Q as g,O as h,aF as u,aZ as p,ar as y,c2 as b,aS as j,bV as v,aB as N,T as k,aa as f,c3 as w,bs as D,A as C,r as S,c4 as A,B as E,t as I}from"./index-CgJz7Gw0.js";import{a as T}from"./chunk-BWx9oMeS.js";import{P as z}from"./chunk-DLeAFLQD.js";import"./chunk-BN8kgYrt.js";import"./chunk-C1eKK5Oc.js";const R=new class{vatRates=[{id:"1",name:"Standard Rate",rate:.2,isDefault:!0},{id:"2",name:"Reduced Rate",rate:.05,isDefault:!1},{id:"3",name:"Zero Rate",rate:0,isDefault:!1}];invoices=[];mileageEntries=[];businessExpenses=[];constructor(){this.loadData(),this.createSampleData()}loadData(){try{const e=localStorage.getItem("business-vat-rates");e&&(this.vatRates=JSON.parse(e));const t=localStorage.getItem("business-invoices");t&&(this.invoices=JSON.parse(t).map(e=>({...e,issueDate:new Date(e.issueDate),dueDate:new Date(e.dueDate),createdAt:new Date(e.createdAt),paidAt:e.paidAt?new Date(e.paidAt):void 0})));const a=localStorage.getItem("business-mileage");a&&(this.mileageEntries=JSON.parse(a).map(e=>({...e,date:new Date(e.date),createdAt:new Date(e.createdAt)})));const s=localStorage.getItem("business-expenses");s&&(this.businessExpenses=JSON.parse(s).map(e=>({...e,date:new Date(e.date),createdAt:new Date(e.createdAt)})))}catch(e){console.error("Error loading business data:",e)}}saveData(){try{localStorage.setItem("business-vat-rates",JSON.stringify(this.vatRates)),localStorage.setItem("business-invoices",JSON.stringify(this.invoices)),localStorage.setItem("business-mileage",JSON.stringify(this.mileageEntries)),localStorage.setItem("business-expenses",JSON.stringify(this.businessExpenses))}catch(e){console.error("Error saving business data:",e)}}createSampleData(){if(0===this.invoices.length){const e=[{id:"1",invoiceNumber:"INV-2024-001",clientName:"Acme Corporation",clientEmail:"accounts@acme.com",issueDate:new Date("2024-01-15"),dueDate:new Date("2024-02-15"),items:[{id:"1",description:"Web Development Services",quantity:40,unitPrice:75,vatRate:.2,total:3600}],subtotal:3e3,vatAmount:600,total:3600,status:"paid",paymentTerms:"Net 30",notes:"Thank you for your business!",createdAt:new Date("2024-01-15"),paidAt:new Date("2024-02-10")},{id:"2",invoiceNumber:"INV-2024-002",clientName:"Tech Solutions Ltd",clientEmail:"billing@techsolutions.com",issueDate:new Date("2024-02-01"),dueDate:new Date("2024-03-01"),items:[{id:"2",description:"Monthly Maintenance",quantity:1,unitPrice:500,vatRate:.2,total:600}],subtotal:500,vatAmount:100,total:600,status:"sent",paymentTerms:"Net 30",createdAt:new Date("2024-02-01")}];this.invoices=e}if(0===this.mileageEntries.length){const e=[{id:"1",date:new Date("2024-01-15"),startLocation:"Office",endLocation:"Client Meeting - Downtown",distance:25,purpose:"Client consultation",rate:.67,amount:16.75,category:"business",notes:"Meeting with Acme Corporation",createdAt:new Date("2024-01-15")},{id:"2",date:new Date("2024-01-20"),startLocation:"Home",endLocation:"Networking Event",distance:15,purpose:"Business networking",rate:.67,amount:10.05,category:"business",createdAt:new Date("2024-01-20")}];this.mileageEntries=e}if(0===this.businessExpenses.length){const e=[{id:"1",date:new Date("2024-01-10"),description:"Office Supplies - Stationery",amount:125.5,category:"office_supplies",vatAmount:25.1,isDeductible:!0,notes:"Paper, pens, folders",createdAt:new Date("2024-01-10")},{id:"2",date:new Date("2024-01-15"),description:"Software Subscription - Adobe Creative Suite",amount:52.99,category:"software",vatAmount:10.6,isDeductible:!0,notes:"Monthly subscription",createdAt:new Date("2024-01-15")},{id:"3",date:new Date("2024-01-20"),description:"Business Lunch - Client Meeting",amount:85,category:"meals",vatAmount:17,isDeductible:!0,notes:"Meeting with Tech Solutions Ltd",createdAt:new Date("2024-01-20")}];this.businessExpenses=e}this.saveData()}getVATRates(){return this.vatRates}getDefaultVATRate(){return this.vatRates.find(e=>e.isDefault)||this.vatRates[0]}addVATRate(e){const t={...e,id:Date.now().toString()};return e.isDefault&&(this.vatRates=this.vatRates.map(e=>({...e,isDefault:!1}))),this.vatRates.push(t),this.saveData(),t}updateVATRate(e,t){const a=this.vatRates.findIndex(t=>t.id===e);return-1===a?null:(t.isDefault&&(this.vatRates=this.vatRates.map(e=>({...e,isDefault:!1}))),this.vatRates[a]={...this.vatRates[a],...t},this.saveData(),this.vatRates[a])}deleteVATRate(e){const t=this.vatRates.findIndex(t=>t.id===e);return-1!==t&&(this.vatRates.splice(t,1),this.saveData(),!0)}getInvoices(){return this.invoices.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime())}getInvoiceById(e){return this.invoices.find(t=>t.id===e)||null}createInvoice(e){const t={...e,id:Date.now().toString(),createdAt:new Date};return this.invoices.push(t),this.saveData(),t}updateInvoice(e,t){const a=this.invoices.findIndex(t=>t.id===e);return-1===a?null:(this.invoices[a]={...this.invoices[a],...t},this.saveData(),this.invoices[a])}deleteInvoice(e){const t=this.invoices.findIndex(t=>t.id===e);return-1!==t&&(this.invoices.splice(t,1),this.saveData(),!0)}markInvoiceAsPaid(e,t=new Date){return this.getInvoiceById(e)?this.updateInvoice(e,{status:"paid",paidAt:t}):null}calculateInvoiceTotals(e){let t=new l(0),a=new l(0);e.forEach(e=>{const s=new l(e.quantity).mul(e.unitPrice),r=s.mul(e.vatRate);t=t.plus(s),a=a.plus(r)});const s=t.plus(a);return{subtotal:t.toNumber(),vatAmount:a.toNumber(),total:s.toNumber()}}getMileageEntries(){return this.mileageEntries.sort((e,t)=>t.date.getTime()-e.date.getTime())}addMileageEntry(e){const t=new l(e.distance).mul(e.rate).toNumber(),a={...e,id:Date.now().toString(),amount:t,createdAt:new Date};return this.mileageEntries.push(a),this.saveData(),a}updateMileageEntry(e,t){const a=this.mileageEntries.findIndex(t=>t.id===e);if(-1===a)return null;const s={...this.mileageEntries[a],...t};return void 0===t.distance&&void 0===t.rate||(s.amount=new l(s.distance).mul(s.rate).toNumber()),this.mileageEntries[a]=s,this.saveData(),s}deleteMileageEntry(e){const t=this.mileageEntries.findIndex(t=>t.id===e);return-1!==t&&(this.mileageEntries.splice(t,1),this.saveData(),!0)}getBusinessExpenses(){return this.businessExpenses.sort((e,t)=>t.date.getTime()-e.date.getTime())}addBusinessExpense(e){const t={...e,id:Date.now().toString(),createdAt:new Date};return this.businessExpenses.push(t),this.saveData(),t}updateBusinessExpense(e,t){const a=this.businessExpenses.findIndex(t=>t.id===e);return-1===a?null:(this.businessExpenses[a]={...this.businessExpenses[a],...t},this.saveData(),this.businessExpenses[a])}deleteBusinessExpense(e){const t=this.businessExpenses.findIndex(t=>t.id===e);return-1!==t&&(this.businessExpenses.splice(t,1),this.saveData(),!0)}getBusinessMetrics(e,t){const a=this.getInvoicesInRange(e,t),s=this.getExpensesInRange(e,t),r=this.getMileageInRange(e,t),i=a.filter(e=>"paid"===e.status).reduce((e,t)=>e+t.total,0),n=s.reduce((e,t)=>e+t.amount,0)+r.reduce((e,t)=>e+t.amount,0),d=i-n,l=i>0?d/i*100:0,c=a.filter(e=>"sent"===e.status||"overdue"===e.status).length,x=a.filter(e=>"overdue"===e.status||"sent"===e.status&&e.dueDate<new Date).length,o=a.filter(e=>"paid"===e.status&&e.paidAt),m=o.length>0?o.reduce((e,t)=>e+Math.ceil((t.paidAt.getTime()-t.issueDate.getTime())/864e5),0)/o.length:0,g=s.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+t.amount,e),{}),h=Object.entries(g).map(([e,t])=>({category:e,amount:t,percentage:n>0?t/n*100:0})).sort((e,t)=>t.amount-e.amount).slice(0,5),u=this.calculateMonthlyTrends(a,s,r);return{totalRevenue:i,totalExpenses:n,netProfit:d,profitMargin:l,outstandingInvoices:c,overdueInvoices:x,averagePaymentTime:m,topExpenseCategories:h,monthlyTrends:u}}getInvoicesInRange(e,t){return e||t?this.invoices.filter(a=>{const s=a.issueDate;return!(e&&s<e||t&&s>t)}):this.invoices}getExpensesInRange(e,t){return e||t?this.businessExpenses.filter(a=>{const s=a.date;return!(e&&s<e||t&&s>t)}):this.businessExpenses}getMileageInRange(e,t){return e||t?this.mileageEntries.filter(a=>{const s=a.date;return!(e&&s<e||t&&s>t)}):this.mileageEntries}calculateMonthlyTrends(e,t,a){const s=[];for(let r=11;r>=0;r--){const i=new Date;i.setMonth(i.getMonth()-r);const n=new Date(i.getFullYear(),i.getMonth(),1),d=new Date(i.getFullYear(),i.getMonth()+1,0),l=e.filter(e=>"paid"===e.status&&e.paidAt&&e.paidAt>=n&&e.paidAt<=d),c=t.filter(e=>e.date>=n&&e.date<=d),x=a.filter(e=>e.date>=n&&e.date<=d),o=l.reduce((e,t)=>e+t.total,0),m=c.reduce((e,t)=>e+t.amount,0)+x.reduce((e,t)=>e+t.amount,0);s.push({month:i.toLocaleDateString("en-US",{month:"short",year:"numeric"}),revenue:o,expenses:m,profit:o-m})}return s}generateInvoiceNumber(){return`INV-${(new Date).getFullYear()}-${(this.invoices.length+1).toString().padStart(3,"0")}`}exportBusinessData(){return{invoices:this.invoices,expenses:this.businessExpenses,mileage:this.mileageEntries,metrics:this.getBusinessMetrics()}}};export{d as default};
