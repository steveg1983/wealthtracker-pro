import{j as e,Q as t,V as a,_ as n,X as s}from"./index-Pkjq0qn3.js";import{a as o}from"./chunk-BWx9oMeS.js";import{A as r,I as i,F as c}from"./chunk-B4Yu4FH1.js";import{u as l}from"./chunk-BxklXyU5.js";import"./chunk-BN8kgYrt.js";import"./chunk-Drd-K-oK.js";const d=o.memo(()=>e.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded",children:"Pending"}));d.displayName="PendingBadge";const m=o.memo(({isCleared:t})=>t?e.jsx(n,{size:16,className:"text-green-600"}):e.jsx(s,{size:16,className:"text-gray-400"}));m.displayName="ReconcileIcon";const u=o.memo(({date:t})=>{const a=l(t);return e.jsx("span",{children:a})});u.displayName="TransactionDate";const h=o.memo(({index:n,style:s,data:r})=>{const{transactions:i,formatCurrency:c,onTransactionClick:l,onTransactionEdit:h,onTransactionDelete:x,selectedTransactions:p,onSelectionChange:g,showBulkActions:y}=r,b=i[n],k=p?.has(b?.id)||!1,{formattedAmount:f,amountClass:j}=o.useMemo(()=>{if(!b)return{formattedAmount:"",amountClass:""};const e="expense"===b.type||"transfer"===b.type&&b.amount<0,t="income"===b.type||"transfer"===b.type&&b.amount>0,a=e?-Math.abs(b.amount):Math.abs(b.amount),n=c(a);return{formattedAmount:!t||n.startsWith("+")||n.startsWith("-")?n:`+${n}`,amountClass:e?"text-red-600":"text-green-600"}},[b,c]),C=o.useCallback(e=>{if(b&&(e.stopPropagation(),g&&p)){const t=new Set(p);e.target.checked?t.add(b.id):t.delete(b.id),g(t)}},[g,p,b]),w=o.useCallback(()=>{b&&l&&l(b)},[l,b]),N=o.useCallback(e=>{b&&(e.stopPropagation(),h&&h(b))},[h,b]),T=o.useCallback(e=>{b&&(e.stopPropagation(),x&&confirm("Are you sure you want to delete this transaction?")&&x(b.id))},[x,b]),v=o.useMemo(()=>{const e="flex items-center px-4 py-3 border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer";return k?`${e} bg-blue-50 dark:bg-blue-900/20`:e},[k]);return b?e.jsxs("div",{style:s,className:v,onClick:w,role:"row",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),w())},"aria-label":`Transaction: ${b.description}, ${f} on ${new Date(b.date).toLocaleDateString()}`,children:[y&&e.jsx("input",{type:"checkbox",checked:k,onChange:C,className:"mr-3 rounded",onClick:e=>e.stopPropagation(),"aria-label":`Select transaction ${b.description}`}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:b.description}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(u,{date:b.date})," \u2022 ",b.category,b.accountId&&` \u2022 ${b.accountId}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-semibold whitespace-nowrap ${j}`,children:f}),b.pending&&e.jsx(d,{}),e.jsx(m,{isCleared:b.cleared||!1}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[h&&e.jsx("button",{onClick:N,className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",title:"Edit transaction","aria-label":`Edit transaction ${b.description}`,children:e.jsx(t,{size:16})}),x&&e.jsx("button",{onClick:T,className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/20 rounded text-red-600",title:"Delete transaction","aria-label":`Delete transaction ${b.description}`,children:e.jsx(a,{size:16})})]})]})]})})]}):null},(e,t)=>{const a=e.data.transactions[e.index],n=t.data.transactions[t.index];return e.index===t.index&&e.style===t.style&&a?.id===n?.id&&a?.amount===n?.amount&&a?.description===n?.description&&a?.category===n?.category&&a?.cleared===n?.cleared&&e.data.selectedTransactions?.has(a?.id)===t.data.selectedTransactions?.has(n?.id)});h.displayName="TransactionRow";const x=o.memo(function({transactions:t,formatCurrency:a,onTransactionClick:n,onTransactionEdit:s,onTransactionDelete:l,onLoadMore:d,hasMore:m=!1,isLoading:u=!1,selectedTransactions:x,onSelectionChange:p,showBulkActions:g=!1}){const y=o.useRef(null),b=o.useMemo(()=>({transactions:t,formatCurrency:a,onTransactionClick:n,onTransactionEdit:s,onTransactionDelete:l,selectedTransactions:x,onSelectionChange:p,showBulkActions:g}),[t,a,n,s,l,x,p,g]),k=o.useCallback(e=>!m||e<t.length,[m,t.length]),f=o.useCallback(()=>(u||!d||d(),Promise.resolve()),[u,d]),j=m?t.length+1:t.length;return e.jsx("div",{className:"flex-1 w-full",role:"grid","aria-label":"Transactions list","aria-rowcount":t.length,children:e.jsx(r,{children:({height:t,width:a})=>e.jsx(i,{isItemLoaded:k,itemCount:j,loadMoreItems:f,children:({onItemsRendered:n,ref:s})=>e.jsx(c,{ref:e=>{e&&(y.current=e,"function"==typeof s?s(e):s&&(s.current=e))},height:t,itemCount:j,itemSize:80,itemData:b,onItemsRendered:n,width:a,overscanCount:5,children:h})})})})});x.displayName="VirtualizedTransactionList";export{x as VirtualizedTransactionList};
