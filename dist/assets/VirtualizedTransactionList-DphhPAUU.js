import{r as e,H as t,cZ as a,c_ as n,d0 as s}from"./chunk-DowOIOga.js";import{E as r,D as o,x as i,X as c}from"./index-qHm2isZb.js";import{u as l}from"./chunk-zIucmNL9.js";import"./chunk-ddLY9KjI.js";import"./chunk-B5pcS96K.js";const d=e.memo(()=>t.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded",children:"Pending"}));d.displayName="PendingBadge";const m=e.memo(({isCleared:e})=>e?t.jsx(i,{size:16,className:"text-green-600"}):t.jsx(c,{size:16,className:"text-gray-400"}));m.displayName="ReconcileIcon";const u=e.memo(({date:e})=>{const a=l(e);return t.jsx("span",{children:a})});u.displayName="TransactionDate";const x=e.memo(({index:a,style:n,data:s})=>{const{transactions:i,formatCurrency:c,onTransactionClick:l,onTransactionEdit:x,onTransactionDelete:h,selectedTransactions:p,onSelectionChange:g,showBulkActions:y}=s,b=i[a],k=p?.has(b?.id)||!1,{formattedAmount:f,amountClass:j}=e.useMemo(()=>{if(!b)return{formattedAmount:"",amountClass:""};const e="expense"===b.type||"transfer"===b.type&&b.amount<0,t="income"===b.type||"transfer"===b.type&&b.amount>0,a=e?-Math.abs(b.amount):Math.abs(b.amount),n=c(a);return{formattedAmount:!t||n.startsWith("+")||n.startsWith("-")?n:`+${n}`,amountClass:e?"text-red-600":"text-green-600"}},[b,c]),C=e.useCallback(e=>{if(b&&(e.stopPropagation(),g&&p)){const t=new Set(p);e.target.checked?t.add(b.id):t.delete(b.id),g(t)}},[g,p,b]),w=e.useCallback(()=>{b&&l&&l(b)},[l,b]),N=e.useCallback(e=>{b&&(e.stopPropagation(),x&&x(b))},[x,b]),T=e.useCallback(e=>{b&&(e.stopPropagation(),h&&confirm("Are you sure you want to delete this transaction?")&&h(b.id))},[h,b]),v=e.useMemo(()=>{const e="flex items-center px-4 py-3 border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer";return k?`${e} bg-blue-50 dark:bg-blue-900/20`:e},[k]);return b?t.jsxs("div",{style:n,className:v,onClick:w,role:"row",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),w())},"aria-label":`Transaction: ${b.description}, ${f} on ${new Date(b.date).toLocaleDateString()}`,children:[y&&t.jsx("input",{type:"checkbox",checked:k,onChange:C,className:"mr-3 rounded",onClick:e=>e.stopPropagation(),"aria-label":`Select transaction ${b.description}`}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1 mr-4",children:[t.jsx("p",{className:"font-medium text-sm truncate",children:b.description}),t.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.jsx(u,{date:b.date})," \u2022 ",b.category,b.accountId&&` \u2022 ${b.accountId}`]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`font-semibold whitespace-nowrap ${j}`,children:f}),b.pending&&t.jsx(d,{}),t.jsx(m,{isCleared:b.cleared||!1}),t.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[x&&t.jsx("button",{onClick:N,className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",title:"Edit transaction","aria-label":`Edit transaction ${b.description}`,children:t.jsx(r,{size:16})}),h&&t.jsx("button",{onClick:T,className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/20 rounded text-red-600",title:"Delete transaction","aria-label":`Delete transaction ${b.description}`,children:t.jsx(o,{size:16})})]})]})]})})]}):null},(e,t)=>{const a=e.data.transactions[e.index],n=t.data.transactions[t.index];return e.index===t.index&&e.style===t.style&&a?.id===n?.id&&a?.amount===n?.amount&&a?.description===n?.description&&a?.category===n?.category&&a?.cleared===n?.cleared&&e.data.selectedTransactions?.has(a?.id)===t.data.selectedTransactions?.has(n?.id)});x.displayName="TransactionRow";const h=e.memo(function({transactions:r,formatCurrency:o,onTransactionClick:i,onTransactionEdit:c,onTransactionDelete:l,onLoadMore:d,hasMore:m=!1,isLoading:u=!1,selectedTransactions:h,onSelectionChange:p,showBulkActions:g=!1}){const y=e.useRef(null),b=e.useMemo(()=>({transactions:r,formatCurrency:o,onTransactionClick:i,onTransactionEdit:c,onTransactionDelete:l,selectedTransactions:h,onSelectionChange:p,showBulkActions:g}),[r,o,i,c,l,h,p,g]),k=e.useCallback(e=>!m||e<r.length,[m,r.length]),f=e.useCallback(()=>(u||!d||d(),Promise.resolve()),[u,d]),j=m?r.length+1:r.length;return t.jsx("div",{className:"flex-1 w-full",role:"grid","aria-label":"Transactions list","aria-rowcount":r.length,children:t.jsx(a,{children:({height:e,width:a})=>t.jsx(n,{isItemLoaded:k,itemCount:j,loadMoreItems:f,children:({onItemsRendered:n,ref:r})=>t.jsx(s,{ref:e=>{e&&(y.current=e,"function"==typeof r?r(e):r&&(r.current=e))},height:e,itemCount:j,itemSize:80,itemData:b,onItemsRendered:n,width:a,overscanCount:5,children:x})})})})});h.displayName="VirtualizedTransactionList";export{h as VirtualizedTransactionList};
