function e(){const[e,h]=x.useState(m.getSecuritySettings()),[y,u]=x.useState(!1),[p,j]=x.useState(null),[k,v]=x.useState(""),[f,N]=x.useState(!1),[w,E]=x.useState(null);x.useEffect(()=>{S()},[]);const S=async()=>{const e=await m.isBiometricAvailable();N(e)};return t.jsx(b,{children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 dark:from-indigo-800 dark:to-purple-800 rounded-2xl p-6 mb-6 text-white shadow-lg",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Security Settings"}),t.jsx("p",{className:"text-indigo-100",children:"Protect your financial data with advanced security features"})]}),t.jsx(a,{size:48,className:"text-white/80"})]})}),w&&t.jsxs("div",{className:"mb-6 p-4 rounded-lg flex items-center gap-3 "+("success"===w.type?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200"),children:["success"===w.type?t.jsx(r,{size:20}):t.jsx(s,{size:20}),t.jsx("p",{children:w.text})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(d,{size:20,className:"text-indigo-600 dark:text-indigo-400"}),"Two-Factor Authentication"]}),t.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Add an extra layer of security with time-based one-time passwords"})]}),t.jsx("button",{onClick:()=>{if(e.twoFactorEnabled)m.updateSecuritySettings({twoFactorEnabled:!1}),h({...e,twoFactorEnabled:!1}),E({type:"success",text:"Two-factor authentication disabled"});else{const e=m.generateTwoFactorSecret();j(e),u(!0)}},className:"px-4 py-2 rounded-lg font-medium transition-colors "+(e.twoFactorEnabled?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900/50":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50"),children:e.twoFactorEnabled?"Disable":"Enable"})]}),e.twoFactorEnabled&&t.jsx("div",{className:"mt-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:t.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200 flex items-center gap-2",children:[t.jsx(r,{size:16}),"Two-factor authentication is active"]})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(i,{size:20,className:"text-purple-600 dark:text-purple-400"}),"Biometric Authentication"]}),t.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Use Face ID, Touch ID, or Windows Hello for quick access"})]}),t.jsx("button",{onClick:async()=>{if(e.biometricEnabled)m.updateSecuritySettings({biometricEnabled:!1}),h({...e,biometricEnabled:!1}),E({type:"success",text:"Biometric authentication disabled"});else try{await m.setupBiometric()?(m.updateSecuritySettings({biometricEnabled:!0}),h({...e,biometricEnabled:!0}),E({type:"success",text:"Biometric authentication enabled"})):E({type:"error",text:"Failed to setup biometric authentication"})}catch(t){E({type:"error",text:"Biometric authentication not available"})}},disabled:!f,className:"px-4 py-2 rounded-lg font-medium transition-colors "+(f?e.biometricEnabled?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900/50":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50":"bg-gray-100 text-gray-400 dark:bg-gray-700 cursor-not-allowed"),children:f?e.biometricEnabled?"Disable":"Enable":"Not Available"})]}),!f&&t.jsx("div",{className:"mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:t.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Biometric authentication is not available on this device"})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(n,{size:20,className:"text-green-600 dark:text-green-400"}),"End-to-End Encryption"]}),t.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Encrypt all sensitive data stored locally"})]}),t.jsx("button",{onClick:()=>{const t=!e.encryptionEnabled;m.updateSecuritySettings({encryptionEnabled:t}),h({...e,encryptionEnabled:t}),E({type:"success",text:t?"Data encryption enabled":"Data encryption disabled"})},className:"px-4 py-2 rounded-lg font-medium transition-colors "+(e.encryptionEnabled?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900/50":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50"),children:e.encryptionEnabled?"Disable":"Enable"})]}),e.encryptionEnabled&&t.jsx("div",{className:"mt-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:t.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200 flex items-center gap-2",children:[t.jsx(r,{size:16}),"All data is encrypted using AES-256-GCM"]})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(l,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Read-Only Mode"]}),t.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"View your data without the ability to make changes"})]}),t.jsx("button",{onClick:()=>{const t=!e.readOnlyMode;m.toggleReadOnlyMode(t),h({...e,readOnlyMode:t}),E({type:"success",text:t?"Read-only mode enabled":"Read-only mode disabled"})},className:"px-4 py-2 rounded-lg font-medium transition-colors "+(e.readOnlyMode?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900/50":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50"),children:e.readOnlyMode?"Disable":"Enable"})]}),e.readOnlyMode&&t.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:t.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200 flex items-center gap-2",children:[t.jsx(l,{size:16}),"Read-only mode is active - no changes can be made"]})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2 mb-4",children:[t.jsx(c,{size:20,className:"text-orange-600 dark:text-orange-400"}),"Session Timeout"]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Automatically log out after a period of inactivity"}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Timeout after:"}),t.jsxs("select",{value:e.sessionTimeout,onChange:t=>{return a=Number(t.target.value),m.updateSecuritySettings({sessionTimeout:a}),void h({...e,sessionTimeout:a});var a},className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[t.jsx("option",{value:5,children:"5 minutes"}),t.jsx("option",{value:15,children:"15 minutes"}),t.jsx("option",{value:30,children:"30 minutes"}),t.jsx("option",{value:60,children:"1 hour"}),t.jsx("option",{value:120,children:"2 hours"})]})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2 mb-4",children:[t.jsx(o,{size:20,className:"text-gray-600 dark:text-gray-400"}),"Security Information"]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded",children:[t.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Failed login attempts"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:e.failedAttempts})]}),e.lastLogin&&t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded",children:[t.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Last login"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:new Date(e.lastLogin).toLocaleString()})]}),t.jsx("button",{onClick:()=>window.location.href="/settings/security/audit-logs",className:"w-full px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"View Audit Logs"})]})]})]}),y&&p&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-md p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Set Up Two-Factor Authentication"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"1. Scan this QR code with your authenticator app:"}),t.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-4 rounded-lg text-center",children:t.jsxs("div",{className:"inline-block p-4 bg-white dark:bg-gray-800 rounded",children:[t.jsx(g,{size:48,className:"text-gray-400"}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"QR Code Placeholder"})]})})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"2. Or enter this secret manually:"}),t.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded font-mono text-sm break-all",children:p.secret})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"3. Enter the 6-digit code from your app:"}),t.jsx("input",{type:"text",value:k,onChange:e=>v(e.target.value),placeholder:"000000",maxLength:6,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-center font-mono text-lg"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"4. Save these backup codes in a safe place:"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 p-3 bg-gray-100 dark:bg-gray-700 rounded",children:p.backupCodes.slice(0,6).map((e,a)=>t.jsx("span",{className:"font-mono text-sm",children:e},a))})]})]}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{u(!1),j(null),v("")},className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),t.jsx("button",{onClick:()=>{p&&k&&(m.verifyTwoFactorCode(k,p.secret)?(m.updateSecuritySettings({twoFactorEnabled:!0}),h({...e,twoFactorEnabled:!0}),u(!1),j(null),v(""),E({type:"success",text:"Two-factor authentication enabled successfully"})):E({type:"error",text:"Invalid verification code"}))},disabled:6!==k.length,className:"flex-1 px-4 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary)]/90 disabled:opacity-50 disabled:cursor-not-allowed",children:"Verify & Enable"})]})]})})]})})}import{j as t,e as a,O as r,ar as s,P as d,bw as i,bx as n,ax as l,at as c,b2 as o,bm as g}from"./index-Pkjq0qn3.js";import{a as x}from"./chunk-BWx9oMeS.js";import{s as m}from"./chunk-Cvxg0-1j.js";import{P as b}from"./chunk-BnYLBI7x.js";import"./chunk-BN8kgYrt.js";import"./chunk-Drd-K-oK.js";export{e as default};
