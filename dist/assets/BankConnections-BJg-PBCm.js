function e({onAccountsLinked:e}){const[u,y]=t.useState([]),[k,b]=t.useState([]),[j,p]=t.useState(!1),[f,N]=t.useState(""),[w,v]=t.useState(!1),[C,S]=t.useState(new Set),[z,L]=t.useState({plaid:!1,trueLayer:!1});t.useEffect(()=>{A(),B(),I()},[]);const A=()=>{y(a.getConnections())},B=async()=>{const e=await a.getInstitutions();b(e)},I=()=>{L(a.getConfigStatus())},T=async t=>{S(e=>new Set(e).add(t));try{const s=await a.syncConnection(t);s.success?(A(),e?.()):console.error("Sync failed:",s.errors)}finally{S(e=>{const s=new Set(e);return s.delete(t),s})}},M=e=>{switch(e){case"connected":return s.jsx(m,{size:16,className:"text-green-600 dark:text-green-400"});case"error":return s.jsx(r,{size:16,className:"text-red-600 dark:text-red-400"});case"reauth_required":return s.jsx(r,{size:16,className:"text-yellow-600 dark:text-yellow-400"})}},F=k.filter(e=>e.name.toLowerCase().includes(f.toLowerCase())),P=u.filter(e=>"reauth_required"===e.status).length;return s.jsxs("div",{className:"space-y-6",children:[!z.plaid&&!z.trueLayer&&s.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(r,{className:"text-yellow-600 dark:text-yellow-400 mt-0.5",size:20}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Bank connections not configured"}),s.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"To enable automatic bank syncing, configure API credentials in the settings."})]})]})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Connected Banks"}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[u.length," bank",1!==u.length?"s":""," connected",P>0&&s.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400 ml-2",children:["(",P," need",1===P?"s":""," reauthorization)"]})]})]}),s.jsxs("div",{className:"flex gap-3",children:[u.length>0&&s.jsxs("button",{onClick:async()=>{const e=u.filter(e=>"connected"===e.status);for(const t of e)await T(t.id)},className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[s.jsx(n,{size:16}),"Sync All"]}),s.jsxs("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[s.jsx(l,{size:16}),"Add Bank"]})]})]}),u.length>0?s.jsx("div",{className:"space-y-3",children:u.map(e=>s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:s.jsx(i,{size:24,className:"text-gray-600 dark:text-gray-400"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.institutionName}),M(e.status)]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mt-1",children:[s.jsxs("span",{children:[e.accounts.length," accounts linked"]}),e.lastSync&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(c,{size:12}),"Last synced ",h(new Date(e.lastSync),"MMM d, h:mm a")]})]}),e.error&&s.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:e.error})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>T(e.id),disabled:C.has(e.id),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white disabled:opacity-50",title:"Sync now",children:s.jsx(n,{size:20,className:C.has(e.id)?"animate-spin":""})}),s.jsx("button",{onClick:()=>(async e=>{confirm("Are you sure you want to disconnect this bank? This will stop automatic syncing.")&&(await a.disconnect(e),A())})(e.id),className:"p-2 text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300",title:"Disconnect",children:s.jsx(d,{size:20})})]})]})},e.id))}):s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-8 text-center",children:[s.jsx(o,{size:48,className:"text-gray-300 dark:text-gray-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No banks connected"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Connect your bank accounts for automatic transaction imports and real-time balance updates."}),s.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(l,{size:20}),"Connect Your First Bank"]})]}),s.jsx(x,{isOpen:j,onClose:()=>p(!1),title:"Connect a Bank",size:"lg",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(g,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",value:f,onChange:e=>N(e.target.value),placeholder:"Search for your bank...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),s.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 text-sm",children:s.jsxs("p",{className:"text-blue-800 dark:text-blue-200",children:[s.jsx("strong",{children:"Secure Connection:"})," Your credentials are never stored. Connection is established directly with your bank using OAuth."]})}),s.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:F.map(e=>s.jsxs("button",{onClick:()=>(async e=>{v(!0);try{const t=await a.connectBank(e.id,e.provider);if(t.url){const e=window.open(t.url,"bankAuth","width=500,height=700,left=200,top=100"),s=setInterval(()=>{e?.closed&&(clearInterval(s),A(),p(!1))},1e3)}else t.linkToken&&alert("Plaid Link integration would open here with token: "+t.linkToken)}catch(t){console.error("Failed to connect bank:",t)}finally{v(!1)}})(e),disabled:w,className:"w-full p-4 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg transition-colors text-left flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center",children:s.jsx(i,{size:24,className:"text-gray-600 dark:text-gray-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["via ","truelayer"===e.provider?"TrueLayer":"Plaid"]})]}),s.jsx(o,{size:20,className:"text-gray-400"})]},e.id))}),0===F.length&&s.jsx("div",{className:"text-center py-8",children:s.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:['No banks found matching "',f,'"']})})]})})]})}import{r as t,L as s}from"./chunk-Bcp2Zi4E.js";import{b as a}from"./chunk-sYIUaUoe.js";import{aa as r,ac as n,$ as l,a1 as i,aF as c,bN as d,a$ as o,M as x,I as g,v as m}from"./index-LbveD3Go.js";import{f as h}from"./chunk-B5pcS96K.js";import"./chunk-oUGr0aFc.js";import"./chunk-a7oqB5tI.js";export{e as default};
